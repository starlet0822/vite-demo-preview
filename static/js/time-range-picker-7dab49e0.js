import{_ as ve}from"./index-fe03fbb2.js";import{ab as pe,ai as ge,an as O,d as oe,a as _,c as ae,w as X,cF as Q,p as v,m as ne,al as _e,am as be,cI as ke,a1 as ie,r as j,db as xe,o as Ce,B as ue,a0 as he,k as $,s as Y,x as W,z as G,F as ee,G as te,u as c,f as h,y as ye,Z as Se,t as we,g as z,q as C,v as F,J as V,a7 as Te,M as Ve}from"./index-bf5293ec.js";import{_ as se}from"./plugin-vue_export-helper-c27b6911.js";/* empty css              */import{s as Pe,g as J,f as He,p as Me,P as re}from"./index-349f75c8.js";import{o as Be,S as Ne}from"./style-8b2bd408.js";import{C as Ue,R as Re}from"./index-41987db1.js";import{C as Ie}from"./index-dd8bc5ba.js";import{F as $e}from"./index-9b4749b7.js";import{p as K}from"./index-e0c2a32e.js";import"./index-190fcdfb.js";import"./use-route-27ae2cd1.js";import"./use-sync-prop-ref-f77570a7.js";import"./index-12d71349.js";import"./use-id-3c752574.js";import"./index-3b4d3a26.js";import"./popper-f3391c26.js";const[ze]=pe("time-picker"),le=i=>/^([01]\d|2[0-3]):([0-5]\d):([0-5]\d)$/.test(i),De=["hour","minute","second"],Ae=ge({},Pe,{minHour:O(0),maxHour:O(23),minMinute:O(0),maxMinute:O(59),minSecond:O(0),maxSecond:O(59),minTime:{type:String,validator:le},maxTime:{type:String,validator:le},columnsType:{type:Array,default:()=>["hour","minute"]},filter:Function});var Oe=oe({name:ze,props:Ae,emits:["confirm","cancel","change","update:modelValue"],setup(i,{emit:y,slots:u}){const g=_(i.modelValue),P=t=>{const x=t.split(":");return De.map((H,b)=>i.columnsType.includes(H)?x[b]:"00")},U=ae(()=>{let{minHour:t,maxHour:x,minMinute:H,maxMinute:b,minSecond:N,maxSecond:M}=i;if(i.minTime||i.maxTime){const k={hour:0,minute:0,second:0};i.columnsType.forEach((e,a)=>{var m;k[e]=(m=g.value[a])!=null?m:0});const{hour:l,minute:r}=k;if(i.minTime){const[e,a,m]=P(i.minTime);t=e,H=+l<=+t?a:"00",N=+l<=+t&&+r<=+H?m:"00"}if(i.maxTime){const[e,a,m]=P(i.maxTime);x=e,b=+l>=+x?a:"59",M=+l>=+x&&+r>=+b?m:"59"}}return i.columnsType.map(k=>{const{filter:l,formatter:r}=i;switch(k){case"hour":return J(+t,+x,k,r,l,g.value);case"minute":return J(+H,+b,k,r,l,g.value);case"second":return J(+N,+M,k,r,l,g.value);default:return[]}})});X(g,t=>{Q(t,i.modelValue)||y("update:modelValue",t)}),X(()=>i.modelValue,t=>{t=He(t,U.value),Q(t,g.value)||(g.value=t)},{immediate:!0});const S=(...t)=>y("change",...t),s=(...t)=>y("cancel",...t),n=(...t)=>y("confirm",...t);return()=>v(re,ne({modelValue:g.value,"onUpdate:modelValue":t=>g.value=t,columns:U.value,onChange:S,onCancel:s,onConfirm:n},_e(i,Me)),u)}});const Fe=be(Oe);const je={class:"time-picker"},We={class:"time-scroll"},qe={class:"time-text"},Ee={class:"time-full"},Le=["data-val","data-idx","onClick"],Ge=oe({name:"TimePicker"}),Je=Object.assign(Ge,{props:{modelValue:{type:Array,default:()=>[]},minHour:{type:[Number,String],default:"0"},maxHour:{type:[Number,String],default:"23"},visibleNum:{type:[Number,String],default:"8"},timeStep:{type:[Number,String],default:"30",validator:i=>60%i===0},blockColor:{type:String,default:ke.get("themeColor")||ie||"#2e6cf3"},showArrow:Boolean,fixed:Boolean,readonly:Boolean,disabledBefore:Boolean},emits:["select"],setup(i,{emit:y}){const u=i;Se(l=>({"22bfa96c":c(U),db62b176:i.blockColor}));const g=_(0);_(!0),_(0);const P=_(0),U=_("");j([]),j([]),j([]);const S=_([]);_([]);const s=j([]),n=_(),t=_();_(!1),xe(document.body,l=>{}),X(()=>u,l=>{M()},{deep:!0}),Ce(()=>{M(),x()});const x=async()=>{var l;await ue(),P.value=(l=document.querySelector(".time-bar"))==null?void 0:l.getBoundingClientRect().width,U.value=P.value/he+"rem"},H=l=>{if(g.value+=P.value*l,g.value===P.value){g.value=0;return}console.log(g.value)},b=l=>Math.floor(l/60)>=10?Math.floor(l/60):"0"+Math.floor(l/60),N=()=>{if(s.length===0){y("select",null);return}const l=+u.minHour*60+Number(u.timeStep)*n.value+Number(u.timeStep),r=+u.minHour*60+Number(u.timeStep)*t.value+Number(u.timeStep);console.log("startTime, startTime",l,l);let e="",a="",m="",f="",w="",I="";l&&r?(m=b(l-u.timeStep),e=b(r),f=(l-u.timeStep)%60===0?"00":Math.round(((l-u.timeStep)/60-m)*60),a=r%60===0?"00":Math.round((r/60-e)*60),w=m+":"+f,e===24&&(e=23,a=59),I=e+":"+a):(m=b(l-u.timeStep),e=b(l),f=(l-u.timeStep)%60===0?"00":Math.round(((l-u.timeStep)/60-m)*60),a=l%60===0?"00":Math.round((l/60-e)*60),w=m+":"+f,e===24&&(e=23,a=59),I=e+":"+a),y("select",[w,I])},M=()=>{console.log("initTimeData");const l=parseInt(new Date().getHours()),r=parseInt(new Date().getMinutes()),e=l*60+r;console.log(l,r,e);const a=[],m=f=>{const w=[],I=60/u.timeStep*(f-u.minHour),q=(B,p)=>{if(!u.disabledBefore)return!1;if(B<l)return!0;if(l===B){const o=u.timeStep*(p-1),T=u.timeStep*p;if(r>=o&&r<=T||r>=T)return!0}};for(let B=1;B<=60/u.timeStep;B++)w.push({value:f*60+u.timeStep*B,selected:!1,disabled:q(f,B),index:I+B-1});return w};for(let f=+u.minHour;f<=+u.maxHour;f++){const w={time:"",blocks:m(f)};w.time=f*60,a.push(w)}S.value=a},k=(l,r,e)=>{if(u.readonly)return!1;if(u.disabledBefore&&M(),!r.disabled){if(console.log("点击时间块",l.time,r.value,e),n.value===void 0&&t.value===void 0)n.value=s[0]=e,console.log("首次选择",e);else if(n.value!==void 0&&t.value===void 0){if(console.log("只有开始时间时"),e===n.value&&s.indexOf(e)>-1&&(s.splice(s.indexOf(e),1),n.value=t.value=void 0),e>n.value){t.value=e,console.log("向右选择时",n.value,t.value),s.splice(0);for(let a=n.value;a<=t.value;a++)s.splice(a-n.value,0,a)}if(e<n.value){const[a,m]=[e,n.value];n.value=a,t.value=m,console.log("结束时间小于开始时",n.value,t.value),s.splice(0);for(let f=n.value;f<=t.value;f++)s.splice(f-n.value,0,f)}}else if(n.value!==void 0&&t.value!==void 0){if(e===n.value){const a=s.indexOf(e);s.splice(a,1),s.length?n.value=s[0]:n.value=t.value=void 0}else if(e===t.value){const a=s.indexOf(e);s.splice(a,1),t.value=s[s.length-1],n.value===t.value&&(t.value=void 0)}else if(e<n.value)console.log("同时存在开始结束时间，向左则重置选择"),s.splice(0),n.value=t.value=void 0;else if(e>n.value){t.value=e,console.log("向右选择时",n.value,t.value),s.splice(0);for(let a=n.value;a<=t.value;a++)s.splice(a-n.value,0,a)}}N()}};return(l,r)=>(h(),$("div",je,[i.showArrow?(h(),$("div",{key:0,class:"time-picker-prev",onClick:r[0]||(r[0]=e=>H(1))},"<")):Y("",!0),W("div",We,[W("div",{class:G(["time-wrapper",{"time-wrapper__fixed":i.fixed}])},[(h(!0),$(ee,null,te(c(S),(e,a)=>(h(),$("div",{key:e.time+a,class:G(["time-bar",[{"time-bar--fixed-start":i.fixed&&a==0,"time-bar--fixed-end":i.fixed&&c(S).length-1===a,paddingno:i.fixed&&c(S).length-2===a}]])},[W("span",qe,ye(b(e.time)+":00"),1),W("div",Ee,[(h(!0),$(ee,null,te(e.blocks,m=>(h(),$("div",{key:m.value,"data-val":m.value,"data-idx":m.index,class:G(["time-block",{"time-block--selected":c(s).includes(m.index),"time-block--readonly":i.readonly,"time-block--disabled":m.disabled}]),onClick:f=>k(e,m,m.index)},null,10,Le))),128))])],2))),128))],2)]),i.showArrow?(h(),$("div",{key:1,class:"time-picker-next",onClick:r[1]||(r[1]=e=>H(-1))},">")):Y("",!0)]))}}),Ke=se(Je,[["__scopeId","data-v-fc6b28f0"]]);const Xe={class:"color-wrapper"},Ze={__name:"time-range-picker",setup(i){const y=_(),u=_(null),g=j({minHour:"00",maxHour:"23",timeStep:30,blockColor:ie,fixed:!1,readonly:!1,disabledBefore:!1}),{minHour:P,maxHour:U,timeStep:S,disabledBefore:s,fixed:n,readonly:t,blockColor:x}=we(g),H=(p,o)=>{console.log(p,o);const T=p?p[0]+" ~ "+p[1]:"";y.value=T},b=_(!1),N=_(["00","23"]),M=ae(()=>P.value+" ~ "+U.value),k=_(!1),l=()=>{k.value=!0},r=({selectedValues:p,selectedOptions:o})=>{console.log(p,o);const[T,R]=N.value;P.value=T,U.value=R,y.value="",k.value=!1},e=_(!1),a=[{text:"10分",value:10},{text:"15分",value:15},{text:"20分",value:20},{text:"30分",value:30},{text:"60分",value:60}],m=()=>{e.value=!0},f=({selectedOptions:p})=>{e.value=!1,S.value=p[0].value,y.value=""},w=async()=>{await ue(),y.value=""},I=(p,o)=>p==="minute"?o.filter(T=>Number(T.value)<=23):o,q=(p,o)=>(p==="hour"&&(o.text+="时开始"),p==="minute"&&(o.text+="时结束"),o),B=p=>{console.log("主题色",p)};return(p,o)=>{const T=Ie,R=$e,D=Ue,Z=Re,E=Ne,me=Fe,L=Te,de=re,ce=Ke,fe=ve,A=Ve("waves");return h(),z(fe,{class:"time-range-picker"},{default:C(()=>[v(T,{title:"配置项",border:!0,value:`已选时间 ${c(y)||""}`},null,8,["value"]),v(Z,{type:"flex",justify:"center"},{default:C(()=>[F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{modelValue:c(x),"onUpdate:modelValue":o[0]||(o[0]=d=>V(x)?x.value=d:null),label:"高亮颜色","label-align":"top",readonly:"","is-link":"",onClick:o[1]||(o[1]=d=>b.value=!0)},null,8,["modelValue"])]),_:1})),[[A]]),F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{modelValue:c(M),"onUpdate:modelValue":o[2]||(o[2]=d=>V(M)?M.value=d:null),label:"时间范围",placeholder:"自定义范围","label-align":"top",readonly:"","is-link":"",border:!0,onClick:l},null,8,["modelValue"])]),_:1})),[[A]]),F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{modelValue:c(S),"onUpdate:modelValue":o[3]||(o[3]=d=>V(S)?S.value=d:null),label:"间隔（分）",placeholder:"规定时间间隔","label-align":"top",readonly:"","is-link":"",border:!0,onClick:m},null,8,["modelValue"])]),_:1})),[[A]])]),_:1}),v(Z,{type:"flex",justify:"center"},{default:C(()=>[F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{label:"禁用过去","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(s),"onUpdate:modelValue":o[4]||(o[4]=d=>V(s)?s.value=d:null),size:c(K)(18),onChange:w},null,8,["modelValue","size"])]),_:1})]),_:1})),[[A]]),F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{label:"固定两端","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(n),"onUpdate:modelValue":o[5]||(o[5]=d=>V(n)?n.value=d:null),size:c(K)(18)},null,8,["modelValue","size"])]),_:1})]),_:1})),[[A]]),F((h(),z(D,{span:"8"},{default:C(()=>[v(R,{label:"只读","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(t),"onUpdate:modelValue":o[6]||(o[6]=d=>V(t)?t.value=d:null),size:c(K)(18)},null,8,["modelValue","size"])]),_:1})]),_:1})),[[A]])]),_:1}),v(L,{show:c(k),"onUpdate:show":o[9]||(o[9]=d=>V(k)?k.value=d:null),position:"bottom"},{default:C(()=>[v(me,{modelValue:c(N),"onUpdate:modelValue":o[7]||(o[7]=d=>V(N)?N.value=d:null),title:"选择小时范围",filter:I,formatter:q,"is-link":"",onCancel:o[8]||(o[8]=d=>k.value=!1),onConfirm:r},null,8,["modelValue"])]),_:1},8,["show"]),v(L,{show:c(e),"onUpdate:show":o[11]||(o[11]=d=>V(e)?e.value=d:null),position:"bottom"},{default:C(()=>[v(de,{title:"时间间隔",columns:a,onCancel:o[10]||(o[10]=d=>e.value=!1),onConfirm:f})]),_:1},8,["show"]),v(L,{show:c(b),"onUpdate:show":o[13]||(o[13]=d=>V(b)?b.value=d:null)},{default:C(()=>[W("div",Xe,[v(c(Be),{pureColor:c(x),"onUpdate:pureColor":o[12]||(o[12]=d=>V(x)?x.value=d:null),"is-widget":!0,"disable-alpha":"",format:"hex","picker-type":"chrome","use-type":"pure",onPureColorChange:B},null,8,["pureColor"])])]),_:1},8,["show"]),v(ce,ne({ref_key:"timePickerRef",ref:u},c(g),{onSelect:o[14]||(o[14]=d=>H(d))}),null,16),v(T,{title:"该组件为自研组件，后续提供更灵活定制选项，有时间再优化动态预览配置~",border:!1})]),_:1})}}},pt=se(Ze,[["__scopeId","data-v-3cbf9b8e"]]);export{pt as default};
