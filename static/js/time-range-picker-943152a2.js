import{ab as fe,ai as ve,an as A,d as oe,a as _,c as ae,w as X,cF as Y,p as v,m as ne,al as pe,am as ge,cI as _e,a3 as ie,r as j,da as be,o as ke,B as se,a2 as xe,k as R,s as Z,x as W,z as G,F as ee,G as te,u as c,f as h,y as Ce,$ as he,t as ye,q as C,J as V,a7 as Se,v as O,g as F,M as we}from"./index-2d318566.js";import{_ as ue}from"./plugin-vue_export-helper-c27b6911.js";/* empty css              */import{s as Te,g as J,f as Ve,p as Pe,P as re}from"./index-c31337e6.js";import{o as He,S as Me}from"./style-30569755.js";import{R as Be,C as Ne}from"./index-06ab4992.js";import{C as Ue}from"./index-434b4cca.js";import{F as $e}from"./index-f2118f16.js";import{p as K}from"./index-45ffbb49.js";import"./use-sync-prop-ref-a7fb8ef7.js";import"./index-08eb4df6.js";import"./use-id-0b0c73bf.js";import"./use-route-e384b3a3.js";import"./index-5561415e.js";import"./popper-f3391c26.js";const[Re]=fe("time-picker"),le=i=>/^([01]\d|2[0-3]):([0-5]\d):([0-5]\d)$/.test(i),Ie=["hour","minute","second"],ze=ve({},Te,{minHour:A(0),maxHour:A(23),minMinute:A(0),maxMinute:A(59),minSecond:A(0),maxSecond:A(59),minTime:{type:String,validator:le},maxTime:{type:String,validator:le},columnsType:{type:Array,default:()=>["hour","minute"]},filter:Function});var De=oe({name:Re,props:ze,emits:["confirm","cancel","change","update:modelValue"],setup(i,{emit:y,slots:s}){const g=_(i.modelValue),P=t=>{const x=t.split(":");return Ie.map((H,b)=>i.columnsType.includes(H)?x[b]:"00")},U=ae(()=>{let{minHour:t,maxHour:x,minMinute:H,maxMinute:b,minSecond:N,maxSecond:M}=i;if(i.minTime||i.maxTime){const k={hour:0,minute:0,second:0};i.columnsType.forEach((e,a)=>{var m;k[e]=(m=g.value[a])!=null?m:0});const{hour:l,minute:r}=k;if(i.minTime){const[e,a,m]=P(i.minTime);t=e,H=+l<=+t?a:"00",N=+l<=+t&&+r<=+H?m:"00"}if(i.maxTime){const[e,a,m]=P(i.maxTime);x=e,b=+l>=+x?a:"59",M=+l>=+x&&+r>=+b?m:"59"}}return i.columnsType.map(k=>{const{filter:l,formatter:r}=i;switch(k){case"hour":return J(+t,+x,k,r,l,g.value);case"minute":return J(+H,+b,k,r,l,g.value);case"second":return J(+N,+M,k,r,l,g.value);default:return[]}})});X(g,t=>{Y(t,i.modelValue)||y("update:modelValue",t)}),X(()=>i.modelValue,t=>{t=Ve(t,U.value),Y(t,g.value)||(g.value=t)},{immediate:!0});const S=(...t)=>y("change",...t),u=(...t)=>y("cancel",...t),n=(...t)=>y("confirm",...t);return()=>v(re,ne({modelValue:g.value,"onUpdate:modelValue":t=>g.value=t,columns:U.value,onChange:S,onCancel:u,onConfirm:n},pe(i,Pe)),s)}});const Ae=ge(De);const Oe={class:"time-picker"},Fe={class:"time-scroll"},je={class:"time-text"},We={class:"time-full"},qe=["data-val","data-idx","onClick"],Ee=oe({name:"TimePicker"}),Le=Object.assign(Ee,{props:{modelValue:{type:Array,default:()=>[]},minHour:{type:[Number,String],default:"0"},maxHour:{type:[Number,String],default:"23"},visibleNum:{type:[Number,String],default:"8"},timeStep:{type:[Number,String],default:"30",validator:i=>60%i===0},blockColor:{type:String,default:_e.get("themeColor")||ie||"#2e6cf3"},showArrow:Boolean,fixed:Boolean,readonly:Boolean,disabledBefore:Boolean},emits:["select"],setup(i,{emit:y}){const s=i;he(l=>({"22bfa96c":c(U),db62b176:i.blockColor}));const g=_(0);_(!0),_(0);const P=_(0),U=_("");j([]),j([]),j([]);const S=_([]);_([]);const u=j([]),n=_(),t=_();_(!1),be(document.body,l=>{}),X(()=>s,l=>{M()},{deep:!0}),ke(()=>{M(),x()});const x=async()=>{var l;await se(),P.value=(l=document.querySelector(".time-bar"))==null?void 0:l.getBoundingClientRect().width,U.value=P.value/xe+"rem"},H=l=>{if(g.value+=P.value*l,g.value===P.value){g.value=0;return}console.log(g.value)},b=l=>Math.floor(l/60)>=10?Math.floor(l/60):"0"+Math.floor(l/60),N=()=>{if(u.length===0){y("select",null);return}const l=+s.minHour*60+Number(s.timeStep)*n.value+Number(s.timeStep),r=+s.minHour*60+Number(s.timeStep)*t.value+Number(s.timeStep);console.log("startTime, startTime",l,l);let e="",a="",m="",f="",w="",I="";l&&r?(m=b(l-s.timeStep),e=b(r),f=(l-s.timeStep)%60===0?"00":Math.round(((l-s.timeStep)/60-m)*60),a=r%60===0?"00":Math.round((r/60-e)*60),w=m+":"+f,e===24&&(e=23,a=59),I=e+":"+a):(m=b(l-s.timeStep),e=b(l),f=(l-s.timeStep)%60===0?"00":Math.round(((l-s.timeStep)/60-m)*60),a=l%60===0?"00":Math.round((l/60-e)*60),w=m+":"+f,e===24&&(e=23,a=59),I=e+":"+a),y("select",[w,I])},M=()=>{console.log("initTimeData");const l=parseInt(new Date().getHours()),r=parseInt(new Date().getMinutes()),e=l*60+r;console.log(l,r,e);const a=[],m=f=>{const w=[],I=60/s.timeStep*(f-s.minHour),q=(B,p)=>{if(!s.disabledBefore)return!1;if(B<l)return!0;if(l===B){const o=s.timeStep*(p-1),T=s.timeStep*p;if(r>=o&&r<=T||r>=T)return!0}};for(let B=1;B<=60/s.timeStep;B++)w.push({value:f*60+s.timeStep*B,selected:!1,disabled:q(f,B),index:I+B-1});return w};for(let f=+s.minHour;f<=+s.maxHour;f++){const w={time:"",blocks:m(f)};w.time=f*60,a.push(w)}S.value=a},k=(l,r,e)=>{if(s.readonly)return!1;if(s.disabledBefore&&M(),!r.disabled){if(console.log("点击时间块",l.time,r.value,e),n.value===void 0&&t.value===void 0)n.value=u[0]=e,console.log("首次选择",e);else if(n.value!==void 0&&t.value===void 0){if(console.log("只有开始时间时"),e===n.value&&u.indexOf(e)>-1&&(u.splice(u.indexOf(e),1),n.value=t.value=void 0),e>n.value){t.value=e,console.log("向右选择时",n.value,t.value),u.splice(0);for(let a=n.value;a<=t.value;a++)u.splice(a-n.value,0,a)}if(e<n.value){const[a,m]=[e,n.value];n.value=a,t.value=m,console.log("结束时间小于开始时",n.value,t.value),u.splice(0);for(let f=n.value;f<=t.value;f++)u.splice(f-n.value,0,f)}}else if(n.value!==void 0&&t.value!==void 0){if(e===n.value){const a=u.indexOf(e);u.splice(a,1),u.length?n.value=u[0]:n.value=t.value=void 0}else if(e===t.value){const a=u.indexOf(e);u.splice(a,1),t.value=u[u.length-1],n.value===t.value&&(t.value=void 0)}else if(e<n.value)console.log("同时存在开始结束时间，向左则重置选择"),u.splice(0),n.value=t.value=void 0;else if(e>n.value){t.value=e,console.log("向右选择时",n.value,t.value),u.splice(0);for(let a=n.value;a<=t.value;a++)u.splice(a-n.value,0,a)}}N()}};return(l,r)=>(h(),R("div",Oe,[i.showArrow?(h(),R("div",{key:0,class:"time-picker-prev",onClick:r[0]||(r[0]=e=>H(1))},"<")):Z("",!0),W("div",Fe,[W("div",{class:G(["time-wrapper",{"time-wrapper__fixed":i.fixed}])},[(h(!0),R(ee,null,te(c(S),(e,a)=>(h(),R("div",{key:e.time+a,class:G(["time-bar",[{"time-bar--fixed-start":i.fixed&&a==0,"time-bar--fixed-end":i.fixed&&c(S).length-1===a,paddingno:i.fixed&&c(S).length-2===a}]])},[W("span",je,Ce(b(e.time)+":00"),1),W("div",We,[(h(!0),R(ee,null,te(e.blocks,m=>(h(),R("div",{key:m.value,"data-val":m.value,"data-idx":m.index,class:G(["time-block",{"time-block--selected":c(u).includes(m.index),"time-block--readonly":i.readonly,"time-block--disabled":m.disabled}]),onClick:f=>k(e,m,m.index)},null,10,qe))),128))])],2))),128))],2)]),i.showArrow?(h(),R("div",{key:1,class:"time-picker-next",onClick:r[1]||(r[1]=e=>H(-1))},">")):Z("",!0)]))}}),Ge=ue(Le,[["__scopeId","data-v-fc6b28f0"]]);const Je={class:"time-range-picker"},Ke={class:"color-wrapper"},Xe={__name:"time-range-picker",setup(i){const y=_(),s=_(null),g=j({minHour:"00",maxHour:"23",timeStep:30,blockColor:ie,fixed:!1,readonly:!1,disabledBefore:!1}),{minHour:P,maxHour:U,timeStep:S,disabledBefore:u,fixed:n,readonly:t,blockColor:x}=ye(g),H=(p,o)=>{console.log(p,o);const T=p?p[0]+" ~ "+p[1]:"";y.value=T},b=_(!1),N=_(["00","23"]),M=ae(()=>P.value+" ~ "+U.value),k=_(!1),l=()=>{k.value=!0},r=({selectedValues:p,selectedOptions:o})=>{console.log(p,o);const[T,$]=N.value;P.value=T,U.value=$,y.value="",k.value=!1},e=_(!1),a=[{text:"10分",value:10},{text:"15分",value:15},{text:"20分",value:20},{text:"30分",value:30},{text:"60分",value:60}],m=()=>{e.value=!0},f=({selectedOptions:p})=>{e.value=!1,S.value=p[0].value,y.value=""},w=async()=>{await se(),y.value=""},I=(p,o)=>p==="minute"?o.filter(T=>Number(T.value)<=23):o,q=(p,o)=>(p==="hour"&&(o.text+="时开始"),p==="minute"&&(o.text+="时结束"),o),B=p=>{console.log("主题色",p)};return(p,o)=>{const T=Ue,$=$e,z=Ne,Q=Be,E=Me,me=Ae,L=Se,de=re,ce=Ge,D=we("waves");return h(),R("div",Je,[v(T,{title:"配置项",border:!0,value:`已选时间 ${c(y)||""}`},null,8,["value"]),v(Q,{type:"flex",justify:"center"},{default:C(()=>[O((h(),F(z,{span:"8"},{default:C(()=>[v($,{modelValue:c(x),"onUpdate:modelValue":o[0]||(o[0]=d=>V(x)?x.value=d:null),label:"高亮颜色","label-align":"top",readonly:"","is-link":"",onClick:o[1]||(o[1]=d=>b.value=!0)},null,8,["modelValue"])]),_:1})),[[D]]),O((h(),F(z,{span:"8"},{default:C(()=>[v($,{modelValue:c(M),"onUpdate:modelValue":o[2]||(o[2]=d=>V(M)?M.value=d:null),label:"时间范围",placeholder:"自定义范围","label-align":"top",readonly:"","is-link":"",border:!0,onClick:l},null,8,["modelValue"])]),_:1})),[[D]]),O((h(),F(z,{span:"8"},{default:C(()=>[v($,{modelValue:c(S),"onUpdate:modelValue":o[3]||(o[3]=d=>V(S)?S.value=d:null),label:"间隔（分）",placeholder:"规定时间间隔","label-align":"top",readonly:"","is-link":"",border:!0,onClick:m},null,8,["modelValue"])]),_:1})),[[D]])]),_:1}),v(Q,{type:"flex",justify:"center"},{default:C(()=>[O((h(),F(z,{span:"8"},{default:C(()=>[v($,{label:"禁用过去","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(u),"onUpdate:modelValue":o[4]||(o[4]=d=>V(u)?u.value=d:null),size:c(K)(18),onChange:w},null,8,["modelValue","size"])]),_:1})]),_:1})),[[D]]),O((h(),F(z,{span:"8"},{default:C(()=>[v($,{label:"固定两端","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(n),"onUpdate:modelValue":o[5]||(o[5]=d=>V(n)?n.value=d:null),size:c(K)(18)},null,8,["modelValue","size"])]),_:1})]),_:1})),[[D]]),O((h(),F(z,{span:"8"},{default:C(()=>[v($,{label:"只读","label-align":"top"},{input:C(()=>[v(E,{modelValue:c(t),"onUpdate:modelValue":o[6]||(o[6]=d=>V(t)?t.value=d:null),size:c(K)(18)},null,8,["modelValue","size"])]),_:1})]),_:1})),[[D]])]),_:1}),v(L,{show:c(k),"onUpdate:show":o[9]||(o[9]=d=>V(k)?k.value=d:null),position:"bottom"},{default:C(()=>[v(me,{modelValue:c(N),"onUpdate:modelValue":o[7]||(o[7]=d=>V(N)?N.value=d:null),title:"选择小时范围",filter:I,formatter:q,"is-link":"",onCancel:o[8]||(o[8]=d=>k.value=!1),onConfirm:r},null,8,["modelValue"])]),_:1},8,["show"]),v(L,{show:c(e),"onUpdate:show":o[11]||(o[11]=d=>V(e)?e.value=d:null),position:"bottom"},{default:C(()=>[v(de,{title:"时间间隔",columns:a,onCancel:o[10]||(o[10]=d=>e.value=!1),onConfirm:f})]),_:1},8,["show"]),v(L,{show:c(b),"onUpdate:show":o[13]||(o[13]=d=>V(b)?b.value=d:null)},{default:C(()=>[W("div",Ke,[v(c(He),{pureColor:c(x),"onUpdate:pureColor":o[12]||(o[12]=d=>V(x)?x.value=d:null),"is-widget":!0,"disable-alpha":"",format:"hex","picker-type":"chrome","use-type":"pure",onPureColorChange:B},null,8,["pureColor"])])]),_:1},8,["show"]),v(ce,ne({ref_key:"timePickerRef",ref:s},c(g),{onSelect:o[14]||(o[14]=d=>H(d))}),null,16),v(T,{title:"该组件为自研组件，后续提供更灵活定制选项，有时间再优化动态预览配置~",border:!1})])}}},ct=ue(Xe,[["__scopeId","data-v-ae2648ce"]]);export{ct as default};
