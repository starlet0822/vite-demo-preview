import{_ as B}from"./index-4f78cf3f.js";import{_ as R}from"./index-28dbdae4.js";import{a7 as j,d as O,a as r,o as F,de as G,g as k,q as a,U as J,ab as M,df as q,f as g,p as i,x as c,u as m,J as b,k as D,G as E,y,I as Q,F as X,s as z,X as A,Q as H,R as K}from"./index-4a1a9842.js";import{s as P,C as W}from"./index-19135122.js";import{C as Y}from"./index-59b7ecd9.js";import"./index-9113b46e.js";import{T as Z}from"./index-4b036e25.js";import"./index-13b99f4f.js";import{S as $}from"./index-4f5687f6.js";import{_ as ee}from"./index-75079144.js";import{_ as oe}from"./plugin-vue_export-helper-c27b6911.js";import{I as te}from"./index-b5bc300a.js";import"./index-d9f0e8c9.js";import"./use-placeholder-9d7764e4.js";import"./use-route-4a788c49.js";import"./use-id-c0fc632f.js";const se=j(P);const ae=p=>(H("data-v-520df55c"),p=p(),K(),p),ne=ae(()=>c("div",{class:"st-color-blue"},"完成",-1)),ce={class:"st-margin-5 van-hairline--bottom"},le={class:"st-flex-ai"},re={class:"st-margin-left-15"},ie={class:"custom-title"},ue={class:"checkbox"},_e=O({name:"picker.user"}),de=Object.assign(_e,{setup(p){const x=J();console.log("router:",x);const f=r(""),u=r([]),_=r([]),d=r([]);r(0);const v=r(null),C=async()=>{var o;v.value=M({});try{const s=await q({all:!0});if(s.code===0){const{rows:n,total:l}=s.data??{};d.value=_.value=n}}catch(e){console.error("捕获异常",e)}finally{(o=v.value)==null||o.close(),v.value=null}},V=()=>{const o=f.value.trim();o?_.value=d.value.filter(({name:e,job:s,deptName:n})=>(e+s+n).indexOf(o.trim())!==-1):_.value=d.value},w=async()=>{console.log("onSelect"),d.value.reduce((o,e)=>(u.value.includes(e.id)&&o.push(A(e,["id","name"])),o),[]),x.back()},S=({id:o})=>{};return F(()=>{C()}),G((o,e,s)=>{const n=d.value.reduce((l,h)=>(u.value.includes(h.id)&&l.push(h),l),[]);e.params.users=JSON.stringify(n),s()}),(o,e)=>{const s=ee,n=$,l=te,h=Z,I=W,L=Y,T=se,N=R,U=B;return g(),k(U,{class:"user-picker"},{header:a(()=>[i(s,{"left-text":"关闭","left-arrow":!1,onClickRight:w},{right:a(()=>[ne]),_:1}),c("div",ce,[i(n,{modelValue:m(f),"onUpdate:modelValue":e[0]||(e[0]=t=>b(f)?f.value=t:null),modelModifiers:{trim:!0},shape:"round",placeholder:"搜索","show-action":""},{action:a(()=>[c("div",{onClick:V},"搜索")]),_:1},8,["modelValue"])])]),default:a(()=>[i(T,{modelValue:m(u),"onUpdate:modelValue":e[1]||(e[1]=t=>b(u)?u.value=t:null)},{default:a(()=>[(g(!0),D(X,null,E(m(_),t=>(g(),k(L,{key:t.id,center:"",class:"user-item","title-class":"user-info","value-class":"checkbox",onClick:S},{title:a(()=>[c("div",le,[i(l,{src:t.avatar,width:"2em",height:"2em",round:""},null,8,["src"]),c("div",re,[c("div",ie,y(t.name),1),i(h,{type:"default",plain:""},{default:a(()=>[Q(y([t.deptName,t.job].join(" / ")),1)]),_:2},1024)])])]),value:a(()=>[c("div",ue,[i(I,{name:t.id},null,8,["name"])])]),_:2},1024))),128))]),_:1},8,["modelValue"]),!m(_).length&&!m(v)?(g(),k(N,{key:0,description:"搜索结果为空"})):z("",!0)]),_:1})}}}),Te=oe(de,[["__scopeId","data-v-520df55c"]]);export{Te as default};
