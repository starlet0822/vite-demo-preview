import{a as ref,r as reactive,o as onMounted,n as computed,C as nextTick,M as toRef,i as watch,e as openBlock,j as createElementBlock,J as isVNode,N as markRaw,d as defineComponent,f as createVNode,D as getCurrentInstance,b as resolveComponent,h as createBaseVNode,G as withDirectives,O as createApp,I as h,m as mergeProps$1,F as Fragment,P as provide,Q as inject,q as toRefs,p as onBeforeUnmount,R as onUpdated,S as resolveDirective,c as createBlock,w as withCtx,g as createTextVNode,u as unref}from"./index-23cd956f.js";function useScrollToField(r,t){if(!r||!t)return!1;const e=Object.keys(t),[n]=e.length&&e;r==null||r.scrollToField(n)}function useElForm(){const r=ref(),t=reactive({input:"",textarea:"",num:1,radio:"",rate:4,select:"",slider:50,switch:!0,autocomplete:"",cascader:"",checkList:[],color:"#409EFF",date:"",time:"",datetime:"",transfer:[],fileList:[]}),e=reactive({input:[{required:!0,message:"请输入内容",trigger:"blur"}],select:[{required:!0,message:"请选择选项",trigger:"change"}],fileList:[{required:!0,message:"请上传附件",trigger:"change"}]}),n=ref([]),i=(f,d)=>{const p=y=>$=>$.value.toLowerCase().indexOf(y.toLowerCase())===0,g=f?n.value.filter(p(f)):n.value;d(g)},o=()=>[{value:"vue",link:"https://github.com/vuejs/vue"},{value:"element",link:"https://github.com/ElemeFE/element"},{value:"cooking",link:"https://github.com/ElemeFE/cooking"},{value:"mint-ui",link:"https://github.com/ElemeFE/mint-ui"},{value:"vuex",link:"https://github.com/vuejs/vuex"},{value:"vue-router",link:"https://github.com/vuejs/vue-router"},{value:"babel",link:"https://github.com/babel/babel"}],a=[{value:"guide",label:"Guide",children:[{value:"disciplines",label:"Disciplines",children:[{value:"consistency",label:"Consistency"},{value:"feedback",label:"Feedback"}]},{value:"navigation",label:"Navigation",children:[{value:"side nav",label:"Side Navigation"},{value:"top nav",label:"Top Navigation"}]}]}],s=ref((()=>{const f=[];for(let d=1;d<=10;d++)f.push({key:d,label:`字段 ${d}`,disabled:d%4===0});return f})()),l=async()=>{var f;await((f=r.value)==null?void 0:f.validate((d,p)=>{if(!d)return useScrollToField(r.value,p),!1}))},c=()=>{var f;(f=r.value)==null||f.resetFields()};return onMounted(()=>{n.value=o()}),{formRef:r,formValues:t,formRules:e,cascaderOptions:a,transferData:s,loadAll:o,querySearch:i,onSubmit:l,onReset:c}}function useCreateForm(){const{formValues:r,cascaderOptions:t,transferData:e,querySearch:n}=useElForm(),i=ref(),o=reactive({fApi:{},options:{submitBtn:{show:!0},resetBtn:{show:!0}},rule:[{type:"input",field:"input",title:"输入框",value:"",props:{placeholder:"请输入"},validate:[{required:!0,message:"请输入内容",trigger:"blur"}]},{type:"input",field:"textarea",title:"文本域输入框",value:"",props:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请输入"}},{type:"input-number",field:"num",title:"数字输入框",value:1,props:{min:1,max:10}},{type:"radio",field:"radio",title:"单选框",value:"1",options:[{value:"1",label:"选项 1"},{value:"2",label:"选项 2"}]},{type:"rate",field:"rate",title:"评分",value:4},{type:"select",field:"select",title:"下拉选择器",value:"",options:[{value:"1",label:"选项 1"},{value:"2",label:"选项 2"}],props:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"请选择"},validate:[{required:!0,message:"请选择选项",trigger:"change"}]},{type:"slider",field:"slider",title:"滑块",value:50},{type:"switch",field:"switch",title:"开关",value:!0},{type:"autoComplete",title:"自动补全输入框",field:"autocomplete",value:"",props:{placeholder:"请输入",clearable:!0,fetchSuggestions:n}},{type:"cascader",field:"cascader",title:"级联选择器",value:"",props:{options:t}},{type:"checkbox",field:"checkList",title:"多选框",value:[],options:[{label:"选项 1",value:1},{label:"选项 2",value:2},{label:"禁用选项",value:3,disabled:!0}]},{type:"color-picker",field:"color",title:"颜色选择器",value:"#409EFF"},{type:"date-picker",field:"date",title:"日期选择器",value:"",props:{type:"date",placeholder:"请选择"}},{type:"time-picker",field:"time",title:"时间选择器",value:"",props:{placeholder:"请选择"}},{type:"el-transfer",field:"transfer",title:"穿梭框",value:[],props:{data:e}},{type:"upload",field:"fileList",title:"上传",value:[],props:{listType:"picture-card",fileList:[],uploadType:"image",action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15",multiple:!0,accept:"image/*",onSuccess(a){a.url=a.response.url||"http://form-create.com/logo.png"}}}]});return{formCreateRef:i,formCreate:o}}/*!
 * @form-create/element-ui v3.1.22
 * (c) 2018-2023 xaboy
 * Github https://github.com/xaboy/form-create
 * Released under the MIT License.
 */function ownKeys(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),e.push.apply(e,n)}return e}function _objectSpread2(r){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?ownKeys(Object(e),!0).forEach(function(n){_defineProperty(r,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):ownKeys(Object(e)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(e,n))})}return r}function _typeof(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(t){return typeof t}:_typeof=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(r)}function _classCallCheck(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperty(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}function _inherits(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&_setPrototypeOf(r,t)}function _getPrototypeOf(r){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(r)}function _setPrototypeOf(r,t){return _setPrototypeOf=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},_setPrototypeOf(r,t)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _assertThisInitialized(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _possibleConstructorReturn(r,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(r)}function _createSuper(r){var t=_isNativeReflectConstruct();return function(){var n=_getPrototypeOf(r),i;if(t){var o=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _iterableToArray(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function _unsupportedIterableToArray(r,t){if(r){if(typeof r=="string")return _arrayLikeToArray(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _arrayLikeToArray(r,t)}}function _arrayLikeToArray(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function getSlot(r,t){return Object.keys(r).reduce(function(e,n){return(!t||t.indexOf(n)===-1)&&e.push(r[n]),e},[])}var NAME$9="fcCheckbox",Checkbox=defineComponent({name:NAME$9,inheritAttrs:!1,props:{formCreateInject:Object,modelValue:{type:Array,default:function(){return[]}},type:String},emits:["update:modelValue"],setup:function(t,e){var n=toRef(t.formCreateInject,"options",[]),i=toRef(t,"modelValue"),o=function(){return Array.isArray(n.value)?n.value:[]};return{options:o,value:i,onInput:function(u){e.emit("update:modelValue",u)}}},render:function(){var t,e,n=this,i=this.type==="button"?"ElCheckboxButton":"ElCheckbox",o=resolveComponent(i);return createVNode(resolveComponent("ElCheckboxGroup"),mergeProps$1(this.$attrs,{modelValue:this.value,"onUpdate:modelValue":this.onInput}),_objectSpread2({default:function(){return[n.options().map(function(u,s){var l=_objectSpread2({},u),c=l.value;return delete l.value,createVNode(o,mergeProps$1(l,{label:c,key:i+s+"-"+u.value}),{default:function(){return[l.label||l.value||""]}})}),(t=(e=n.$slots).default)===null||t===void 0?void 0:t.call(e)]}},getSlot(this.$slots,["default"])))}});function toArray(r){return Array.isArray(r)?r:[null,void 0,""].indexOf(r)>-1?[]:[r]}function Mitt(r){r=r||new Map;var t={$on:function(n,i){var o=r.get(n),a=o&&o.push(i);a||r.set(n,[i])},$once:function(n,i){i._once=!0,t.$on(n,i)},$off:function(n,i){var o=r.get(n);o&&o.splice(o.indexOf(i)>>>0,1)},$emit:function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(r.get(n)||[]).slice().map(function(u){u._once&&(t.$off(n,u),delete u._once),u.apply(void 0,o)}),(r.get("*")||[]).slice().map(function(u){u(n,o)})}};return t}function styleInject(r,t){t===void 0&&(t={});var e=t.insertAt;if(!(!r||typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",e==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r))}}var css_248z$2="._fc-frame ._fc-files img{display:inline-block;height:100%;vertical-align:top;width:100%}._fc-frame ._fc-upload-btn{border:1px dashed #c0ccda;cursor:pointer}._fc-frame ._fc-upload-cover{background:rgba(0,0,0,.6);bottom:0;left:0;opacity:0;position:absolute;right:0;top:0;-webkit-transition:opacity .3s;-o-transition:opacity .3s;transition:opacity .3s}._fc-frame ._fc-upload-cover i{color:#fff;cursor:pointer;font-size:20px;margin:0 2px}._fc-frame ._fc-files:hover ._fc-upload-cover{opacity:1}._fc-frame .el-upload{display:block}._fc-frame ._fc-upload-icon{cursor:pointer}._fc-files,._fc-frame ._fc-upload-btn{background:#fff;border:1px solid #c0ccda;border-radius:4px;-webkit-box-shadow:2px 2px 5px rgba(0,0,0,.1);box-shadow:2px 2px 5px rgba(0,0,0,.1);-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;height:58px;line-height:58px;margin-right:4px;overflow:hidden;position:relative;text-align:center;width:58px}";styleInject(css_248z$2);var script$8={name:"IconCircleClose"},_hoisted_1$8={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$8=createBaseVNode("path",{fill:"currentColor",d:"M466.752 512l-90.496-90.496a32 32 0 0145.248-45.248L512 466.752l90.496-90.496a32 32 0 1145.248 45.248L557.248 512l90.496 90.496a32 32 0 11-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 01-45.248-45.248L466.752 512z"},null,-1),_hoisted_3$8=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 100-768 384 384 0 000 768zm0 64a448 448 0 110-896 448 448 0 010 896z"},null,-1),_hoisted_4$2=[_hoisted_2$8,_hoisted_3$8];function render$8(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$8,_hoisted_4$2)}script$8.render=render$8;var script$7={name:"IconDocument"},_hoisted_1$7={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$7=createBaseVNode("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 01-32 32H160a32 32 0 01-32-32V96a32 32 0 0132-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1),_hoisted_3$7=[_hoisted_2$7];function render$7(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$7,_hoisted_3$7)}script$7.render=render$7;var script$6={name:"IconDelete"},_hoisted_1$6={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$6=createBaseVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 010-64h256V95.936a32 32 0 0132-32h256a32 32 0 0132 32V192h256a32 32 0 110 64h-64v672a32 32 0 01-32 32H192a32 32 0 01-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 01-32-32V416a32 32 0 0164 0v320a32 32 0 01-32 32zm192 0a32 32 0 01-32-32V416a32 32 0 0164 0v320a32 32 0 01-32 32z"},null,-1),_hoisted_3$6=[_hoisted_2$6];function render$6(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$6,_hoisted_3$6)}script$6.render=render$6;var script$5={name:"IconView"},_hoisted_1$5={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$5=createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 110 448 224 224 0 010-448zm0 64a160.192 160.192 0 00-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),_hoisted_3$5=[_hoisted_2$5];function render$5(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$5,_hoisted_3$5)}script$5.render=render$5;var script$4={name:"IconFolderOpened"},_hoisted_1$4={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$4=createBaseVNode("path",{fill:"currentColor",d:"M878.08 448H241.92l-96 384h636.16l96-384zM832 384v-64H485.76L357.504 192H128v448l57.92-231.744A32 32 0 01216.96 384H832zm-24.96 512H96a32 32 0 01-32-32V160a32 32 0 0132-32h287.872l128.384 128H864a32 32 0 0132 32v96h23.04a32 32 0 0131.04 39.744l-112 448A32 32 0 01807.04 896z"},null,-1),_hoisted_3$4=[_hoisted_2$4];function render$4(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$4,_hoisted_3$4)}script$4.render=render$4;function _isSlot$1(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!isVNode(r)}var NAME$8="fcFrame",Frame=defineComponent({name:NAME$8,props:{type:{type:String,default:"input"},field:String,helper:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},src:{type:String,required:!0},icon:{type:String,default:"IconFolderOpened"},width:{type:String,default:"500px"},height:{type:String,default:"370px"},maxLength:{type:Number,default:0},okBtnText:{type:String,default:"确定"},closeBtnText:{type:String,default:"关闭"},modalTitle:String,handleIcon:{type:[String,Boolean],default:void 0},title:String,allowRemove:{type:Boolean,default:!0},onOpen:{type:Function,default:function(){}},onOk:{type:Function,default:function(){}},onCancel:{type:Function,default:function(){}},onLoad:{type:Function,default:function(){}},onBeforeRemove:{type:Function,default:function(){}},onRemove:{type:Function,default:function(){}},onHandle:Function,modal:{type:Object,default:function(){return{}}},srcKey:[String,Number],modelValue:[Array,String,Number,Object],previewMask:void 0,footer:{type:Boolean,default:!0},reload:{type:Boolean,default:!0},closeBtn:{type:Boolean,default:!0},okBtn:{type:Boolean,default:!0},formCreateInject:Object},emits:["update:modelValue","change"],components:{IconFolderOpened:script$4,IconView:script$5},data:function(){return{fileList:toArray(this.modelValue),previewVisible:!1,frameVisible:!1,previewImage:"",bus:new Mitt}},watch:{modelValue:function(t){this.fileList=toArray(t)}},methods:{close:function(){this.closeModel(!0)},closeModel:function(t){this.bus.$emit(t?"$close":"$ok"),this.reload&&(this.bus.$off("$ok"),this.bus.$off("$close")),this.frameVisible=!1},handleCancel:function(){this.previewVisible=!1},showModel:function(){this.disabled||this.onOpen()===!1||(this.frameVisible=!0)},input:function(){var t=this.fileList,e=this.maxLength===1?t[0]||"":t;this.$emit("update:modelValue",e),this.$emit("change",e)},makeInput:function(){var t=this;return createVNode(resolveComponent("ElInput"),mergeProps$1({type:"text",modelValue:this.fileList.map(function(e){return t.getSrc(e)}).toString(),readonly:!0},{key:1}),{append:function(){return createVNode(resolveComponent("ElButton"),{icon:resolveComponent(t.icon),onClick:function(){return t.showModel()}},null)},suffix:function(){return t.fileList.length?createVNode(resolveComponent("ElIcon"),{class:"el-input__icon _fc-upload-icon",onClick:function(){t.fileList=[],t.input()}},{default:function(){return[createVNode(script$8,null,null)]}}):null}})},makeGroup:function(t){return(!this.maxLength||this.fileList.length<this.maxLength)&&t.push(this.makeBtn()),createVNode("div",{key:2},[t])},makeItem:function(t,e){return createVNode("div",{class:"_fc-files",key:"3"+t},[e])},valid:function(t){var e=this.formCreateInject.field||this.field;if(e&&t!==e)throw new Error("[frame]无效的字段值")},makeIcons:function(t,e){if(this.handleIcon!==!1||this.allowRemove===!0){var n=[];return(this.type!=="file"&&this.handleIcon!==!1||this.type==="file"&&this.handleIcon)&&n.push(this.makeHandleIcon(t,e)),this.allowRemove&&n.push(this.makeRemoveIcon(t,e)),createVNode("div",{class:"_fc-upload-cover",key:4},[n])}},makeHandleIcon:function(t,e){var n=this,i=resolveComponent(this.handleIcon===!0||this.handleIcon===void 0?"icon-view":this.handleIcon);return createVNode(resolveComponent("ElIcon"),{onClick:function(){return n.handleClick(t)},key:"5"+e},{default:function(){return[createVNode(i,null,null)]}})},makeRemoveIcon:function(t,e){var n=this;return createVNode(resolveComponent("ElIcon"),{onClick:function(){return n.handleRemove(t)},key:"6"+e},{default:function(){return[createVNode(script$6,null,null)]}})},makeFiles:function(){var t=this;return this.makeGroup(this.fileList.map(function(e,n){return t.makeItem(n,[createVNode(resolveComponent("ElIcon"),{onClick:function(){return t.handleClick(e)}},{default:function(){return[createVNode(script$7,null,null)]}}),t.makeIcons(e,n)])}))},makeImages:function(){var t=this;return this.makeGroup(this.fileList.map(function(e,n){return t.makeItem(n,[createVNode("img",{src:t.getSrc(e)},null),t.makeIcons(e,n)])}))},makeBtn:function(){var t=this,e=resolveComponent(this.icon);return createVNode("div",{class:"_fc-upload-btn",onClick:function(){return t.showModel()},key:7},[createVNode(resolveComponent("ElIcon"),null,{default:function(){return[createVNode(e,null,null)]}})])},handleClick:function(t){if(this.onHandle)return this.onHandle(t);this.previewImage=this.getSrc(t),this.previewVisible=!0},handleRemove:function(t){this.disabled||this.onBeforeRemove(t)!==!1&&(this.fileList.splice(this.fileList.indexOf(t),1),this.input(),this.onRemove(t))},getSrc:function(t){return this.srcKey?t[this.srcKey]:t},frameLoad:function(t){var e=this;this.onLoad(t);try{this.helper===!0&&(t.form_create_helper={api:this.formCreateInject.api,close:function(i){e.valid(i),e.closeModel()},set:function(i,o){e.valid(i),!e.disabled&&e.$emit("update:modelValue",o)},get:function(i){return e.valid(i),e.modelValue},onOk:function(i){return e.bus.$on("$ok",i)},onClose:function(i){return e.bus.$on("$close",i)}})}catch(n){console.error(n)}},makeFooter:function(){var t=this,e=this.$props,n=e.okBtnText,i=e.closeBtnText,o=e.closeBtn,a=e.okBtn,u=e.footer;if(u)return createVNode("div",null,[o?createVNode(resolveComponent("ElButton"),{onClick:function(){return t.onCancel()!==!1&&(t.frameVisible=!1)}},_isSlot$1(i)?i:{default:function(){return[i]}}):null,a?createVNode(resolveComponent("ElButton"),{type:"primary",onClick:function(){return t.onOk()!==!1&&t.closeModel()}},_isSlot$1(n)?n:{default:function(){return[n]}}):null])}},render:function(){var t=this,e=this.type,n;e==="input"?n=this.makeInput():e==="image"?n=this.makeImages():n=this.makeFiles();var i=this.$props,o=i.width,a=o===void 0?"30%":o,u=i.height,s=i.src,l=i.title,c=i.modalTitle;return nextTick(function(){t.$refs.frame&&t.frameLoad(t.$refs.frame.contentWindow||{})}),createVNode("div",{class:"_fc-frame"},[n,createVNode(resolveComponent("ElDialog"),{appendToBody:!0,modal:this.previewMask,title:c,modelValue:this.previewVisible,onClose:this.handleCancel},{default:function(){return[createVNode("img",{style:"width: 100%",src:t.previewImage},null)]}}),createVNode(resolveComponent("ElDialog"),mergeProps$1({appendToBody:!0},_objectSpread2({width:a,title:l},this.modal),{modelValue:this.frameVisible,onClose:function(){return t.closeModel(!0)}}),{default:function(){return[t.frameVisible||!t.reload?createVNode("iframe",{ref:"frame",src:s,frameBorder:"0",style:{height:u,border:"0 none",width:"100%"}},null):null]},footer:function(){return t.makeFooter()}})])},beforeMount:function(){var t=this.formCreateInject,e=t.name,n=t.field,i=t.api;e&&i.on("fc:closeModal:"+e,this.close),n&&i.on("fc:closeModal:"+n,this.close)},beforeUnmount:function(){var t=this.formCreateInject,e=t.name,n=t.field,i=t.api;e&&i.off("fc:closeModal:"+e,this.close),n&&i.off("fc:closeModal:"+n,this.close)}}),NAME$7="fcRadio",Radio=defineComponent({name:NAME$7,inheritAttrs:!1,props:{formCreateInject:Object,modelValue:{type:[String,Number,Boolean],default:""},type:String},emits:["update:modelValue"],setup:function(t,e){var n=toRef(t.formCreateInject,"options",[]),i=toRef(t,"modelValue"),o=function(){return Array.isArray(n.value)?n.value:[]};return{options:o,value:i,onInput:function(u){e.emit("update:modelValue",u)}}},render:function(){var t,e,n=this,i=this.type==="button"?"ElRadioButton":"ElRadio",o=resolveComponent(i);return createVNode(resolveComponent("ElRadioGroup"),mergeProps$1(this.$attrs,{modelValue:this.value,"onUpdate:modelValue":this.onInput}),_objectSpread2({default:function(){return[n.options().map(function(u,s){var l=_objectSpread2({},u),c=l.value;return delete l.value,createVNode(o,mergeProps$1(l,{label:c,key:i+s+"-"+u.value}),{default:function(){return[l.label||l.value||""]}})}),(t=(e=n.$slots).default)===null||t===void 0?void 0:t.call(e)]}},getSlot(this.$slots,["default"])))}}),NAME$6="fcSelect",Select=defineComponent({name:NAME$6,inheritAttrs:!1,props:{formCreateInject:Object,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},type:String},emits:["update:modelValue"],setup:function(t){var e=toRef(t.formCreateInject,"options",[]),n=toRef(t,"modelValue"),i=function(){return Array.isArray(e.value)?e.value:[]};return{options:i,value:n}},render:function(){var t=this,e,n;return createVNode(resolveComponent("ElSelect"),mergeProps$1(this.$attrs,{modelValue:this.value,"onUpdate:modelValue":function(o){return t.$emit("update:modelValue",o)}}),_objectSpread2({default:function(){return[t.options().map(function(o,a){return createVNode(resolveComponent("ElOption"),mergeProps$1(o,{key:""+a+"-"+o.value}),null)}),(e=(n=t.$slots).default)===null||e===void 0?void 0:e.call(n)]}},getSlot(this.$slots,["default"])))}}),NAME$5="fcTree",Tree=defineComponent({name:NAME$5,inheritAttrs:!1,formCreateParser:{mergeProp:function(t){var e=t.prop.props;e.nodeKey||(e.nodeKey="id"),e.props||(e.props={label:"title"})}},props:{type:String,modelValue:{type:[Array,String,Number],default:function(){return[]}}},emits:["update:modelValue"],watch:{modelValue:function(){this.setValue()}},methods:{updateValue:function(){if(this.$refs.tree){var t;this.type==="selected"?t=this.$refs.tree.getCurrentKey():t=this.$refs.tree.getCheckedKeys(),this.$emit("update:modelValue",t)}},setValue:function(){if(this.$refs.tree){var t=this.type;t==="selected"?this.$refs.tree.setCurrentKey(this.modelValue):this.$refs.tree.setCheckedKeys(toArray(this.modelValue))}}},render:function(){return createVNode(resolveComponent("ElTree"),mergeProps$1(this.$attrs,{ref:"tree",onCheck:this.updateValue,"onNode-click":this.updateValue}),this.$slots)},mounted:function(){this.setValue()}}),css_248z$1="._fc-exceed .el-upload{display:none}";styleInject(css_248z$1);var script$3={name:"IconUpload"},_hoisted_1$3={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$3=createBaseVNode("path",{fill:"currentColor",d:"M160 832h704a32 32 0 110 64H160a32 32 0 110-64zm384-578.304V704h-64V247.296L237.248 490.048 192 444.8 508.8 128l316.8 316.8-45.312 45.248L544 253.696z"},null,-1),_hoisted_3$3=[_hoisted_2$3];function render$3(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$3,_hoisted_3$3)}script$3.render=render$3;function parseFile(r,t){return{url:r,name:getFileName(r),uid:t}}function getFileName(r){return(""+r).split("/").pop()}var NAME$4="fcUpload",Upload=defineComponent({name:NAME$4,inheritAttrs:!1,formCreateParser:{toFormValue:function(t){return toArray(t)},toValue:function(t,e){return e.prop.props.limit===1?t[0]||"":t}},props:{previewMask:void 0,onPreview:Function,modalTitle:String,modelValue:[Array,String]},emits:["update:modelValue","change","remove"],data:function(){return{previewVisible:!1,previewImage:"",fileList:[]}},created:function(){this.fileList=toArray(this.modelValue).map(parseFile)},watch:{modelValue:function(t){this.fileList=toArray(t).map(parseFile)}},methods:{handlePreview:function(t){this.onPreview?this.onPreview.apply(this,arguments):(this.previewImage=t.url,this.previewVisible=!0)},update:function(t){var e=t.map(function(n){return n.url}).filter(function(n){return n!==void 0});this.$emit("update:modelValue",e)},handleCancel:function(){this.previewVisible=!1},handleChange:function(t,e){this.$emit.apply(this,["change"].concat(Array.prototype.slice.call(arguments))),t.status==="success"&&this.update(e)},handleRemove:function(t,e){this.$emit.apply(this,["remove"].concat(Array.prototype.slice.call(arguments))),this.update(e)}},render:function(){var t,e,n=this,i=toArray(this.modelValue).length;return createVNode(Fragment,null,[createVNode(resolveComponent("ElUpload"),mergeProps$1({key:i,"list-type":"picture-card"},this.$attrs,{class:{"_fc-exceed":this.$attrs.limit?this.$attrs.limit<=i:!1},onPreview:this.handlePreview,onChange:this.handleChange,onRemove:this.handleRemove,fileList:this.fileList}),_objectSpread2({default:function(){return[((t=(e=n.$slots).default)===null||t===void 0?void 0:t.call(e))||createVNode(resolveComponent("ElIcon"),null,{default:function(){return[createVNode(script$3,null,null)]}})]}},getSlot(this.$slots,["default"]))),createVNode(resolveComponent("ElDialog"),{appendToBody:!0,modal:this.previewMask,title:this.modalTitle,modelValue:this.previewVisible,onClose:this.handleCancel},{default:function(){return[createVNode("img",{style:"width: 100%",src:n.previewImage},null)]}})])}}),is={type:function(t,e){return Object.prototype.toString.call(t)==="[object "+e+"]"},Undef:function(t){return t==null},Element:function(t){return _typeof(t)==="object"&&t!==null&&t.nodeType===1&&!is.Object(t)},trueArray:function(t){return Array.isArray(t)&&t.length>0},Function:function(t){var e=this.getType(t);return e==="Function"||e==="AsyncFunction"},getType:function(t){var e=Object.prototype.toString.call(t);return/^\[object (.*)\]$/.exec(e)[1]},empty:function(t){return t==null||Array.isArray(t)&&Array.isArray(t)&&!t.length?!0:typeof t=="string"&&!t}};["Date","Object","String","Boolean","Array","Number"].forEach(function(r){is[r]=function(t){return is.type(t,r)}});function hasProperty(r,t){return{}.hasOwnProperty.call(r,t)}var script$2={name:"IconCirclePlus"},_hoisted_1$2={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$2=createBaseVNode("path",{fill:"currentColor",d:"M352 480h320a32 32 0 110 64H352a32 32 0 010-64z"},null,-1),_hoisted_3$2=createBaseVNode("path",{fill:"currentColor",d:"M480 672V352a32 32 0 1164 0v320a32 32 0 01-64 0z"},null,-1),_hoisted_4$1=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 100-768 384 384 0 000 768zm0 64a448 448 0 110-896 448 448 0 010 896z"},null,-1),_hoisted_5=[_hoisted_2$2,_hoisted_3$2,_hoisted_4$1];function render$2(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$2,_hoisted_5)}script$2.render=render$2;var script$1={name:"IconRemove"},_hoisted_1$1={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$1=createBaseVNode("path",{fill:"currentColor",d:"M352 480h320a32 32 0 110 64H352a32 32 0 010-64z"},null,-1),_hoisted_3$1=createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 100-768 384 384 0 000 768zm0 64a448 448 0 110-896 448 448 0 010 896z"},null,-1),_hoisted_4=[_hoisted_2$1,_hoisted_3$1];function render$1(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$1,_hoisted_4)}script$1.render=render$1;function $set(r,t,e){r[t]=e}function $del(r,t){delete r[t]}function deepExtend(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0,n=!1;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=t[i];if((n=Array.isArray(o))||is.Object(o)){var a=r[i]===void 0;if(n)n=!1,a&&$set(r,i,[]);else if(o._clone&&e!==void 0)if(e)o=o.getRule(),a&&$set(r,i,{});else{$set(r,i,o._clone());continue}else a&&$set(r,i,{});r[i]=deepExtend(r[i],o,e)}else $set(r,i,o),is.Undef(o)||(is.Undef(o.__json)||(r[i].__json=o.__json),is.Undef(o.__origin)||(r[i].__origin=o.__origin))}return e!==void 0&&Array.isArray(r)?r.filter(function(u){return!u||!u.__ctrl}):r}function deepCopy(r){return deepExtend({},{value:r}).value}var _extends=Object.assign||function(r){for(var t,e=1;e<arguments.length;e++)for(var n in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,n)&&$set(r,n,t[n]);return r};function extend(){return _extends.apply(this,arguments)}function _isSlot(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!isVNode(r)}var NAME$3="fcGroup",Group=defineComponent({name:NAME$3,props:{field:String,rule:Array,expand:Number,options:Object,button:{type:Boolean,default:!0},max:{type:Number,default:0},min:{type:Number,default:0},modelValue:{type:Array,default:function(){return[]}},defaultValue:Object,disabled:{type:Boolean,default:!1},syncDisabled:{type:Boolean,default:!0},fontSize:{type:Number,default:28},onBeforeRemove:{type:Function,default:function(){}},onBeforeAdd:{type:Function,default:function(){}},formCreateInject:Object},data:function(){return{len:0,cacheRule:{},cacheValue:{},form:markRaw(this.formCreateInject.form.$form())}},emits:["update:modelValue","change","itemMounted","remove","add"],watch:{rule:{handler:function(t,e){var n=this;Object.keys(this.cacheRule).forEach(function(i){var o=n.cacheRule[i];if(o.$f){var a=o.$f.formData();if(t===e)o.$f.deferSyncValue(function(){deepExtend(o.rule,t),o.$f.setValue(a)},!0);else{var u=o.$f.formData();o.$f.once("reloading",function(){o.$f.setValue(u)}),o.rule=deepCopy(t)}}})},deep:!0},disabled:function(t){if(this.syncDisabled){var e=this.cacheRule;Object.keys(e).forEach(function(n){e[n].$f.disabled(t)})}},expand:function(t){var e=t-this.modelValue.length;e>0&&this.expandRule(e)},modelValue:{handler:function(t){var e=this;t=t||[];var n=Object.keys(this.cacheRule),i=n.length,o=i-t.length;if(o<0){for(var a=o;a<0;a++)this.addRule(t.length+a,!0);for(var u=0;u<i;u++)this.setValue(n[u],t[u])}else{if(o>0)for(var s=0;s<o;s++)this.removeRule(n[i-s-1]);t.forEach(function(l,c){e.setValue(n[c],t[c])})}},deep:!0}},methods:{_value:function(t){return t&&hasProperty(t,this.field)?t[this.field]:t},cache:function(t,e){this.cacheValue[t]=JSON.stringify(e)},input:function(t){this.$emit("update:modelValue",t),this.$emit("change",t)},formData:function(t,e){var n=this,i=this.cacheRule,o=Object.keys(i);if(o.filter(function(u){return i[u].$f}).length===o.length){var a=o.map(function(u){var s=t===u?e:_objectSpread2({},n.cacheRule[u].$f.form),l=n.field?s[n.field]||null:s;return n.cache(u,l),l});this.input(a)}},setValue:function(t,e){var n=this.field;n&&(e=_defineProperty({},n,this._value(e))),this.cacheValue[t]!==JSON.stringify(n?e[n]:e)&&this.cache(t,e)},addRule:function(t,e){var n=this,i=this.formCreateInject.form.copyRules(this.rule||[]),o=this.options?_objectSpread2({},this.options):{submitBtn:!1,resetBtn:!1};if(this.defaultValue){o.formData||(o.formData={});var a=deepCopy(this.defaultValue);extend(o.formData,this.field?_defineProperty({},this.field,a):a)}this.cacheRule[++this.len]={rule:i,options:o},e&&nextTick(function(){return n.$emit("add",i,Object.keys(n.cacheRule).length-1)})},add$f:function(t,e,n){var i=this;this.cacheRule[e].$f=n,this.formData(e,n.formData()),nextTick(function(){i.syncDisabled&&n.disabled(i.disabled),i.$emit("itemMounted",n,Object.keys(i.cacheRule).indexOf(e))})},removeRule:function(t,e){var n=this,i=Object.keys(this.cacheRule).indexOf(t);delete this.cacheRule[t],delete this.cacheValue[t],e&&nextTick(function(){return n.$emit("remove",i)})},add:function(){this.disabled||this.onBeforeAdd(this.modelValue)===!1||(this.modelValue.push(this.field?null:{}),this.$emit("update:modelValue",this.modelValue))},del:function(t,e){this.disabled||this.onBeforeRemove(this.modelValue,t)===!1||(this.removeRule(e,!0),this.modelValue.splice(t,1),this.input(this.modelValue))},addIcon:function(t){return createVNode(resolveComponent("ElIcon"),{key:"a".concat(t),style:"font-size:".concat(this.fontSize,"px;cursor:").concat(this.disabled?"not-allowed;color:#c9cdd4":"pointer",";"),onClick:this.add},{default:function(){return[createVNode(script$2,null,null)]}})},delIcon:function(t,e){var n=this;return createVNode(resolveComponent("ElIcon"),{key:"d".concat(e),class:"el-icon-remove-outline",style:"font-size:".concat(this.fontSize,"px;cursor:").concat(this.disabled?"not-allowed;color:#c9cdd4":"pointer;color:#606266",";"),onClick:function(){return n.del(t,e)}},{default:function(){return[createVNode(script$1,null,null)]}})},makeIcon:function(t,e,n){var i=this;if(this.$slots.button)return this.$slots.button({total:t,index:e,vm:this,key:n,del:function(){return i.del(e,n)},add:this.add});if(e===0)return[this.max!==0&&t>=this.max?null:this.addIcon(n),this.min===0||t>this.min?this.delIcon(e,n):null];if(t>this.min)return this.delIcon(e,n)},emitEvent:function(t,e,n,i){this.$emit.apply(this,[t].concat(_toConsumableArray(e),[this.cacheRule[i].$f,n]))},expandRule:function(t){for(var e=0;e<t;e++)this.modelValue.push(this.field?null:{})}},created:function(){for(var t=(this.expand||0)-this.modelValue.length,e=0;e<this.modelValue.length;e++)this.addRule(e);t>0&&this.expandRule(t)},render:function(){var t=this,e=Object.keys(this.cacheRule),n=this.button,i=this.form;return e.length===0?this.$slots.default?this.$slots.default({vm:this,add:this.add}):createVNode(resolveComponent("ElIcon"),{key:1,style:"font-size:".concat(this.fontSize,"px;vertical-align:middle;color:").concat(this.disabled?"#c9cdd4;cursor: not-allowed":"#606266;cursor:pointer",";"),onClick:this.add},{default:function(){return[createVNode(script$2,null,null)]}}):createVNode("div",{style:"width: 100%;",key:2},[e.map(function(o,a){var u,s=t.cacheRule[o],l=s.rule,c=s.options;return createVNode(resolveComponent("ElRow"),{align:"middle",key:o,style:"border-bottom:1px dashed #DCDFE6;margin-bottom:10px;"},{default:function(){return[createVNode(resolveComponent("ElCol"),{span:n?20:24},{default:function(){return[createVNode(i,{key:o,inFor:!0,"onUpdate:modelValue":function(g){return t.formData(o,g)},modelValue:t.field?_defineProperty({},t.field,t._value(t.modelValue[a])):t.modelValue[a],"onEmit-event":function(g){for(var y=arguments.length,$=new Array(y>1?y-1:0),S=1;S<y;S++)$[S-1]=arguments[S];return t.emitEvent(g,$,a,o)},"onUpdate:api":function(g){return t.add$f(a,o,g)},rule:l,option:c,extendOption:!0},null)]}}),n?createVNode(resolveComponent("ElCol"),{span:2,pull:1,push:1},_isSlot(u=t.makeIcon(e.length,a,o))?u:{default:function(){return[u]}}):null]}})})])}}),NAME$2="fcSubForm",Sub=defineComponent({name:NAME$2,props:{rule:Array,options:{type:Object,default:function(){return reactive({submitBtn:!1,resetBtn:!1})}},modelValue:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:!1},syncDisabled:{type:Boolean,default:!0},formCreateInject:Object},data:function(){return{cacheValue:{},subApi:{},form:markRaw(this.formCreateInject.form.$form())}},emits:["fc:subform","update:modelValue","change","itemMounted"],watch:{disabled:function(t){this.syncDisabled&&this.subApi.disabled(t)},modelValue:function(t){this.setValue(t)}},methods:{formData:function(t){this.cacheValue=JSON.stringify(t),this.$emit("update:modelValue",t),this.$emit("change",t)},setValue:function(t){var e=JSON.stringify(t);this.cacheValue!==e&&(this.cacheValue=e,this.subApi.coverValue(t||{}))},add$f:function(t){var e=this;this.subApi=t,nextTick(function(){e.syncDisabled&&t.disabled(e.disabled),e.$emit("itemMounted",t)})}},render:function(){var t=this.form;return createVNode(t,{"onUpdate:modelValue":this.formData,modelValue:this.modelValue,"onEmit-event":this.$emit,"onUpdate:api":this.add$f,rule:this.rule,option:this.options,extendOption:!0},null)}}),script={name:"IconWarning"},_hoisted_1$9={class:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},_hoisted_2$9=createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 110 896 448 448 0 010-896zm0 832a384 384 0 000-768 384 384 0 000 768zm48-176a48 48 0 11-96 0 48 48 0 0196 0zm-48-464a32 32 0 0132 32v288a32 32 0 01-64 0V288a32 32 0 0132-32z"},null,-1),_hoisted_3=[_hoisted_2$9];function render(r,t,e,n,i,o){return openBlock(),createElementBlock("svg",_hoisted_1$9,_hoisted_3)}script.render=render;var components=[Checkbox,Frame,Radio,Select,Tree,Upload,Group,Sub,script],NAME$1="FormCreate",getRuleInject=function r(t,e){if(!(!t||t===e)){if(t.props.formCreateInject)return t.props.formCreateInject;if(t.parent)return r(t.parent,e)}};function $FormCreate(r,t,e){return defineComponent({name:NAME$1,components:t,directives:e,props:{rule:{type:Array,required:!0,default:function(){return[]}},option:{type:Object,default:function(){return{}}},extendOption:Boolean,modelValue:Object,api:Object,name:String,subForm:{type:Boolean,default:!0},inFor:Boolean},emits:["update:api","update:modelValue","mounted","submit","change","emit-event","control","remove-rule","remove-field","sync","reload","repeat-field","update","validate-field-fail","validate-fail"],render:function(){return this.fc.render()},setup:function(i){var o=getCurrentInstance();provide("parentFC",o);var a=inject("parentFC",null),u=toRefs(i),s=u.rule,l=u.modelValue,c=u.subForm,f=u.inFor,d=reactive({ctxInject:{},destroyed:!1,isShow:!0,unique:1,renderRule:_toConsumableArray(s.value||[]),updateValue:JSON.stringify(l||{})}),p=new r(o),g=p.api(),y=f.value,$=function(){if(a){var w=getRuleInject(o,a);if(w){var F;y?(F=toArray(w.getSubForm()),F.push(g)):F=g,w.subForm(F)}}},S=function(){var w=getRuleInject(o,a);if(w)if(y){var F=toArray(w.getSubForm()),E=F.indexOf(g);E>-1&&F.splice(E,1)}else w.subForm()};return onMounted(function(){p.mounted()}),onBeforeUnmount(function(){S(),d.destroyed=!0,p.unmount()}),onUpdated(function(){p.updated()}),watch(c,function(b){b?$():S()},{immediate:!0}),watch(function(){return _toConsumableArray(s.value)},function(b){p.$handle.isBreakWatch()||b.length===d.renderRule.length&&b.every(function(w){return d.renderRule.indexOf(w)>-1})||(p.$handle.reloadRule(s.value),o.setupState.renderRule())}),watch(function(){return i.option},function(b){p.initOptions(b),g.refresh()},{deep:!0}),watch(l,function(b){JSON.stringify(b||{})!==d.updateValue&&(g.config.forceCoverValue?g.coverValue(b||{}):g.setValue(b||{}))},{deep:!0}),_objectSpread2(_objectSpread2({fc:markRaw(p),parent:a&&markRaw(a),fapi:markRaw(g)},toRefs(d)),{},{refresh:function(){++d.unique},renderRule:function(){d.renderRule=_toConsumableArray(s.value||[])},updateValue:function(w){d.destroyed||(d.updateValue=JSON.stringify(w),o.emit("update:modelValue",w))}})},created:function(){var i=getCurrentInstance();i.setupState.fc.init(),i.emit("update:api",i.setupState.fapi)}})}var normalMerge=["props"],toArrayMerge=["class","style","directives"],functionalMerge=["on"],mergeProps=function r(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=[].concat(normalMerge,_toConsumableArray(n.normal||[])),o=[].concat(toArrayMerge,_toConsumableArray(n.array||[])),a=[].concat(functionalMerge,_toConsumableArray(n.functional||[])),u=n.props||[];return t.reduce(function(s,l){for(var c in l)if(s[c])if(u.indexOf(c)>-1)s[c]=r([l[c]],s[c]);else if(i.indexOf(c)>-1)s[c]=_objectSpread2(_objectSpread2({},s[c]),l[c]);else if(o.indexOf(c)>-1){var f=s[c]instanceof Array?s[c]:[s[c]],d=l[c]instanceof Array?l[c]:[l[c]];s[c]=[].concat(_toConsumableArray(f),_toConsumableArray(d))}else if(a.indexOf(c)>-1)for(var p in l[c])if(s[c][p]){var g=s[c][p]instanceof Array?s[c][p]:[s[c][p]],y=l[c][p]instanceof Array?l[c][p]:[l[c][p]];s[c][p]=[].concat(_toConsumableArray(g),_toConsumableArray(y))}else s[c][p]=l[c][p];else if(c==="hook")for(var $ in l[c])s[c][$]?s[c][$]=mergeFn(s[c][$],l[c][$]):s[c][$]=l[c][$];else s[c]=l[c];else i.indexOf(c)>-1||a.indexOf(c)>-1||u.indexOf(c)>-1?s[c]=_objectSpread2({},l[c]):o.indexOf(c)>-1?s[c]=l[c]instanceof Array?_toConsumableArray(l[c]):_typeof(l[c])==="object"?_objectSpread2({},l[c]):l[c]:s[c]=l[c];return s},e)},mergeFn=function(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}},keyAttrs=["type","slot","emitPrefix","value","name","native","hidden","display","inject","options","emit","link","prefix","suffix","update","sync","optionsTo","key","slotUpdate","computed","preview","component","cache"],arrayAttrs=["validate","children","control"],normalAttrs=["effect"];function attrs(){return[].concat(keyAttrs,_toConsumableArray(normalMerge),_toConsumableArray(toArrayMerge),_toConsumableArray(functionalMerge),arrayAttrs,normalAttrs)}function format(r,t,e){return"[form-create ".concat(r,"]: ").concat(t)+(e?`

rule: `+JSON.stringify(e.getRule?e.getRule():e):"")}function err(r,t){console.error(format("err",r,t))}function logError(r){err(r.toString()),console.error(r)}function toLine(r){var t=r.replace(/([A-Z])/g,"-$1").toLocaleLowerCase();return t.indexOf("-")===0&&(t=t.substr(1)),t}function upper(r){return r.replace(r[0],r[0].toLocaleUpperCase())}var PREFIX="[[FORM-CREATE-PREFIX-",SUFFIX="-FORM-CREATE-SUFFIX]]",$T="$FN:",$TX="$FNX:",FUNCTION="function";function toJson(r,t){return JSON.stringify(deepExtend([],r,!0),function(e,n){if(!(n&&n._isVue===!0)){if(_typeof(n)!==FUNCTION)return n;if(n.__json)return n.__json;if(n.__origin&&(n=n.__origin),!n.__emit)return PREFIX+n+SUFFIX}},t)}function makeFn(fn){return eval("("+FUNCTION+"(){return "+fn+" })()")}function parseFn(r,t){if(r&&is.String(r)&&r.length>4){var e=r.trim(),n=!1;try{if(e.indexOf(SUFFIX)>0&&e.indexOf(PREFIX)===0)e=e.replace(SUFFIX,"").replace(PREFIX,""),n=!0;else if(e.indexOf($T)===0)e=e.replace($T,""),n=!0;else{if(e.indexOf($TX)===0)return e=makeFn("function($inject){"+e.replace($TX,"")+"}"),e.__json=r,e.__inject=!0,e;!t&&e.indexOf(FUNCTION)===0&&e!==FUNCTION&&(n=!0)}if(!n)return r;var i=makeFn(e.indexOf(FUNCTION)===-1&&e.indexOf("(")!==0?FUNCTION+" "+e:e);return i.__json=r,i}catch(o){err("解析失败:".concat(e,`

err: `).concat(o));return}}return r}function parseJson(r,t){return JSON.parse(r,function(e,n){return is.Undef(n)||!n.indexOf?n:parseFn(n,t)})}function enumerable(r,t){return{value:r,enumerable:!1,configurable:!1,writable:!!t}}function copyRule(r,t){return copyRules([r],t||!1)[0]}function copyRules(r,t){return deepExtend([],_toConsumableArray(r),t||!1)}function mergeRule(r,t){return mergeProps(Array.isArray(t)?t:[t],r,{array:arrayAttrs,normal:normalAttrs}),r}function getRule(r){var t=is.Function(r.getRule)?r.getRule():r;return t.type||(t.type="input"),t}function mergeGlobal(r,t){return r?(Object.keys(t||{}).forEach(function(e){t[e]&&(r[e]=mergeRule(r[e]||{},t[e]))}),r):t}function funcProxy(r,t){Object.defineProperties(r,Object.keys(t).reduce(function(e,n){return e[n]={get:function(){return t[n]()}},e},{}))}function byCtx(r){return r.__fc__||(r.__origin__?r.__origin__.__fc__:null)}function invoke(r,t){try{t=r()}catch(e){logError(e)}return t}function makeSlotBag(){var r={},t=function(n){return n||"default"};return{setSlot:function(n,i){n=t(n),!(!i||Array.isArray(i)&&i.length)&&(r[n]||(r[n]=[]),r[n].push(i))},getSlot:function(n,i){n=t(n);var o=[];return(r[n]||[]).forEach(function(a){if(Array.isArray(a))o.push.apply(o,_toConsumableArray(a));else if(is.Function(a)){var u=a.apply(void 0,_toConsumableArray(i||[]));Array.isArray(u)?o.push.apply(o,_toConsumableArray(u)):o.push(u)}else is.Undef(a)||o.push(a)}),o},getSlots:function(){var n=this,i={};return Object.keys(r).forEach(function(o){i[o]=function(){for(var a=arguments.length,u=new Array(a),s=0;s<a;s++)u[s]=arguments[s];return n.getSlot(o,u)}}),i},slotLen:function(n){return n=t(n),r[n]?r[n].length:0},mergeBag:function(n){var i=this;if(!n)return this;var o=is.Function(n.getSlots)?n.getSlots():n;return Array.isArray(n)||isVNode(n)?this.setSlot(void 0,function(){return n}):Object.keys(o).forEach(function(a){i.setSlot(a,o[a])}),this}}}function toProps(r){var t=_objectSpread2({},r.props||{});return Object.keys(r.on||{}).forEach(function(e){var n="on".concat(upper(e));Array.isArray(t[n])?t[n]=[].concat(_toConsumableArray(t[n]),[r.on[e]]):t[n]?t[n]=[t[n],r.on[e]]:t[n]=r.on[e]}),t.key=r.key,t.ref=r.ref,t.class=r.class,t.style=r.style,t.slot&&delete t.slot,t}function baseRule(){return{props:{},on:{},options:[],children:[],hidden:!1,display:!0,value:void 0}}function creatorFactory(r,t){return function(e,n,i){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=new Creator(r,e,n,i,o);return t&&(is.Function(t)?t(a):a.props(t)),a}}function Creator(r,t,e,n,i){this._data=extend(baseRule(),{type:r,title:t,field:e,value:n,props:i||{}}),this.event=this.on}extend(Creator.prototype,{getRule:function r(){return this._data},setProp:function r(t,e){return $set(this._data,t,e),this},modelField:function r(t){return this._data.modelField=t,this},_clone:function r(){var t=new this.constructor;return t._data=copyRule(this._data),t}});function appendProto(r){r.forEach(function(t){Creator.prototype[t]=function(e){return mergeRule(this._data,_defineProperty({},t,arguments.length<2?e:_defineProperty({},e,arguments[1]))),this}})}appendProto(attrs());var commonMaker=creatorFactory("");function create(r,t,e){var n=commonMaker("",t);return n._data.type=r,n._data.title=e,n}function makerFactory(){return{create,factory:creatorFactory}}function copy(r){return deepCopy(r)}function Api(r){function t(o){return is.Undef(o)?o=r.fields():Array.isArray(o)||(o=[o]),o}function e(o,a,u){t(o).forEach(function(s){r.getCtxs(s).forEach(function(l){$set(l.rule,a,u),r.$render.clearCache(l)})})}function n(){var o=r.subForm;return Object.keys(o).reduce(function(a,u){var s=o[u];return s&&(Array.isArray(s)?a.push.apply(a,_toConsumableArray(s)):a.push(s)),a},[])}var i={get config(){return r.options},set config(o){r.fc.options.value=o},get options(){return r.options},set options(o){r.fc.options.value=o},get form(){return r.form},get rule(){return r.rules},get parent(){return r.vm.parent&&r.vm.parent.setupState.fapi},get children(){return n()},formData:function(a){return t(a).reduce(function(u,s){var l=r.getFieldCtx(s);return l&&(u[l.field]=copy(l.rule.value)),u},{})},getValue:function(a){var u=r.getFieldCtx(a);if(u)return copy(u.rule.value)},coverValue:function(a){var u=_objectSpread2({},a||{});r.deferSyncValue(function(){i.fields().forEach(function(s){var l=r.fieldCtx[s];if(l){var c=hasProperty(a,s);l.forEach(function(f){f.rule.value=c?a[s]:void 0}),delete u[s]}}),extend(r.appendData,u)})},setValue:function(a){var u=a;arguments.length>=2&&(u=_defineProperty({},a,arguments[1])),r.deferSyncValue(function(){Object.keys(u).forEach(function(s){var l=r.fieldCtx[s];if(!l)return r.appendData[s]=u[s];l.forEach(function(c){c.rule.value=u[s]})})})},removeField:function(a){var u=r.getCtx(a);return r.deferSyncValue(function(){r.getCtxs(a).forEach(function(s){s.rm()})},!0),u?u.origin:void 0},removeRule:function(a){var u=a&&byCtx(a);if(u)return u.rm(),u.origin},fields:function(){return r.fields()},append:function(a,u,s){var l=r.sort.length-1,c,f=r.getCtx(u);if(f)if(s){if(c=f.getPending("children",f.rule.children),!Array.isArray(c))return;l=f.rule.children.length-1}else l=f.root.indexOf(f.origin),c=f.root;else c=r.rules;c.splice(l+1,0,a)},prepend:function(a,u,s){var l=0,c,f=r.getCtx(u);if(f)if(s){if(c=f.getPending("children",f.rule.children),!Array.isArray(c))return}else l=f.root.indexOf(f.origin),c=f.root;else c=r.rules;c.splice(l,0,a)},hidden:function(a,u){e(u,"hidden",!!a),r.refresh()},hiddenStatus:function(a){var u=r.getCtx(a);if(u)return!!u.rule.hidden},display:function(a,u){e(u,"display",!!a),r.refresh()},displayStatus:function(a){var u=r.getCtx(a);if(u)return!!u.rule.display},disabled:function(a,u){t(u).forEach(function(s){r.getCtxs(s).forEach(function(l){$set(l.rule.props,"disabled",!!a)})}),r.refresh()},all:function(a){return Object.keys(r.ctxs).map(function(u){var s=r.ctxs[u];return a?s.origin:s.rule})},model:function(a){return r.fields().reduce(function(u,s){var l=r.fieldCtx[s][0];return u[s]=a?l.origin:l.rule,u},{})},component:function(a){return Object.keys(r.nameCtx).reduce(function(u,s){var l=r.nameCtx[s].map(function(c){return a?c.origin:c.rule});return u[s]=l.length===1?l[0]:l,u},{})},bind:function(){return i.form},reload:function(a){r.reloadRule(a)},updateOptions:function(a){r.fc.updateOptions(a),i.refresh()},onSubmit:function(a){i.updateOptions({onSubmit:a})},sync:function(a){if(Array.isArray(a)){a.forEach(function(s){return i.sync(s)});return}var u=is.Object(a)?byCtx(a):r.getCtxs(a);u&&(u=Array.isArray(u)?u:[u],u.forEach(function(s){if(!s.deleted){var l=r.subForm[s.id];l&&(Array.isArray(l)?l.forEach(function(c){c.refresh()}):l&&l.refresh()),r.$render.clearCache(s)}}),r.refresh())},refresh:function(){n().forEach(function(a){a.refresh()}),r.$render.clearCacheAll(),r.refresh()},refreshOptions:function(){r.$manager.updateOptions(r.options),i.refresh()},hideForm:function(a){r.vm.setupState.isShow=!a},changeStatus:function(){return r.changeStatus},clearChangeStatus:function(){r.changeStatus=!1},updateRule:function(a,u){r.getCtxs(a).forEach(function(s){extend(s.rule,u)})},updateRules:function(a){Object.keys(a).forEach(function(u){i.updateRule(u,a[u])})},mergeRule:function(a,u){r.getCtxs(a).forEach(function(s){mergeRule(s.rule,u)})},mergeRules:function(a){Object.keys(a).forEach(function(u){i.mergeRule(u,a[u])})},getRule:function(a,u){var s=r.getCtx(a);if(s)return u?s.origin:s.rule},setEffect:function(a,u,s){var l=r.getCtx(a);l&&u&&(u[0]==="$"&&(u=u.substr(1)),hasProperty(l.rule,"$"+u)&&$set(l.rule,"$"+u,s),hasProperty(l.rule,"effect")||(l.rule.effect={}),$set(l.rule.effect,u,s))},clearEffectData:function(a,u){var s=r.getCtx(a);s&&(u&&u[0]==="$"&&(u=u.substr(1)),s.clearEffectData(u),i.sync(a))},updateValidate:function(a,u,s){s?i.mergeRule(a,{validate:u}):e(a,"validate",u)},updateValidates:function(a,u){Object.keys(a).forEach(function(s){i.updateValidate(s,a[s],u)})},refreshValidate:function(){i.refresh()},resetFields:function(a){t(a).forEach(function(u){r.getCtxs(u).forEach(function(s){r.$render.clearCache(s),s.rule.value=copy(s.defaultValue)})})},method:function(a,u){var s=i.el(a);if(!s||!s[u])throw new Error(format("err","".concat(u,"方法不存在")));return function(){return s[u].apply(s,arguments)}},exec:function(a,u){for(var s=arguments.length,l=new Array(s>2?s-2:0),c=2;c<s;c++)l[c-2]=arguments[c];return invoke(function(){return i.method(a,u).apply(void 0,l)})},toJson:function(a){return toJson(i.rule,a)},trigger:function(a,u){for(var s=i.el(a),l=arguments.length,c=new Array(l>2?l-2:0),f=2;f<l;f++)c[f-2]=arguments[f];s&&s.$emit.apply(s,[u].concat(c))},el:function(a){var u=r.getCtx(a);if(u)return u.el||r.vm.refs[u.ref]},closeModal:function(a){r.bus.$emit("fc:closeModal:"+a)},getSubForm:function(a){var u=r.getCtx(a);return u?r.subForm[u.id]:void 0},nextTick:function(a){r.bus.$once("next-tick",a),r.refresh()},nextRefresh:function(a){r.nextRefresh(),a&&invoke(a)},deferSyncValue:function(a,u){r.deferSyncValue(a,u)},emit:function(a){for(var u,s=arguments.length,l=new Array(s>1?s-1:0),c=1;c<s;c++)l[c-1]=arguments[c];(u=r.vm).emit.apply(u,[a].concat(l))},helper:{tidyFields:t,props:e}};return["on","once","off","set"].forEach(function(o){i[o]=function(){var a;(a=r.bus)["$".concat(o)].apply(a,arguments)}}),i.changeValue=i.changeField=i.setValue,i}function useCache(r){extend(r.prototype,{initCache:function(){this.clearCacheAll()},clearCache:function(e){e.rule.cache||this.cache[e.id]&&((this.cache[e.id].use===!0||this.cache[e.id].parent)&&this.$handle.refresh(),this.cache[e.id]=null)},clearCacheAll:function(){this.cache={}},setCache:function(e,n,i){this.cache[e.id]={vnode:n,use:!1,parent:i,slot:e.rule.slot}},getCache:function(e){var n=this.cache[e.id];if(n)return n.use=!0,n.vnode}})}function toCase(r){var t=r.replace(/(-[a-z])/g,function(e){return e.replace("-","").toLocaleUpperCase()});return lower(t)}function lower(r){return r.replace(r[0],r[0].toLowerCase())}function toString(r){return r==null?"":_typeof(r)==="object"?JSON.stringify(r,null,2):String(r)}var id$2=0;function uniqueId(){return"F"+Math.random().toString(36).substr(3,3)+Number("".concat(Date.now()).concat(++id$2)).toString(36)}function deepSet(r,t,e){var n=r,i;return(t||"").split(".").forEach(function(o){i&&((!n[i]||_typeof(n[i])!="object")&&(n[i]={}),n=n[i]),i=o}),n[i]=e,n}function useRender$1(r){extend(r.prototype,{initRender:function(){this.cacheConfig={}},getTypeSlot:function(e){var n=function i(o){if(o){var a=void 0;return e.rule.field&&(a=o.slots["field-"+toLine(e.rule.field)]||o.slots["field-"+e.rule.field]),a||(a=o.slots["type-"+toLine(e.type)]||o.slots["type-"+e.type]),a||i(o.setupState.parent)}};return n(this.vm)},render:function(){var e=this;if(this.vm.setupState.isShow){this.$manager.beforeRender();var n=makeSlotBag();return this.sort.forEach(function(i){e.renderSlot(n,e.$handle.ctxs[i])}),this.$manager.render(n)}},renderSlot:function(e,n,i){if(this.isFragment(n)){n.initProp(),this.mergeGlobal(n),n.initNone();var o=this.renderChildren(n.loadChildrenPending(),n),a=o.default;a&&e.setSlot(n.rule.slot,function(){return a()}),delete o.default,e.mergeBag(o)}else e.setSlot(n.rule.slot,this.renderCtx(n,i))},mergeGlobal:function(e){var n=this,i=this.$handle.options.global;i&&(this.cacheConfig[e.trueType]||(this.cacheConfig[e.trueType]=computed(function(){var o=n.$handle.options.global;return mergeRule({},[o["*"],o[e.originType]||o[e.type]||o[e.type]||{}])})),e.prop=mergeRule({},[this.cacheConfig[e.trueType].value,e.prop]))},setOptions:function(e){var n=e.loadPending({key:"options",origin:e.prop.options,def:[]});e.prop.options=n,e.prop.optionsTo&&n&&deepSet(e.prop,e.prop.optionsTo,n)},deepSet:function(e){var n=e.rule.deep;n&&Object.keys(n).sort(function(i,o){return i.length<o.length?-1:1}).forEach(function(i){deepSet(e.prop,i,n[i])})},parseSide:function(e,n){return is.Object(e)?mergeRule({props:{formCreateInject:n.prop.props.formCreateInject}},e):e},renderSides:function(e,n,i){var o=n[i?"rule":"prop"];return[this.renderRule(this.parseSide(o.prefix,n)),e,this.renderRule(this.parseSide(o.suffix,n))]},renderId:function(e,n){var i=this,o=this.$handle[n==="field"?"fieldCtx":"nameCtx"][e];return o?o.map(function(a){return i.renderCtx(a,a.parent)}):void 0},renderCtx:function(e,n){var i=this;try{if(e.type==="hidden")return;var o=e.rule;if(!this.cache[e.id]||this.cache[e.id].slot!==o.slot){var a;e.initProp(),this.mergeGlobal(e),e.initNone(),this.$manager.tidyRule(e),this.deepSet(e),this.setOptions(e),this.ctxProp(e);var u=e.prop;u.preview=!!(hasProperty(u,"preview")?u.preview:this.options.preview),u.props.formCreateInject=this.injectProp(e);var s=u.cache!==!1,l=u.preview;if(u.hidden){this.setCache(e,void 0,n);return}a=function(){for(var f=arguments.length,d=new Array(f),p=0;p<f;p++)d[p]=arguments[p];var g={rule:o,prop:u,preview:l,api:i.$handle.api,model:u.model||{},slotValue:d};d.length&&o.slotUpdate&&invoke(function(){return o.slotUpdate(g)});var y={},$=e.loadChildrenPending();e.parser.renderChildren?y=e.parser.renderChildren($,e):e.parser.loadChildren!==!1&&(y=i.renderChildren($,e));var S=i.getTypeSlot(e),b;return S?(g.children=y,b=S(g)):b=l?e.parser.preview(y,e):e.parser.render(y,e),b=i.renderSides(b,e),!(!e.input&&is.Undef(u.native))&&u.native!==!0&&(b=i.$manager.makeWrap(e,b)),e.none&&(b=i.display(b)),s&&i.setCache(e,function(){return b},n),b},this.setCache(e,a,n)}return function(){var c=i.getCache(e);if(c)return c.apply(void 0,arguments);if(i.cache[e.id])return;var f=i.renderCtx(e,e.parent);if(f)return f()}}catch(c){console.error(c);return}},getModelField:function(e){return e.rule.modelField||e.parser.modelField||this.fc.modelFields[this.vNode.aliasMap[e.type]]||this.fc.modelFields[e.type]||this.fc.modelFields[e.originType]||"modelValue"},display:function(e){var n=this;if(Array.isArray(e)){var i=[];return e.forEach(function(o){if(Array.isArray(o))return n.display(o);n.none(o)&&i.push(o)}),i}else return this.none(e)},none:function(e){if(e)return Array.isArray(e.props.style)?e.props.style.push({display:"none"}):e.props.style=[e.props.style,{display:"none"}],e},isFragment:function(e){return e.type==="fragment"||e.type==="template"},injectProp:function(e){var n=this,i=this.vm.setupState;i.ctxInject[e.id]||(i.ctxInject[e.id]={api:this.$handle.api,form:this.fc.create,subForm:function(u){n.$handle.addSubForm(e,u)},getSubForm:function(){return n.$handle.subForm[e.id]},options:[],children:[],preview:!1,field:e.field,rule:e.rule,input:e.input});var o=i.ctxInject[e.id];return extend(o,{preview:e.prop.preview,options:e.prop.options,children:e.loadChildrenPending()}),o},ctxProp:function(e,n){var i=this,o=e.ref,a=e.key,u=e.rule;this.$manager.mergeProp(e,n),e.parser.mergeProp(e,n);var s=[{ref:o,key:u.key||"".concat(a,"fc"),slot:void 0,on:{vnodeMounted:function(d){d.el.__rule__=e.rule,i.onMounted(e,d.el)}}}];if(!n&&e.input){var l=this.getModelField(e),c={callback:function(d){i.onInput(e,d)},value:this.$handle.getFormData(e)};s.push({on:_defineProperty({},"update:".concat(l),c.callback),props:_defineProperty({},l,c.value)}),e.prop.model=c}return mergeProps(s,e.prop),e.prop},onMounted:function(e,n){e.el=this.vm.refs[e.ref]||n,e.parser.mounted(e),this.$handle.effect(e,"mounted")},onInput:function(e,n){this.$handle.onInput(e,n)},renderChildren:function(e,n){var i=this;if(!is.trueArray(e))return{};var o=makeSlotBag();return e.map(function(a){if(a){if(is.String(a))return o.setSlot(null,a);if(a.__fc__)return i.renderSlot(o,a.__fc__,n);a.type&&nextTick(function(){i.$handle.loadChildren(e,n),i.$handle.refresh()})}}),o.getSlots()},defaultRender:function(e,n){var i=e.prop;return i.component?this.vNode.makeComponent(i.component,i,n):this.vNode[e.type]?this.vNode[e.type](i,n):this.vNode[e.originType]?this.vNode[e.originType](i,n):this.vNode.make(lower(e.originType),i,n)},renderRule:function(e,n,i){var o=this;if(e){if(is.String(e))return e;var a;if(i)a=e.type;else if(a=e.is,e.type){a=toCase(e.type);var u=this.vNode.aliasMap[a];u&&(a=toCase(u))}if(a){var s=makeSlotBag();is.trueArray(e.children)&&e.children.forEach(function(c){c&&s.setSlot(c==null?void 0:c.slot,function(){return o.renderRule(c)})});var l=_objectSpread2({},e);return delete l.type,delete l.is,this.vNode.make(a,l,s.mergeBag(n).getSlots())}}}})}var id$1=1;function Render(r){extend(this,{$handle:r,fc:r.fc,vm:r.vm,$manager:r.$manager,vNode:new r.fc.CreateNode(r.vm),id:id$1++}),funcProxy(this,{options:function(){return r.options},sort:function(){return r.sort}}),this.initCache(),this.initRender()}useCache(Render);useRender$1(Render);function useInject(r){extend(r.prototype,{parseInjectEvent:function(e,n){var i=e.inject||this.options.injectEvent;return this.parseEventLst(e,n,i)},parseEventLst:function(e,n,i,o){var a=this;return Object.keys(n).forEach(function(u){var s=a.parseEvent(e,n[u],i,o);s&&(n[u]=s)}),n},parseEvent:function(e,n,i,o){if(is.Function(n)&&(i!==!1&&!is.Undef(i)||n.__inject))return this.inject(e,n,i);if(!o&&Array.isArray(n)&&n[0]&&(is.String(n[0])||is.Function(n[0])))return this.parseEventLst(e,n,i,!0);if(is.String(n)){var a=parseFn(n);if(a&&n!==a)return a.__inject?this.parseEvent(e,a,i,!0):a}},parseEmit:function(e){var n=this,i={},o=e.rule,a=o.emitPrefix,u=o.field,s=o.name,l=o.inject,c=o.emit||[];if(is.trueArray(c)){var f=a||u||s;f&&c.forEach(function(d){if(d){var p;is.Object(d)&&(p=d.inject,d=d.name);var g=toLine("".concat(f,"-").concat(d)),y=function(){for(var b,w,F,E=arguments.length,V=new Array(E),O=0;O<E;O++)V[O]=arguments[O];(b=n.vm).emit.apply(b,[g].concat(V)),(w=n.vm).emit.apply(w,["emit-event",g].concat(V)),(F=n.bus).$emit.apply(F,[g].concat(V))};if(y.__emit=!0,!p&&l===!1)i[d]=y;else{var $=p||l||n.options.injectEvent;i[d]=is.Undef($)?y:n.inject(o,y,$)}}})}return e.computed.on=i,i},getInjectData:function(e,n){var i=this.vm,o=i.option,a=i.rule;return{$f:this.api,api:this.api,rule:a,self:e.__origin__,option:o,inject:n}},inject:function(e,n,i){if(n.__origin){if(this.watching&&!this.loading)return n;n=n.__origin}var o=this,a=function(){for(var s=o.getInjectData(e,i),l=arguments.length,c=new Array(l),f=0;f<l;f++)c[f]=arguments[f];return s.args=[].concat(c),c.unshift(s),n.apply(this,c)};return a.__origin=n,a.__json=n.__json,a}})}var EVENT=["hook:updated","hook:mounted"];function usePage(r){extend(r.prototype,{usePage:function(){var e=this,n=this.options.page;if(n){var i=25,o=getLimit(this.rules);is.Object(n)&&(n.first&&(i=parseInt(n.first,10)||i),n.limit&&(o=parseInt(n.limit,10)||o)),extend(this,{first:i,limit:o,pageEnd:this.rules.length<=i}),this.bus.$on("page-end",function(){return e.vm.emit("page-end",e.api)}),this.pageLoad()}},pageLoad:function(){var e=this,n=function i(){e.pageEnd?(e.bus.$off(EVENT,i),e.bus.$emit("page-end")):(e.first+=e.limit,e.pageEnd=e.rules.length<=e.first,e.loadRule(),e.refresh())};this.bus.$on(EVENT,n)}})}function getLimit(r){return r.length<31?31:Math.ceil(r.length/3)}function useRender(r){extend(r.prototype,{clearNextTick:function(){this.nextTick&&clearTimeout(this.nextTick),this.nextTick=null},bindNextTick:function(e){var n=this;this.clearNextTick(),this.nextTick=setTimeout(function(){e(),n.nextTick=null},10)},render:function(){return++this.loadedId,this.vm.setupState.unique>0?this.$render.render():(this.vm.setupState.unique=1,[])}})}function isNone(r){var t=!(is.Undef(r.prop.display)||r.prop.display);return r.parent&&r.parent.none||t}function bind(r){Object.defineProperties(r.origin,{__fc__:enumerable(markRaw(r),!0)})}function RuleContext(r,t,e){var n=uniqueId(),i=!!t.field;extend(this,{id:n,ref:n,wrapRef:n+"fi",rule:t,origin:t.__origin__||t,name:t.name,pending:{},none:!1,watch:[],linkOn:[],root:[],ctrlRule:[],parent:null,cacheConfig:null,prop:_objectSpread2({},t),computed:{},payload:{},refRule:{},input:i,el:void 0,defaultValue:i?deepCopy(e):void 0,field:t.field||void 0}),this.updateType(),this.updateKey(),bind(this),this.update(r,!0)}extend(RuleContext.prototype,{loadChildrenPending:function r(){var t=this,e=this.rule.children||[];return Array.isArray(e)?e:this.loadPending({key:"children",origin:e,def:[],onLoad:function(i){t.$handle&&t.$handle.loadChildren(i,t)},onUpdate:function(i,o){t.$handle&&(i===o?t.$handle.loadChildren(i,t):t.$handle.updateChildren(t,i,o))},onReload:function(i){t.$handle?t.$handle.updateChildren(t,[],i):delete t.pending.children}})},loadPending:function r(t){var e=this,n=t.key,i=t.origin,o=t.def,a=t.onLoad,u=t.onReload,s=t.onUpdate;if(this.pending[n]&&this.pending[n].origin===i)return this.getPending(n,o);delete this.pending[n];var l=i;if(is.Function(i)){var c=invoke(function(){return i({rule:e.rule,api:e.$api,update:function(d){var p=d||o,g=e.getPending(n,o);e.setPending(n,i,p),s&&s(p,g)},reload:function(){var d=e.getPending(n,o);delete e.pending[n],u&&u(d),e.$api&&e.$api.sync(e.rule)}})});c&&is.Function(c.then)?(c.then(function(f){var d=f||o;e.setPending(n,i,d),a&&a(d),e.$api&&e.$api.sync(e.rule)}),l=o,this.setPending(n,i,l)):(l=c||o,this.setPending(n,i,l),a&&a(l))}return l},getPending:function r(t,e){return this.pending[t]&&this.pending[t].value||e},setPending:function r(t,e,n){this.pending[t]={origin:e,value:reactive(n)}},effectData:function r(t){return this.payload[t]||(this.payload[t]={}),this.payload[t]},clearEffectData:function r(t){t===void 0?this.payload={}:delete this.payload[t]},updateKey:function r(t){this.key=uniqueId(),t&&this.parent&&this.parent.updateKey(t)},updateType:function r(){this.originType=this.rule.type,this.type=toCase(this.rule.type)},setParser:function r(t){this.parser=t,t.init(this)},initProp:function r(){var t=this,e=_objectSpread2({},this.rule);delete e.children,this.prop=mergeRule({},[e].concat(_toConsumableArray(Object.keys(this.payload).map(function(n){return t.payload[n]})),[this.computed]))},initNone:function r(){this.none=isNone(this)},check:function r(t){return this.vm===t.vm},unwatch:function r(){this.watch.forEach(function(t){return t()}),this.watch=[],this.refRule={}},unlink:function r(){this.linkOn.forEach(function(t){return t()}),this.linkOn=[]},link:function r(){this.unlink(),this.$handle.appendLink(this)},watchTo:function r(){this.$handle.watchCtx(this)},delete:function r(){var t=void 0;this.unwatch(),this.unlink(),this.rmCtrl(),extend(this,{deleted:!0,prop:_objectSpread2({},this.rule),computed:{},el:t,$handle:t,$render:t,$api:t,vm:t,vNode:t,parent:null,cacheConfig:null,none:!1})},rmCtrl:function r(){this.ctrlRule.forEach(function(t){return t.__fc__&&t.__fc__.rm()}),this.ctrlRule=[]},rm:function r(){var t=this,e=function(){var i=t.root.indexOf(t.origin);i>-1&&(t.root.splice(i,1),t.$handle&&t.$handle.refresh())};if(this.deleted){e();return}this.$handle.noWatch(function(){t.$handle.deferSyncValue(function(){t.rmCtrl(),e(),t.$handle.rmCtx(t),extend(t,{root:[]})},t.input)})},update:function r(t,e){extend(this,{deleted:!1,$handle:t,$render:t.$render,$api:t.api,vm:t.vm,trueType:t.getType(this.originType),vNode:t.$render.vNode,updated:!1}),!e&&this.unwatch(),this.watchTo(),this.link()}});var condition={"==":function r(t){return function(e){return e===t}},"!=":function r(t){return function(e){return e!==t}},"<>":function r(t){return function(e){return e!==t}},">":function r(t){return function(e){return e>t}},">=":function r(t){return function(e){return e>=t}},"<":function r(t){return function(e){return e<t}},"<=":function r(t){return function(e){return e<=t}},in:function r(t){return function(e){return t&&t.indexOf&&t.indexOf(e)>-1}},on:function r(t){return function(e){return e&&e.indexOf&&e.indexOf(t)>-1}},notIn:function r(t){return function(e){return!condition.in(t)(e)}},notOn:function r(t){return function(e){return!condition.on(t)(e)}},between:function r(t){return function(e){return e>t[0]&&e<t[1]}},notBetween:function r(t){return function(e){return e<t[0]||e>t[1]}}};function useLoader(r){extend(r.prototype,{nextRefresh:function(e){var n=this,i=this.loadedId;nextTick(function(){i===n.loadedId&&(e?e():n.refresh())})},parseRule:function(e){var n=this,i=getRule(e);return Object.defineProperties(i,{__origin__:enumerable(e,!0)}),fullRule(i),this.appendValue(i),[i,i.prefix,i.suffix].forEach(function(o){o&&n.loadFn(o,i)}),this.loadCtrl(i),i.update&&(i.update=parseFn(i.update)),i},loadFn:function(e,n){var i=this;["on","props","deep"].forEach(function(o){e[o]&&i.parseInjectEvent(n,e[o])})},loadCtrl:function(e){e.control&&e.control.forEach(function(n){n.handle&&(n.handle=parseFn(n.handle))})},syncProp:function(e){var n=this,i=e.rule;is.trueArray(i.sync)&&mergeProps([{on:i.sync.reduce(function(o,a){return o["update:".concat(a)]=function(u){i.props[a]=u,n.vm.emit("sync",a,u,i,n.fapi)},o},{})}],e.computed)},loadRule:function(){var e=this;this.cycleLoad=!1,this.loading=!0,this.pageEnd&&this.bus.$emit("load-start"),this.deferSyncValue(function(){if(e._loadRule(e.rules),e.loading=!1,e.cycleLoad&&e.pageEnd)return e.loadRule();e.syncForm(),e.pageEnd&&e.bus.$emit("load-end"),e.vm.setupState.renderRule()})},loadChildren:function(e,n){if(this.cycleLoad=!1,this.loading=!0,this.bus.$emit("load-start"),this._loadRule(e,n),this.loading=!1,this.cycleLoad)return this.loadRule();this.syncForm(),this.bus.$emit("load-end"),this.$render.clearCache(n)},_loadRule:function(e,n){var i=this,o=function u(s){var l=e[s-1];if(!l||!l.__fc__)return s>0?u(s-1):-1;var c=i.sort.indexOf(l.__fc__.id);return c>-1?c:u(s-1)},a=function(s,l){is.trueArray(s)&&i._loadRule(s,l)};e.map(function(u,s){if(!(n&&!is.Object(u))&&!(!i.pageEnd&&!n&&s>=i.first)){if(u.__fc__&&u.__fc__.root===e&&i.ctxs[u.__fc__.id])return a(u.__fc__.loadChildrenPending(),u.__fc__),u.__fc__;var l=getRule(u),c=function(){return!!(l.field&&i.fieldCtx[l.field]&&i.fieldCtx[l.field][0]!==u.__fc__)};i.ruleEffect(l,"init",{repeat:c()}),c()&&i.vm.emit("repeat-field",u,i.api);var f,d=!1,p=!!u.__fc__,g=l.value;if(p){f=u.__fc__,g=f.defaultValue;var y=!f.check(i);if(f.deleted){if(y){if(isCtrl(f))return;f.update(i)}}else if(y){if(isCtrl(f))return;e[s]=u=u._clone?u._clone():copyRule(u),f=null,d=!0}}if(f)f.originType!==f.rule.type&&(f.updateType(),i.bindParser(f)),i.appendValue(f.rule);else{var $=i.parseRule(u);f=new RuleContext(i,$,p?g:$.value),i.bindParser(f)}i.parseEmit(f),i.syncProp(f),f.parent=n||null,f.root=e,i.setCtx(f),!d&&!p&&i.effect(f,"load");var S=f.loadChildrenPending();if(f.parser.loadChildren===!1||a(S,f),!n){var b=o(s);b>-1||!s?i.sort.splice(b+1,0,f.id):i.sort.push(f.id)}var w=f.rule;return f.updated||(f.updated=!0,is.Function(w.update)&&i.bus.$once("load-end",function(){i.refreshUpdate(f,w.value,"init")}),i.effect(f,"loaded")),i.refreshControl(f)&&(i.cycleLoad=!0),f}})},refreshControl:function(e){return e.input&&e.rule.control&&this.useCtrl(e)},useCtrl:function(e){var n=this,i=getCtrl(e),o=[],a=this.api;if(!i.length)return!1;for(var u=function(p){var g=i[p],y=g.handle||(condition[g.condition||"=="]||condition["=="])(g.value);if(!is.trueArray(g.rule))return"continue";var $=_objectSpread2(_objectSpread2({},g),{},{valid:invoke(function(){return y(e.rule.value,a)}),ctrl:findCtrl(e,g.rule),isHidden:is.String(g.rule[0])});if($.valid&&$.ctrl||!$.valid&&!$.ctrl&&!$.isHidden)return"continue";o.push($)},s=0;s<i.length;s++)var l=u(s);if(!o.length)return!1;var c=[],f=!1;return this.deferSyncValue(function(){o.reverse().forEach(function(d){var p=d.isHidden,g=d.valid,y=d.rule,$=d.prepend,S=d.append,b=d.child,w=d.ctrl,F=d.method;if(p){g?e.ctrlRule.push({__ctrl:!0,children:y,valid:g}):e.ctrlRule.splice(e.ctrlRule.indexOf(w),1),c[g?"push":"unshift"](function(){F==="disabled"?n.api.disabled(!g,y):F==="display"?n.api.display(g,y):F==="required"?(y.forEach(function(O){n.api.setEffect(O,"required",g)}),g||n.api.clearValidateState(y)):n.api.hidden(!g,y)});return}if(g){f=!0;var E={type:"fragment",native:!0,__ctrl:!0,children:y};e.ctrlRule.push(E),n.bus.$once("load-start",function(){$?a.prepend(E,$,b):S||b?a.append(E,S||e.id,b):e.root.splice(e.root.indexOf(e.origin)+1,0,E)})}else{e.ctrlRule.splice(e.ctrlRule.indexOf(w),1);var V=byCtx(w);V&&V.rm()}})}),c.length&&nextTick(function(){c.forEach(function(d){return d()})}),this.vm.emit("control",e.origin,this.api),this.effect(e,"control"),f},reloadRule:function(e){return this._reloadRule(e)},_reloadRule:function(e){var n=this;e||(e=this.rules);var i=_objectSpread2({},this.ctxs);this.clearNextTick(),this.initData(e),this.fc.rules=e,this.deferSyncValue(function(){n.bus.$once("load-end",function(){Object.keys(i).filter(function(o){return n.ctxs[o]===void 0}).forEach(function(o){return n.rmCtx(i[o])}),n.$render.clearCacheAll()}),n.reloading=!0,n.loadRule(),n.reloading=!1,n.refresh(),n.bus.$emit("reloading",n.api)}),this.bus.$off("next-tick",this.nextReload),this.bus.$once("next-tick",this.nextReload),this.bus.$emit("update",this.api)},refresh:function(){this.vm.setupState.refresh()}})}function fullRule(r){var t=baseRule();return Object.keys(t).forEach(function(e){hasProperty(r,e)||(r[e]=t[e])}),r}function getCtrl(r){var t=r.rule.control||[];return is.Object(t)?[t]:t}function findCtrl(r,t){for(var e=0;e<r.ctrlRule.length;e++){var n=r.ctrlRule[e];if(n.children===t)return n}}function isCtrl(r){return!!r.rule.__ctrl}function useInput(r){extend(r.prototype,{setValue:function(e,n,i,o){e.deleted||(e.rule.value=n,this.changeStatus=!0,this.nextRefresh(),this.$render.clearCache(e),this.setFormData(e,i),this.syncValue(),this.valueChange(e,n),this.vm.emit("change",e.field,n,e.origin,this.api,o||!1),this.effect(e,"value"))},onInput:function(e,n){var i;e.input&&(this.isQuote(e,i=e.parser.toValue(n,e))||this.isChange(e,n))&&this.setValue(e,i,n)},setFormData:function(e,n){$set(this.formData,e.id,n)},getFormData:function(e){return this.formData[e.id]},syncForm:function(){var e=this,n=reactive({});this.fields().reduce(function(i,o){var a=e.getCtx(o);return i[o]=toRef(a.rule,"value"),i},n),this.form=n,this.syncValue()},appendValue:function(e){!e.field||!hasProperty(this.appendData,e.field)||(e.value=this.appendData[e.field],delete this.appendData[e.field])},addSubForm:function(e,n){this.subForm[e.id]=n},deferSyncValue:function(e,n){this.deferSyncFn||(this.deferSyncFn=e),this.deferSyncFn.sync||(this.deferSyncFn.sync=n),invoke(e),this.deferSyncFn===e&&(this.deferSyncFn=null,e.sync&&this.syncValue())},syncValue:function(){if(this.deferSyncFn)return this.deferSyncFn.sync=!0;this.vm.setupState.updateValue(_objectSpread2({},this.form))},isChange:function(e,n){return JSON.stringify(this.getFormData(e),strFn)!==JSON.stringify(n,strFn)},isQuote:function(e,n){return(is.Object(n)||Array.isArray(n))&&n===e.rule.value},refreshUpdate:function(e,n,i){var o=this;if(is.Function(e.rule.update)){var a=invoke(function(){return e.rule.update(n,e.origin,o.api,{origin:i||"change"})});if(a===void 0)return;e.rule.hidden=a===!0}},valueChange:function(e,n){this.refreshRule(e,n),this.bus.$emit("change-"+e.field,n)},refreshRule:function(e,n,i){this.refreshControl(e)&&(this.$render.clearCacheAll(),this.loadRule(),this.bus.$emit("update",this.api),this.refresh()),this.refreshUpdate(e,n,i)},appendLink:function(e){var n=this,i=e.rule.link;is.trueArray(i)&&i.forEach(function(o){var a=function(){return n.refreshRule(e,e.rule.value,"link")};n.bus.$on("change-"+o,a),e.linkOn.push(function(){return n.bus.$off("change-"+o,a)})})},fields:function(){return Object.keys(this.fieldCtx)}})}function strFn(r,t){return typeof t=="function"?""+t:t}var BaseParser={init:function r(t){},toFormValue:function r(t,e){return t},toValue:function r(t,e){return t},mounted:function r(t){},render:function r(t,e){return e.$render.defaultRender(e,t)},preview:function r(t,e){return this.render(t,e)},mergeProp:function r(t){}},_={sum:function r(t){if(Array.isArray(t)){var e=0;return t.map(function(n){return e+=n||0}),e}},column:function r(t,e){return Array.isArray(t)?t.map(function(n){return n[e]}):[]},get:function r(t,e,n){for(var i=e.split("."),o=t,a=0;a<i.length;a++)if(hasProperty(o,i[a]))o=o[i[a]];else return n===void 0?0:n;return o}},noneKey=["field","value","vm","template","name","config","control","inject","sync","payload","optionsTo","update","slotUpdate","computed","component","cache"];function useContext(r){extend(r.prototype,{getCtx:function(e){return this.getFieldCtx(e)||this.getNameCtx(e)[0]||this.ctxs[e]},getCtxs:function(e){return this.fieldCtx[e]||this.nameCtx[e]||(this.ctxs[e]?[this.ctxs[e]]:[])},setIdCtx:function(e,n,i){var o="".concat(i,"Ctx");this[o][n]?this[o][n].push(e):this[o][n]=[e]},rmIdCtx:function(e,n,i){var o="".concat(i,"Ctx"),a=this[o][n];if(!a)return!1;var u=a.splice(a.indexOf(e)>>>0,1).length>0;return a.length||delete this[o][n],u},getFieldCtx:function(e){return(this.fieldCtx[e]||[])[0]},getNameCtx:function(e){return this.nameCtx[e]||[]},setCtx:function(e){var n=e.id,i=e.field,o=e.name,a=e.rule;this.ctxs[n]=e,o&&this.setIdCtx(e,o,"name"),e.input&&(this.setIdCtx(e,i,"field"),this.setFormData(e,e.parser.toFormValue(a.value,e)),this.isMounted&&!this.reloading&&this.vm.emit("change",e.field,a.value,e.origin,this.api))},getParser:function(e){var n=this.fc.parsers;return n[e.originType]||n[toCase(e.type)]||n[e.trueType]||BaseParser},bindParser:function(e){e.setParser(this.getParser(e))},getType:function(e){var n=this.fc.CreateNode.aliasMap,i=n[e]||n[toCase(e)]||e;return toCase(i)},noWatch:function(e){this.noWatchFn||(this.noWatchFn=e),invoke(e),this.noWatchFn===e&&(this.noWatchFn=null)},watchCtx:function(e){var n=this,i=attrs();if(i.filter(function(a){return a[0]!=="_"&&a[0]!=="$"&&noneKey.indexOf(a)===-1}).forEach(function(a){var u=toRef(e.rule,a),s=a==="children";e.refRule[a]=u,e.watch.push(watch(s?function(){return is.Function(u.value)?u.value:_toConsumableArray(u.value||[])}:function(){return u.value},function(l,c){var f=u.value;if(!n.isBreakWatch()){if(s&&e.parser.loadChildren===!1){n.$render.clearCache(e),n.nextRefresh();return}if(n.watching=!0,a==="link"){e.link();return}else["props","on","deep"].indexOf(a)>-1?(n.parseInjectEvent(e.rule,f||{}),a==="props"&&e.input&&n.setFormData(e,e.parser.toFormValue(e.rule.value,e))):a==="emit"?n.parseEmit(e):["prefix","suffix"].indexOf(a)>-1?f&&n.loadFn(f,e.rule):a==="type"?(e.updateType(),n.bindParser(e)):s&&(is.Function(c)&&(c=e.getPending("children",[])),is.Function(f)&&(f=e.loadChildrenPending()),n.updateChildren(e,f,c));n.$render.clearCache(e),n.refresh(),n.watching=!1}},{deep:!s,sync:s}))}),e.input){var o=toRef(e.rule,"value");e.watch.push(watch(function(){return o.value},function(){var a=e.parser.toFormValue(o.value,e);n.isChange(e,a)&&n.setValue(e,o.value,a,!0)})),this.bus.$once("load-end",function(){var a=toRef(e.rule,"computed");e.watch.push(watch(function(){var u=a.value;if(u){var s;return is.Function(u)?s=function(){return u(n.api.form,n.api)}:s=function(){return new Function("_","with(this){ return ".concat(u," }")).call(n.api.form,_)},invoke(s,void 0)}},function(u){o.value=u},{immediate:!!a.value}))})}this.watchEffect(e)},updateChildren:function(e,n,i){var o=this;this.deferSyncValue(function(){i&&i.forEach(function(a){(n||[]).indexOf(a)===-1&&a&&!is.String(a)&&a.__fc__&&a.__fc__.parent===e&&o.rmCtx(a.__fc__)}),is.trueArray(n)&&(o.loadChildren(n,e),o.bus.$emit("update",o.api))})},rmSub:function(e){var n=this;is.trueArray(e)&&e.forEach(function(i){i&&i.__fc__&&n.rmCtx(i.__fc__)})},rmCtx:function(e){var n=this;if(!e.deleted){var i=e.id,o=e.field,a=e.input,u=e.name;$del(this.ctxs,i),$del(this.formData,i),$del(this.subForm,i),$del(this.vm.setupState.ctxInject,i),a&&this.rmIdCtx(e,o,"field"),u&&this.rmIdCtx(e,u,"name"),a&&!hasProperty(this.fieldCtx,o)&&$del(this.form,o),this.deferSyncValue(function(){if(!n.reloading){if(e.parser.loadChildren!==!1){var l=e.getPending("children",e.rule.children);is.trueArray(l)&&l.forEach(function(c){return c.__fc__&&n.rmCtx(c.__fc__)})}e.root===n.rules&&n.vm.setupState.renderRule()}},a);var s=this.sort.indexOf(i);return s>-1&&this.sort.splice(s,1),this.$render.clearCache(e),e.delete(),this.effect(e,"deleted"),a&&!this.fieldCtx[o]&&this.vm.emit("remove-field",o,e.rule,this.api),e.rule.__ctrl||this.vm.emit("remove-rule",e.rule,this.api),e}}})}function useLifecycle(r){extend(r.prototype,{mounted:function(){var e=this,n=function(){e.isMounted=!0,e.lifecycle("mounted")};this.pageEnd?n():this.bus.$once("page-end",n)},lifecycle:function(e){var n=this,i=this.options[e];is.Function(i)&&invoke(function(){return i(n.api)}),this.vm.emit(e,this.api)}})}function useEffect(r){extend(r.prototype,{useProvider:function(){var e=this,n=this.fc.providers;Object.keys(n).forEach(function(i){var o=n[i];is.Function(o)&&(o=o(e.fc)),o._c=getComponent(o),e.onEffect(o),e.providers[i]=o})},onEffect:function(e){var n=this,i=[];(e._c||["*"]).forEach(function(o){var a=o==="*"?"*":n.getType(o);i.indexOf(a)>-1||(i.push(a),n.bus.$on("p:".concat(e.name,":").concat(a,":").concat(e.input?1:0),function(u,s){e[u]&&e[u].apply(e,_toConsumableArray(s))}))}),e._used=i},watchEffect:function(e){var n=this,i={required:function(){var a,u;return(hasProperty(e.rule,"$required")?e.rule.$required:(a=e.rule)===null||a===void 0||(u=a.effect)===null||u===void 0?void 0:u.required)||!1}};Object.keys(e.rule.effect||{}).forEach(function(o){i[o]=function(){return e.rule.effect[o]}}),Object.keys(e.rule).forEach(function(o){o[0]==="$"&&(i[o.substr(1)]=function(){return e.rule[o]})}),Object.keys(i).forEach(function(o){e.watch.push(watch(i[o],function(a){n.effect(e,"watch",_defineProperty({},o,a))},{deep:!0}))})},ruleEffect:function(e,n,i){this.emitEffect({rule:e,input:!!e.field,type:this.getType(e.type)},n,i)},effect:function(e,n,i){this.emitEffect({rule:e.rule,input:e.input,type:e.trueType,ctx:e,custom:i},n)},getEffect:function(e,n){if(hasProperty(e,"$"+n))return e["$"+n];if(hasProperty(e,"effect")&&hasProperty(e.effect,n))return e.effect[n]},emitEffect:function(e,n,i){var o=this,a=e.ctx,u=e.rule,s=e.input,l=e.type,c=e.custom;if(!(!l||["fcFragment","fragment"].indexOf(l)>-1)){var f=c||Object.keys(u).reduce(function(d,p){return p[0]==="$"&&(d[p.substr(1)]=u[p]),d},_objectSpread2({},u.effect||{}));Object.keys(f).forEach(function(d){var p=o.providers[d];if(!(!p||p.input&&!s)){var g;if(!p._c)g="*";else if(p._used.indexOf(l)>-1)g=l;else return;var y=_objectSpread2({value:f[d],getValue:function(){return o.getEffect(u,d)}},i||{});a&&(y.getProp=function(){return a.effectData(d)},y.clearProp=function(){return a.clearEffectData(d)},y.mergeProp=function($){return mergeRule(y.getProp(),[$])}),o.bus.$emit("p:".concat(d,":").concat(g,":").concat(p.input?1:0),n,[y,u,o.api])}})}}})}function unique(r){return r.filter(function(t,e,n){return n.indexOf(t,0)===e})}function getComponent(r){var t=r.components;return Array.isArray(t)?unique(t.filter(function(e){return e!=="*"})):is.String(t)?[t]:!1}function Handler(r){var t=this;funcProxy(this,{options:function(){return r.options.value||{}},bus:function(){return r.bus}}),extend(this,{fc:r,vm:r.vm,watching:!1,loading:!1,reloading:!1,noWatchFn:null,deferSyncFn:null,isMounted:!1,formData:reactive({}),subForm:{},form:reactive({}),appendData:{},providers:{},cycleLoad:null,loadedId:1,nextTick:null,changeStatus:!1,pageEnd:!0,nextReload:function(){t.lifecycle("reload")}}),this.initData(r.rules),this.$manager=new r.manager(this),this.$render=new Render(this),this.api=r.extendApi(Api(this),this)}extend(Handler.prototype,{initData:function r(t){extend(this,{ctxs:{},fieldCtx:{},nameCtx:{},sort:[],rules:t})},init:function r(){this.appendData=_objectSpread2(_objectSpread2(_objectSpread2({},this.options.formData||{}),this.fc.vm.props.modelValue||{}),this.appendData),this.useProvider(),this.usePage(),this.loadRule(),this.$manager.__init()},isBreakWatch:function r(){return this.loading||this.noWatchFn||this.reloading}});useInject(Handler);usePage(Handler);useRender(Handler);useLoader(Handler);useInput(Handler);useContext(Handler);useLifecycle(Handler);useEffect(Handler);function getError(r,t,e){var n="fail to ".concat(r," ").concat(e.status,"'"),i=new Error(n);return i.status=e.status,i.url=r,i}function getBody(r){var t=r.responseText||r.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}function fetch$1(r){if(!(typeof XMLHttpRequest>"u")){var t=new XMLHttpRequest,e=r.action;t.onerror=function(a){r.onError(a)},t.onload=function(){if(t.status<200||t.status>=300)return r.onError(getError(e,r,t),getBody(t));r.onSuccess(getBody(t))},t.open(r.method||"get",e,!0);var n;r.data&&((r.dataType||"").toLowerCase()!=="json"?(n=new FormData,Object.keys(r.data).map(function(o){n.append(o,r.data[o])})):(n=JSON.stringify(r.data),t.setRequestHeader("content-type","application/json"))),r.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var i=r.headers||{};Object.keys(i).forEach(function(o){i[o]!==null&&t.setRequestHeader(o,i[o])}),t.send(n)}}var NAME="fcFragment",fragment=defineComponent({name:NAME,inheritAttrs:!1,props:["vnode"],render:function r(){return this.vnode}});function tidyDirectives(r){return Object.keys(r).map(function(t){var e=r[t],n=resolveDirective(t);if(n)return[n,e.value,e.arg,e.modifiers]}).filter(function(t){return!!t})}function makeDirective(r,t){var e=r.directives;return e?(Array.isArray(e)||(e=[e]),withDirectives(t,e.reduce(function(n,i){return n.concat(tidyDirectives(i))},[]))):t}function CreateNodeFactory(){var r={};function t(){}return extend(t.prototype,{make:function(n,i,o){return makeDirective(i,this.h(n,toProps(i),o))},makeComponent:function(n,i,o){try{return makeDirective(i,createVNode(n,toProps(i),o))}catch(a){return console.error(a),createVNode("")}},h:function(n,i,o){var a=getCurrentInstance().appContext.config.isNativeTag(n);a&&delete i.formCreateInject;try{return createVNode(a?n:resolveComponent(n),i,o)}catch(u){return console.error(u),createVNode("")}},aliasMap:r}),extend(t,{aliasMap:r,alias:function(n,i){r[n]=i},use:function(n){Object.keys(n).forEach(function(i){var o=toLine(i),a=toString(i).toLocaleLowerCase(),u=n[i];[i,o,a].forEach(function(s){t.alias(i,u),t.prototype[s]=function(l,c){return this.make(u,l,c)}})})}}),t}function createManager(r){var t=function(e){_inherits(i,e);var n=_createSuper(i);function i(){return _classCallCheck(this,i),n.apply(this,arguments)}return i}(Manager);return Object.assign(t.prototype,r),t}function Manager(r){extend(this,{$handle:r,vm:r.vm,options:{},ref:"fcForm",mergeOptionsRule:{normal:["form","row","info","submitBtn","resetBtn"]}}),this.updateKey(),this.init()}extend(Manager.prototype,{__init:function r(){var t=this;this.$render=this.$handle.$render,this.$r=function(){var e;return(e=t.$render).renderRule.apply(e,arguments)}},updateKey:function r(){this.key=uniqueId()},init:function r(){},update:function r(){},beforeRender:function r(){},form:function r(){return this.vm.refs[this.ref]},mergeOptions:function r(t,e){var n=this;return mergeProps(t.map(function(i){return n.tidyOptions(i)}),e,this.mergeOptionsRule)},updateOptions:function r(t){this.options=this.mergeOptions([t],this.getDefaultOptions()),this.update()},tidyOptions:function r(t){return t},tidyRule:function r(t){},mergeProp:function r(t){},getDefaultOptions:function r(){return{}},render:function r(t){}});var componentValidate={name:"componentValidate",load:function r(t,e,n){var i=t.getValue();i?t.getProp().validate=[{validator:function(){var a=byCtx(e);if(a){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];return n.exec.apply(n,[a.id,i===!0?"formCreateValidate":i].concat(s,[{attr:t,rule:e,api:n}]))}}}]:(t.clearProp(),n.clearValidateState([e.field]))},watch:function r(){componentValidate.load.apply(componentValidate,arguments)}},fetch=function r(t){function e(i){return is.String(i)&&(i={action:i,to:"options"}),i}function n(i,o,a){var u=i.value;if(is.Function(u)&&(u=u(o,a)),u=e(u),!u||!u.action)return!1;u.to||(u.to="options");var s=u.onError,l=function(){if(!i.getValue())return i.clearProp(),a.sync(o),!0},c=function(d){d===void 0?(i.clearProp(),a.sync(o)):deepSet(i.getProp(),u.to,d)};return invoke(function(){return t.create.fetch(_objectSpread2(_objectSpread2({},u),{},{onSuccess:function(d){if(!l()){var p=function(y){return y.data};is.Function(u.parse)&&(p=u.parse),c(p(d,o,a)),a.sync(o)}},onError:function(d){c(void 0),!l()&&(s||function(p){return err(p.message||"fetch fail "+u.action)})(d,o,a)}}),{inject:i,rule:o,api:a})}),!0}return{name:"fetch",loaded:function(){n.apply(void 0,arguments)},watch:function(o,a,u){n(o,a,u)||(o.clearProp(),u.sync(a))}}},$provider={fetch,componentValidate},name$6="html",html={name:name$6,loadChildren:!1,render:function r(t,e){return e.prop.props.innerHTML=t.default(),e.vNode.make(e.prop.props.tag||"div",e.prop)},renderChildren:function r(t){return{default:function(){return t.filter(function(n){return is.String(n)}).join("")}}}};function parseProp(r,t){var e;return arguments.length===2?(e=arguments[1],t=e[r]):e=arguments[2],{id:t,prop:e}}function nameProp(){return parseProp.apply(void 0,["name"].concat(Array.prototype.slice.call(arguments)))}function exportAttrs(r){var t=r.key||[],e=r.array||[],n=r.normal||[];keyAttrs.push.apply(keyAttrs,_toConsumableArray(t)),arrayAttrs.push.apply(arrayAttrs,_toConsumableArray(e)),normalAttrs.push.apply(normalAttrs,_toConsumableArray(n)),appendProto([].concat(_toConsumableArray(t),_toConsumableArray(e),_toConsumableArray(n)))}var id=1,instance={};function FormCreateFactory(r){var t=_defineProperty({},fragment.name,fragment),e={},n={},i={},o=[],a=_objectSpread2({},$provider),u=makerFactory(),s={global:{}},l={},c=CreateNodeFactory();exportAttrs(r.attrs||{});function f(m){var v=instance[m];return Array.isArray(v)?_toConsumableArray(v):v}function d(m){o.push(m)}function p(){var m=nameProp.apply(void 0,arguments);m.id&&m.prop&&(n[m.id]=m.prop)}function g(){var m=nameProp.apply(void 0,arguments);m.id&&m.prop&&(a[m.id]=_objectSpread2(_objectSpread2({},m.prop),{},{name:m.id}))}function y(m){c.use(m)}function $(){var m=nameProp.apply(void 0,arguments);if(!(!m.id||!m.prop)){var v=toCase(m.id),C=m.prop,A=C.merge===!0?e[v]:void 0;e[v]=_objectSpread2(_objectSpread2({},A||BaseParser),C),u[v]=creatorFactory(v),C.maker&&extend(u,C.maker)}}function S(m,v){var C;if(is.String(m)){if(C=m,v===void 0)return t[C]}else C=m.displayName||m.name,v=m;!C||!v||(t[C]=v,t[toCase(C)]=v,v.formCreateParser&&$(C,v.formCreateParser))}function b(){return $FormCreate(j,t,n)}function w(m,v){var C=b();return createApp({data:function(){return reactive({rule:m,option:v})},render:function(){return h(C,_objectSpread2({ref:"fc"},this.$data))}})}function F(){return fragment}function E(m,v){return is.Function(m.install)?m.install(V,v):is.Function(m)&&m(V,v),this}function V(m,v){var C=w(m,v||{});o.forEach(function(k){invoke(function(){return k(V,C)})});var A=document.createElement("div");((v==null?void 0:v.el)||document.body).appendChild(A);var P=C.mount(A);return P.$refs.fc.fapi}function O(m){var v=_objectSpread2({},r);return m?v.inherit={components:t,parsers:e,directives:n,modelFields:i,providers:a,useApps:o,maker:u,data:l}:delete v.inherit,FormCreateFactory(v)}function I(m,v){i[m]=v}function j(m){var v=this;extend(this,{id:id++,create:V,vm:m,manager:createManager(r.manager),parsers:e,providers:a,modelFields:i,rules:m.props.rule,name:m.props.name,inFor:m.props.inFor,prop:{components:t,directives:n},CreateNode:c,bus:new Mitt,unwatch:null,options:ref(m.props.option||{}),extendApi:r.extendApi||function(C){return C}}),nextTick(function(){watch(v.options,function(){v.$handle.$manager.updateOptions(v.options.value),v.api().refresh()},{deep:!0})}),extend(m.appContext.components,t),extend(m.appContext.directives,n),this.$handle=new Handler(this),this.name&&(this.inFor?(instance[this.name]||(instance[this.name]=[]),instance[this.name].push(this.api())):instance[this.name]=this.api())}extend(j.prototype,{init:function(){var v=this;this.isSub()&&(this.unwatch=watch(function(){return v.vm.parent.option},function(){v.initOptions(v.options.value),v.$handle.api.refresh()},{deep:!0})),this.initOptions(this.options.value),this.$handle.init()},isSub:function(){return this.vm.setupState.parent&&this.vm.setupState.extendOption},initOptions:function(v){this.options.value=_objectSpread2({formData:{},submitBtn:{},resetBtn:{}},deepCopy(s)),this.isSub()&&(this.options.value=this.mergeOptions(this.options.value,this.vm.setupState.parent.setupState.fapi.config||{},!0)),this.updateOptions(v)},mergeOptions:function(v,C,A){return C=deepCopy(C),A&&["page","onSubmit","mounted","reload","formData","el"].forEach(function(P){delete C[P]}),C.global&&(v.global=mergeGlobal(v.global,C.global),delete C.global),this.$handle.$manager.mergeOptions([C],v),v},updateOptions:function(v){this.options.value=this.mergeOptions(this.options.value,v),this.$handle.$manager.updateOptions(this.options.value)},api:function(){return this.$handle.api},render:function(){return this.$handle.render()},mounted:function(){this.$handle.mounted()},unmount:function(){if(this.name)if(this.inFor){var v=instance[this.name].indexOf(this.api());instance[this.name].splice(v,1)}else delete instance[this.name];this.unwatch&&this.unwatch(),this.$handle.reloadRule([])},updated:function(){var v=this;this.$handle.bindNextTick(function(){return v.bus.$emit("next-tick",v.$handle.api)})}});function x(m){extend(m,{version:r.version,ui:r.ui,data:l,maker:u,component:S,directive:p,setModelField:I,register:g,$vnode:F,parser:$,use:E,factory:O,componentAlias:y,copyRule,copyRules,fetch:fetch$1,$form:b,parseFn,parseJson,toJson,useApp:d,getApi:f})}function N(m){extend(m,{create:V,install:function(C,A){if(s=_objectSpread2(_objectSpread2({},s),A||{}),C._installedFormCreate!==!0){C._installedFormCreate=!0;var P=function(B){var T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return V(B,T)};x(P),C.config.globalProperties.$formCreate=P,C.component("FormCreate",b()),o.forEach(function(k){invoke(function(){return k(m,C)})})}}})}if(x(V),N(V),c.use({fragment:"fcFragment"}),r.install&&V.use(r),d(function(m,v){v.mixin({props:["formCreateInject"]})}),$(html),r.inherit){var R=r.inherit;R.components&&extend(t,R.components),R.parsers&&extend(e,R.parsers),R.directives&&extend(n,R.directives),R.modelFields&&extend(i,R.modelFields),R.providers&&extend(a,R.providers),R.useApps&&extend(o,R.useApps),R.maker&&extend(u,R.maker),R.data&&extend(l,R.data)}return V}var DEFAULT_FORMATS={date:"YYYY-MM-DD",month:"YYYY-MM",datetime:"YYYY-MM-DD HH:mm:ss",timerange:"HH:mm:ss",daterange:"YYYY-MM-DD",monthrange:"YYYY-MM",datetimerange:"YYYY-MM-DD HH:mm:ss",year:"YYYY"},name$5="datePicker",datePicker={name:name$5,maker:function(){return["year","month","date","dates","week","datetime","datetimeRange","dateRange","monthRange"].reduce(function(r,t){return r[t]=creatorFactory(name$5,{type:t.toLowerCase()}),r},{})}(),mergeProp:function r(t){var e=t.prop.props;e.valueFormat||(e.valueFormat=DEFAULT_FORMATS[e.type]||DEFAULT_FORMATS.date)}},name$4="hidden",hidden={name:name$4,maker:_defineProperty({},name$4,function(r,t){return creatorFactory(name$4)("",r,t)}),render:function r(){return[]}},name$3="input",input={name:name$3,maker:function(){var r=["password","url","email","text","textarea"].reduce(function(t,e){return t[e]=creatorFactory(name$3,{type:e}),t},{});return r.idate=creatorFactory(name$3,{type:"date"}),r}(),mergeProp:function r(t){var e=t.prop.props;e&&e.autosize&&e.autosize.minRows&&(e.rows=e.autosize.minRows||2)}},name$2="slider",slider={name:name$2,maker:{sliderRange:creatorFactory(name$2,{range:!0})},toFormValue:function r(t,e){var n=Array.isArray(t),i=e.prop.props,o=i.min||0,a;return i.range===!0?a=n?t:[o,parseFloat(t)||o]:a=n?parseFloat(t[0])||o:parseFloat(t),a}},name$1="timePicker",timePicker={name:name$1,maker:{time:creatorFactory(name$1,function(r){return r.props.isRange=!1}),timeRange:creatorFactory(name$1,function(r){return r.props.isRange=!0})},mergeProp:function r(t){var e=t.prop.props;e.valueFormat||(e.valueFormat="HH:mm:ss")}},row={name:"FcRow",render:function r(t,e){return e.vNode.col({props:{span:24}},{default:function(){return[e.vNode.row(e.prop,t)]}})}},name="select",select={name,toFormValue:function r(t,e){return e.prop.props.multiple&&!Array.isArray(t)?toArray(t):t}},parsers=[datePicker,hidden,input,slider,timePicker,row,select],PRE="el",alias={button:PRE+"-button",icon:PRE+"-icon",slider:PRE+"-slider",rate:PRE+"-rate",upload:"fc-upload",cascader:PRE+"-cascader",popover:PRE+"-popover",tooltip:PRE+"-tooltip",colorPicker:PRE+"-colorPicker",timePicker:PRE+"-time-picker",timeSelect:PRE+"-time-select",datePicker:PRE+"-date-picker",switch:PRE+"-switch",select:"fc-select",checkbox:"fc-checkbox",radio:"fc-radio",inputNumber:PRE+"-input-number",number:PRE+"-input-number",input:PRE+"-input",formItem:PRE+"-form-item",form:PRE+"-form",frame:"fc-frame",col:PRE+"-col",row:PRE+"-row",tree:"fc-tree",autoComplete:PRE+"-autocomplete",auto:PRE+"-autocomplete",group:"fc-group",object:"fc-sub-form",subForm:"fc-sub-form"};function getConfig(){return{form:{inline:!1,labelPosition:"right",labelWidth:"125px",disabled:!1,size:void 0},row:{show:!0,gutter:0},submitBtn:{type:"primary",loading:!1,disabled:!1,innerText:"提交",show:!0,col:void 0,click:void 0},resetBtn:{type:"default",loading:!1,disabled:!1,innerText:"重置",show:!1,col:void 0,click:void 0}}}function isTooltip(r){return r.type==="tooltip"}function tidy(r,t){if(hasProperty(r,t)&&is.String(r[t])){var e;r[t]=(e={},_defineProperty(e,t,r[t]),_defineProperty(e,"show",!0),e)}}function isFalse(r){return r===!1}function tidyBool(r,t){hasProperty(r,t)&&!is.Object(r[t])&&(r[t]={show:!!r[t]})}function tidyRule(r){var t=_objectSpread2({},r);return delete t.children,t}var manager={validate:function r(){var t=this.form();return t?t.validate():new Promise(function(e){return e()})},validateField:function r(t){var e=this;return new Promise(function(n,i){var o=e.form();o?o.validateField(t,function(a){a?i(a):n(null)}):n()})},clearValidateState:function r(t){var e=this.vm.refs[t.wrapRef];e&&e.clearValidate()},tidyOptions:function r(t){return["submitBtn","resetBtn","row","info","wrap","col"].forEach(function(e){tidyBool(t,e)}),t},tidyRule:function r(t){var e=t.prop;return tidy(e,"title"),tidy(e,"info"),e},mergeProp:function r(t){t.prop=mergeProps([{info:this.options.info||{},wrap:this.options.wrap||{},col:this.options.col||{}},t.prop],{info:{trigger:"hover",placement:"top-start",icon:!0},title:{},col:{span:24},wrap:{}},{normal:["title","info","col","wrap"]})},getDefaultOptions:function r(){return getConfig()},update:function r(){var t=this.options.form;this.rule={props:_objectSpread2({},t),on:{submit:function(n){n.preventDefault()}},class:[t.className,t.class,"form-create"],style:t.style,type:"form"}},beforeRender:function r(){var t=this.key,e=this.ref,n=this.$handle;extend(this.rule,{key:t,ref:e}),extend(this.rule.props,{model:n.formData})},render:function r(t){var e=this;return t.slotLen()&&t.setSlot(void 0,function(){return e.makeFormBtn()}),this.$r(this.rule,isFalse(this.options.row.show)?t.getSlots():[this.makeRow(t)])},makeWrap:function r(t,e){var n=this,i=t.prop,o="".concat(this.key).concat(t.key),a=i.col,u=this.isTitle(i),s=!a.labelWidth&&!u?0:a.labelWidth,l=this.rule.props,c=l.inline,f=l.col,d=isFalse(i.wrap.show)?e:this.$r(mergeProps([i.wrap,{props:_objectSpread2(_objectSpread2({labelWidth:s===void 0?s:toString(s),label:u?i.title.title:void 0},tidyRule(i.wrap||{})),{},{prop:t.id,rules:i.validate}),class:i.className,key:"".concat(o,"fi"),ref:t.wrapRef,type:"formItem"}]),_objectSpread2({default:function(){return e}},u?{label:function(){return n.makeInfo(i,o)}}:{}));return c===!0||isFalse(f)||isFalse(a.show)?d:this.makeCol(i,o,[d])},isTitle:function r(t){if(this.options.form.title===!1)return!1;var e=t.title;return!(!e.title&&!e.native||isFalse(e.show))},makeInfo:function r(t,e){var n=this,i=_objectSpread2({},t.title),o=_objectSpread2({},t.info),a=isTooltip(o),u=this.options.form,s=[(i.title||"")+(u.labelSuffix||u["label-suffix"]||"")];if(!isFalse(o.show)&&(o.info||o.native)&&!isFalse(o.icon)){var l={type:o.type||"popover",props:tidyRule(o),key:"".concat(e,"pop")};delete l.props.icon,delete l.props.show,delete l.props.info,delete l.props.align,delete l.props.native;var c="content";o.info&&!hasProperty(l.props,c)&&(l.props[c]=o.info),s[o.align!=="left"?"unshift":"push"](this.$r(mergeProps([o,l]),_defineProperty({},i.slot||(a?"default":"reference"),function(){return n.$r({type:"ElIcon",style:"top:2px",key:"".concat(e,"i")},{default:function(){return n.$r({type:o.icon===!0?"icon-warning":o.icon})}},!0)})))}var f=mergeProps([i,{props:tidyRule(i),key:"".concat(e,"tit"),type:i.type||"span"}]);return delete f.props.show,delete f.props.title,delete f.props.native,this.$r(f,s)},makeCol:function r(t,e,n){var i=t.col;return this.$r({class:i.class,type:"col",props:i||{span:24},key:"".concat(e,"col")},n)},makeRow:function r(t){var e=this.options.row||{};return this.$r({type:"row",props:e,class:e.class,key:"".concat(this.key,"row")},t)},makeFormBtn:function r(){var t=[];if(isFalse(this.options.submitBtn.show)||t.push(this.makeSubmitBtn()),isFalse(this.options.resetBtn.show)||t.push(this.makeResetBtn()),!!t.length){var e=this.$r({type:"formItem",key:"".concat(this.key,"fb")},t);return this.rule.props.inline===!0?e:this.$r({type:"col",props:{span:24},key:"".concat(this.key,"fc")},[e])}},makeResetBtn:function r(){var t=this,e=_objectSpread2({},this.options.resetBtn),n=e.innerText;return delete e.innerText,delete e.click,delete e.col,delete e.show,this.$r({type:"button",props:e,style:{width:e.width},on:{click:function(){var o=t.$handle.api;t.options.resetBtn.click?t.options.resetBtn.click(o):o.resetFields()}},key:"".concat(this.key,"b2")},[n])},makeSubmitBtn:function r(){var t=this,e=_objectSpread2({},this.options.submitBtn),n=e.innerText;return delete e.innerText,delete e.click,delete e.col,delete e.show,this.$r({type:"button",props:e,style:{width:e.width},on:{click:function(){var o=t.$handle.api;t.options.submitBtn.click?t.options.submitBtn.click(o):o.submit()}},key:"".concat(this.key,"b1")},[n])}},maker$1={};useAlias(maker$1);useSelect(maker$1);useTree(maker$1);useUpload(maker$1);useFrame(maker$1);function useAlias(r){["group","tree","switch","upload","autoComplete","checkbox","cascader","colorPicker","datePicker","frame","inputNumber","radio","rate"].forEach(function(t){r[t]=creatorFactory(t)}),r.auto=r.autoComplete,r.number=r.inputNumber,r.color=r.colorPicker}function useSelect(r){var t="select",e="multiple";r.selectMultiple=creatorFactory(t,_defineProperty({},e,!0)),r.selectOne=creatorFactory(t,_defineProperty({},e,!1))}function useTree(r){var t="tree",e={treeSelected:"selected",treeChecked:"checked"};Object.keys(e).reduce(function(n,i){return n[i]=creatorFactory(t,{type:e[i]}),n},r)}function useUpload(r){var t="upload",e={image:["image",0],file:["file",0],uploadFileOne:["file",1],uploadImageOne:["image",1]};Object.keys(e).reduce(function(n,i){return n[i]=creatorFactory(t,function(o){return o.props({uploadType:e[i][0],maxLength:e[i][1]})}),n},r),r.uploadImage=r.image,r.uploadFile=r.file}function useFrame(r){var t={frameInputs:["input",0],frameFiles:["file",0],frameImages:["image",0],frameInputOne:["input",1],frameFileOne:["file",1],frameImageOne:["image",1]};return Object.keys(t).reduce(function(e,n){return e[n]=creatorFactory("frame",function(i){return i.props({type:t[n][0],maxLength:t[n][1]})}),e},r),r.frameInput=r.frameInputs,r.frameFile=r.frameFiles,r.frameImage=r.frameImages,r}var css_248z=".form-create .form-create .el-form-item{margin-bottom:22px}.form-create{width:100%}";styleInject(css_248z);function tidyBtnProp(r,t){return is.Boolean(r)?r={show:r}:!is.Undef(r)&&!is.Object(r)&&(r={show:t}),r}function extendApi(r,t){return extend(r,{validate:function(n){return new Promise(function(i,o){var a=r.children,u=[t.$manager.validate()];a.forEach(function(s){u.push(s.validate())}),Promise.all(u).then(function(){i(!0),n&&n(!0)}).catch(function(s){o(s),n&&n(s),t.vm.emit("validate-fail",s,{api:r})})})},validateField:function(n,i){return new Promise(function(o,a){var u=t.getFieldCtx(n);if(u){var s=t.subForm[u.id],l=[t.$manager.validateField(u.id)];toArray(s).forEach(function(c){l.push(c.validate())}),Promise.all(l).then(function(){o(null),i&&i(null)}).catch(function(c){a(c),i&&i(c),t.vm.emit("validate-field-fail",c,{field:n,api:r})})}})},clearValidateState:function(n){var i=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r.helper.tidyFields(n).forEach(function(a){o&&i.clearSubValidateState(a),t.getCtxs(a).forEach(function(u){t.$manager.clearValidateState(u)})})},clearSubValidateState:function(n){r.helper.tidyFields(n).forEach(function(i){t.getCtxs(i).forEach(function(o){var a=t.subForm[o.id];a&&(Array.isArray(a)?a.forEach(function(u){u.clearValidateState()}):a&&a.clearValidateState())})})},btn:{loading:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.submitBtnProps({loading:!!n})},disabled:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.submitBtnProps({disabled:!!n})},show:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.submitBtnProps({show:!!n})}},resetBtn:{loading:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.resetBtnProps({loading:!!n})},disabled:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.resetBtnProps({disabled:!!n})},show:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.resetBtnProps({show:!!n})}},submitBtnProps:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=tidyBtnProp(t.options.submitBtn,!0);extend(i,n),t.options.submitBtn=i,r.refreshOptions()},resetBtnProps:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=tidyBtnProp(t.options.resetBtn,!1);extend(i,n),t.options.resetBtn=i,r.refreshOptions()},submit:function(n,i){return new Promise(function(o,a){r.validate().then(function(){var u=r.formData();is.Function(n)&&invoke(function(){return n(u,r)}),is.Function(t.options.onSubmit)&&invoke(function(){return t.options.onSubmit(u,r)}),t.vm.emit("submit",u,r),o(u)}).catch(function(){for(var u=arguments.length,s=new Array(u),l=0;l<u;l++)s[l]=arguments[l];is.Function(i)&&invoke(function(){return i.apply(void 0,[r].concat(s))}),a.apply(void 0,s)})})}}),r}var required={name:"required",load:function r(t,e,n){var i=parseVal(t.getValue());if(i.required===!1)t.clearProp();else{var o=_objectSpread2({required:!0,validator:function(s,l,c){is.empty(l)?c(o.message):c()}},i);if(!o.message){var a=e.title||"";o.message=((_typeof(a)==="object"?a.title:a)||"")+"不能为空"}t.getProp().validate=[o]}n.sync(e)},watch:function r(){required.load.apply(required,arguments)}};function parseVal(r){return is.Boolean(r)?{required:r}:is.String(r)?{message:r}:is.Undef(r)?{required:!1}:is.Function(r)?{validator:r}:is.Object(r)?r:{}}function install(r){r.componentAlias(alias),components.forEach(function(t){r.component(t.name,t)}),r.register(required),parsers.forEach(function(t){r.parser(t)}),Object.keys(maker$1).forEach(function(t){r.maker[t]=maker$1[t]}),typeof window<"u"&&window.ElementPlus&&r.useApp(function(t,e){e.use(window.ElementPlus)})}function elmFormCreate(){return FormCreateFactory({ui:"element-ui",version:"3.1.22",manager,extendApi,install,attrs:{normal:["col","wrap"],array:["className"],key:["title","info"]}})}var FormCreate=elmFormCreate();typeof window<"u"&&(window.formCreate=FormCreate);FormCreate.maker;const _hoisted_1={class:"card-header"},_hoisted_2={class:"font-medium"},_sfc_main=defineComponent({name:"FormCreate",__name:"index",setup(r){const t=FormCreate.$form(),{formCreate:e}=useCreateForm();return(n,i)=>{const o=resolveComponent("el-link"),a=resolveComponent("el-card");return openBlock(),createBlock(a,{shadow:"never"},{header:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createBaseVNode("span",_hoisted_2,[createTextVNode(" JSON 配置表单组件，采用开源的 "),createVNode(o,{href:"http://www.form-create.com/v3/guide/",target:"_blank",style:{margin:"0 4px 5px","font-size":"16px"}},{default:withCtx(()=>[createTextVNode(" form-create ")]),_:1})])])]),default:withCtx(()=>[createVNode(unref(t),{ref:"formCreateRef",rule:unref(e).rule,api:unref(e).fApi,"onUpdate:api":i[0]||(i[0]=u=>unref(e).fApi=u),option:unref(e).options},null,8,["rule","api","option"])]),_:1})}}});export{_sfc_main as default};
