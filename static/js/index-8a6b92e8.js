import{ab as H,d as _,a as C,ac as Z,cO as z,c as M,c4 as q,ad as W,c6 as J,cz as L,p as i,aj as $,af as U,an as D,ag as F,cA as A,cE as ee,cc as te,r as Y,ak as ne,aB as ae,ah as oe,b_ as N,cP as se,v as le,bR as ie,a7 as re,m as ce,aa as ue,am as R,w as B,bn as de,o as fe,B as j,cQ as he,a6 as K,cy as ve,cR as ge,cx as me}from"./index-2d318566.js";import{C as pe}from"./index-434b4cca.js";import{u as xe}from"./use-id-0b0c73bf.js";import{u as Te}from"./index-08eb4df6.js";const[G,E]=H("dropdown-menu"),we={overlay:$,zIndex:U,duration:D(.2),direction:F("down"),activeColor:String,closeOnClickOutside:$,closeOnClickOverlay:$},Q=Symbol(G);var be=_({name:G,props:we,setup(e,{slots:h}){const l=xe(),c=C(),o=C(),d=C(0),{children:g,linkChildren:a}=Z(Q),f=z(c),w=M(()=>g.some(n=>n.state.showWrapper)),b=M(()=>{if(w.value&&q(e.zIndex))return{zIndex:+e.zIndex+1}}),P=()=>{g.forEach(n=>{n.toggle(!1)})},m=()=>{e.closeOnClickOutside&&P()},r=()=>{if(o.value){const n=A(o);e.direction==="down"?d.value=n.bottom:d.value=ee.value-n.top}},x=()=>{w.value&&r()},p=n=>{g.forEach((u,v)=>{v===n?u.toggle():u.state.showPopup&&u.toggle(!1,{immediate:!0})})},T=(n,u)=>{const{showPopup:v}=n.state,{disabled:t,titleClass:s}=n;return i("div",{id:`${l}-${u}`,role:"button",tabindex:t?void 0:0,class:[E("item",{disabled:t}),{[te]:!t}],onClick:()=>{t||p(u)}},[i("span",{class:[E("title",{down:v===(e.direction==="down"),active:v}),s],style:{color:v?e.activeColor:""}},[i("div",{class:"van-ellipsis"},[n.renderTitle()])])])};return W({close:P}),a({id:l,props:e,offset:d,updateOffset:r}),J(c,m),L("scroll",x,{target:f,passive:!0}),()=>{var n;return i("div",{ref:c,class:E()},[i("div",{ref:o,style:b.value,class:E("bar",{opened:w.value})},[g.map(T)]),(n=h.default)==null?void 0:n.call(h)])}}});const[Pe,I]=H("dropdown-item"),Ce={title:String,options:oe(),disabled:Boolean,teleport:[String,Object],lazyRender:$,modelValue:N,titleClass:N};var Se=_({name:Pe,inheritAttrs:!1,props:Ce,emits:["open","opened","close","closed","change","update:modelValue"],setup(e,{emit:h,slots:l,attrs:c}){const o=Y({showPopup:!1,transition:!0,showWrapper:!1}),{parent:d,index:g}=ne(Q);if(!d)return;const a=n=>()=>h(n),f=a("open"),w=a("close"),b=a("opened"),P=()=>{o.showWrapper=!1,h("closed")},m=n=>{e.teleport&&n.stopPropagation()},r=(n=!o.showPopup,u={})=>{n!==o.showPopup&&(o.showPopup=n,o.transition=!u.immediate,n&&(d.updateOffset(),o.showWrapper=!0))},x=()=>{if(l.title)return l.title();if(e.title)return e.title;const n=e.options.find(u=>u.value===e.modelValue);return n?n.text:""},p=n=>{const{activeColor:u}=d.props,v=n.value===e.modelValue,t=()=>{o.showPopup=!1,n.value!==e.modelValue&&(h("update:modelValue",n.value),h("change",n.value))},s=()=>{if(v)return i(ue,{class:I("icon"),color:u,name:"success"},null)};return i(pe,{role:"menuitem",key:n.value,icon:n.icon,title:n.text,class:I("option",{active:v}),style:{color:v?u:""},tabindex:v?0:-1,clickable:!0,onClick:t},{value:s})},T=()=>{const{offset:n}=d,{zIndex:u,overlay:v,duration:t,direction:s,closeOnClickOverlay:S}=d.props,V=se(u);return s==="down"?V.top=`${n.value}px`:V.bottom=`${n.value}px`,le(i("div",ce({style:V,class:I([s]),onClick:m},c),[i(re,{show:o.showPopup,"onUpdate:show":O=>o.showPopup=O,role:"menu",class:I("content"),overlay:v,position:s==="down"?"top":"bottom",duration:o.transition?t:0,lazyRender:e.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${d.id}-${g.value}`,closeOnClickOverlay:S,onOpen:f,onClose:w,onOpened:b,onClosed:P},{default:()=>{var O;return[e.options.map(p),(O=l.default)==null?void 0:O.call(l)]}})]),[[ie,o.showWrapper]])};return W({state:o,toggle:r,renderTitle:x}),()=>e.teleport?i(ae,{to:e.teleport},{default:()=>[T()]}):T()}});const ze=R(Se),We=R(be),[ke,k,ye]=H("list"),$e={error:Boolean,offset:D(300),loading:Boolean,disabled:Boolean,finished:Boolean,errorText:String,direction:F("down"),loadingText:String,finishedText:String,immediateCheck:$};var De=_({name:ke,props:$e,emits:["load","update:error","update:loading"],setup(e,{emit:h,slots:l}){const c=C(e.loading),o=C(),d=C(),g=Te(),a=z(o),f=()=>{j(()=>{if(c.value||e.finished||e.disabled||e.error||(g==null?void 0:g.value)===!1)return;const{direction:r}=e,x=+e.offset,p=A(a);if(!p.height||he(o))return;let T=!1;const n=A(d);r==="up"?T=p.top-n.top<=x:T=n.bottom-p.bottom<=x,T&&(c.value=!0,h("update:loading",!0),h("load"))})},w=()=>{if(e.finished){const r=l.finished?l.finished():e.finishedText;if(r)return i("div",{class:k("finished-text")},[r])}},b=()=>{h("update:error",!1),f()},P=()=>{if(e.error){const r=l.error?l.error():e.errorText;if(r)return i("div",{role:"button",class:k("error-text"),tabindex:0,onClick:b},[r])}},m=()=>{if(c.value&&!e.finished&&!e.disabled)return i("div",{class:k("loading")},[l.loading?l.loading():i(K,{class:k("loading-icon")},{default:()=>[e.loadingText||ye("loading")]})])};return B(()=>[e.loading,e.finished,e.error],f),g&&B(g,r=>{r&&f()}),de(()=>{c.value=e.loading}),fe(()=>{e.immediateCheck&&f()}),W({check:f}),L("scroll",f,{target:a,passive:!0}),()=>{var r;const x=(r=l.default)==null?void 0:r.call(l),p=i("div",{ref:d,class:k("placeholder")},null);return i("div",{ref:o,role:"feed",class:k(),"aria-busy":c.value},[e.direction==="down"?x:p,m(),w(),P(),e.direction==="up"?x:p])}}});const Le=R(De),[Oe,y,Ee]=H("pull-refresh"),X=50,Ie=["pulling","loosing","success"],He={disabled:Boolean,modelValue:Boolean,headHeight:D(X),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:U,successDuration:D(500),animationDuration:D(300)};var _e=_({name:Oe,props:He,emits:["change","refresh","update:modelValue"],setup(e,{emit:h,slots:l}){let c;const o=C(),d=C(),g=z(o),a=Y({status:"normal",distance:0,duration:0}),f=ve(),w=()=>{if(e.headHeight!==X)return{height:`${e.headHeight}px`}},b=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,P=t=>{const s=+(e.pullDistance||e.headHeight);return t>s&&(t<s*2?t=s+(t-s)/2:t=s*1.5+(t-s*2)/4),Math.round(t)},m=(t,s)=>{const S=+(e.pullDistance||e.headHeight);a.distance=t,s?a.status="loading":t===0?a.status="normal":t<S?a.status="pulling":a.status="loosing",h("change",{status:a.status,distance:t})},r=()=>{const{status:t}=a;return t==="normal"?"":e[`${t}Text`]||Ee(t)},x=()=>{const{status:t,distance:s}=a;if(l[t])return l[t]({distance:s});const S=[];return Ie.includes(t)&&S.push(i("div",{class:y("text")},[r()])),t==="loading"&&S.push(i(K,{class:y("loading")},{default:r})),S},p=()=>{a.status="success",setTimeout(()=>{m(0)},+e.successDuration)},T=t=>{c=ge(g.value)===0,c&&(a.duration=0,f.start(t))},n=t=>{b()&&T(t)},u=t=>{if(b()){c||T(t);const{deltaY:s}=f;f.move(t),c&&s.value>=0&&f.isVertical()&&(me(t),m(P(s.value)))}},v=()=>{c&&f.deltaY.value&&b()&&(a.duration=+e.animationDuration,a.status==="loosing"?(m(+e.headHeight,!0),h("update:modelValue",!0),j(()=>h("refresh"))):m(0))};return B(()=>e.modelValue,t=>{a.duration=+e.animationDuration,t?m(+e.headHeight,!0):l.success||e.successText?p():m(0,!1)}),L("touchmove",u,{target:d}),()=>{var t;const s={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return i("div",{ref:o,class:y()},[i("div",{ref:d,class:y("track"),style:s,onTouchstartPassive:n,onTouchend:v,onTouchcancel:v},[i("div",{class:y("head"),style:w()},[x()]),(t=l.default)==null?void 0:t.call(l)])])}}});const Me=R(_e);export{ze as D,Le as L,Me as P,We as a};
