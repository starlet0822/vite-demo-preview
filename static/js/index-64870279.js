import{_ as pe}from"./index-c3f531e4.js";import{d as x,U as de,a as u,c as Q,o as me,Z as W,M as fe,f as l,k as D,g as _,q as a,x as y,u as s,s as $,p as n,J as j,F as X,G as Z,v as ve,I as K,y as L,A as ye,_ as he,X as ge,$ as ke,P as Y,a0 as we,S as Ce,i as Se,H as be}from"./index-52606606.js";/* empty css              */import{_ as Fe}from"./index-f94f057b.js";import{D as xe,a as Re,L as $e,P as Le}from"./index-df0145e0.js";import{_ as Te}from"./index-f4171bee.js";import{T as Me}from"./index-48295745.js";import{C as Ve,R as Oe}from"./index-9806d165.js";import"./index-2ac635a2.js";import{_ as De}from"./index-9569384f.js";import"./index-4f0b9345.js";import{S as je}from"./index-32c4c136.js";import{g as J}from"./dict-ce3ac239.js";import{_ as ee}from"./plugin-vue_export-helper-c27b6911.js";import{T as Ie,a as Ue,S as Be}from"./index-05b6706b.js";import"./index-31c3cb05.js";import"./use-placeholder-c18b0e90.js";import"./use-route-a3458ccc.js";import"./use-id-5fd9d5de.js";import"./index-8700f8a5.js";import"./use-sync-prop-ref-543b16fa.js";import"./index-5d39bcc2.js";import"./utils-9d3f53e3.js";import"./index-2d0bf251.js";const Ne={class:"mock-list"},qe={class:"list-wrapper"},ze=["onClick"],Ke={class:"item-name"},Pe={class:"item-time"},Ae={class:"item-user"},Ee=x({name:"MockList"}),Ge=Object.assign(Ee,{props:{type:{type:String,default:"Search"}},setup(d,{expose:w}){const m=de(),r=u(!1),S=u(1),U=u(20),T=u(0),h=u([]),g=u(!0),k=u(!1),i=u(!1),b=Q(()=>h.value.length?"没有更多了":""),C=u(null),p=u({order:"asc",prop:"createTime"}),F=(o,e)=>{var c,v;console.log("query:",o),p.value={...p.value,...o},r.value=!1,(v=(c=C.value)==null?void 0:c.close)==null||v.call(c),f()},R=async()=>{var o,e;try{i.value&&(h.value=[],i.value=!1);const c={pageNo:S.value,pageSize:U.value,...p.value,type:(o=p.value.type)!=null&&o.length?(e=p.value.type)==null?void 0:e.join(","):""},v=await he.getWorkOrderList(c);if(v.code===0){S.value+=1;const{rows:O,total:q}=v.data??{};T.value=q,h.value=S.value===1?O:h.value.concat(O),h.value.length>=T.value&&(k.value=!0)}}catch(c){console.error("捕获异常",c)}finally{g.value=!1}},M=()=>{var o,e;r.value=!1,(e=(o=C.value)==null?void 0:o.close)==null||e.call(o),f()},f=()=>{i.value=!0,k.value=!1,g.value=!0,S.value=1,R()},B=()=>{const o=document.querySelector(".layout__body");o&&o.classList.add("van-overflow-hidden")},N=()=>{const o=document.querySelector(".layout__body");o&&o.classList.remove("van-overflow-hidden")},P=o=>{var e,c;console.log("onEnter:",o),o.keyCode===13&&((c=(e=C.value).close)==null||c.call(e),f())},te=o=>{m.push({path:"/list-detail",query:{...ge(o,["id","name"])}})};me(()=>{R(),W.on("show-filter",()=>{r.value=!0})});const A=new Map([["-1","全部"],["0","处理中"],["1","已完结"],["2","被退回"]]),oe=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),E=new Map([["0","普通"],["1","售后"],["2","维修"]]),ne=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),se=[{type:"CellField",title:"排序方式",value:"asc",name:"order",attrs:{options:[{label:"升序排序",value:"asc"},{label:"倒序排序",value:"desc"}]}},{type:"CellField",title:"排序字段",value:"createTime",name:"prop",attrs:{options:[{label:"发起时间",value:"createTime"},{label:"工单名称",value:"name"}]}}],V=[{type:"InputField",title:"关键词查询",value:"",name:"name",attrs:{placeholder:"搜索关键词"}},{type:"RadioField",title:"工单状态",value:"-1",name:"status",attrs:{options:J(A)}},{type:"CheckboxField",title:"工单类型（可多选）",value:[],name:"type",attrs:{options:J(E)}}];return w({showFilter:r}),(o,e)=>{const c=je,v=De,O=ke,q=Y,G=Ve,z=xe,H=Re,ae=Oe,le=Me,re=$e,ie=Te,ce=Le,ue=fe("waves");return l(),D("div",Ne,[["Search"].includes(d.type)?(l(),_(c,{key:0,modelValue:s(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>s(p).name=t),shape:"round",placeholder:"搜索关键词","show-action":!0,onKeydown:P},{action:a(()=>[y("div",{class:"st-color-blue",onClick:M},"搜索")]),_:1},8,["modelValue"])):$("",!0),["Filter"].includes(d.type)?(l(),_(O,{key:1,show:s(r),"onUpdate:show":e[2]||(e[2]=t=>j(r)?r.value=t:null),position:"right",closeable:!1,"close-on-popstate":"",style:{width:"85%",height:"100%"}},{default:a(()=>[n(v,{"show-header":"","form-items":V,onConfirm:F,onClose:e[1]||(e[1]=t=>r.value=!1)})]),_:1},8,["show"])):$("",!0),["SearchFilter"].includes(d.type)?(l(),_(ae,{key:2,class:"filter-wrap",type:"flex",align:"center",justify:"space-bettwen"},{default:a(()=>[n(G,{span:"20"},{default:a(()=>[n(c,{modelValue:s(p).name,"onUpdate:modelValue":e[3]||(e[3]=t=>s(p).name=t),style:{width:"100%"},shape:"round",placeholder:"搜索关键词","show-action":"",onKeydown:P},{action:a(()=>[n(q,{name:"search",class:"search-btn",onClick:M})]),_:1},8,["modelValue"])]),_:1}),n(G,{span:"4"},{default:a(()=>[n(H,{ref_key:"menuRef",ref:C,class:"filter-menu","close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(z,{ref:"filterRef",title:"筛选",onClosed:N,onOpened:B},{default:a(()=>[n(v,{"form-items":["SearchFilter"].includes(d.type)?V.slice(1):V,onConfirm:e[4]||(e[4]=t=>F(t,"filter"))},null,8,["form-items"])]),_:1},512)]),_:1},512)]),_:1})]),_:1})):$("",!0),["SortFilter"].includes(d.type)?(l(),_(H,{key:3,ref_key:"menuRef",ref:C,"close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(z,{title:"排序",onClosed:N,onOpened:B},{default:a(()=>[n(v,{"form-items":se,onConfirm:e[5]||(e[5]=t=>F(t,"sort"))})]),_:1}),n(z,{ref:"filterRef",title:"筛选",onClosed:N,onOpened:B},{default:a(()=>[n(v,{"form-items":V,onConfirm:e[6]||(e[6]=t=>F(t,"filter"))})]),_:1},512)]),_:1},512)):$("",!0),n(ce,{modelValue:s(i),"onUpdate:modelValue":e[8]||(e[8]=t=>j(i)?i.value=t:null),onRefresh:f},{default:a(()=>[n(re,{loading:s(g),"onUpdate:loading":e[7]||(e[7]=t=>j(g)?g.value=t:null),"immediate-check":!1,finished:s(k),"finished-text":s(b),onLoad:R},{default:a(()=>[y("ul",qe,[(l(!0),D(X,null,Z(s(h),(t,_e)=>ve((l(),D("li",{key:t.name+_e,class:"list-item st-shadow",onClick:lt=>te(t)},[y("div",null,[y("p",Ke,[K(L(t.name)+" ",1),n(le,{plain:"",color:s(ne).get(t.type)},{default:a(()=>[K(L(s(E).get(t.type)),1)]),_:2},1032,["color"])]),y("p",Pe,"发起时间："+L(t.createTime),1),y("p",Ae,"处理人员："+L(t.handlingUsers),1)]),y("div",{class:"item-status",style:ye({color:s(oe).get(t.status)})},L(s(A).get(t.status)),5)],8,ze)),[[ue]])),128))])]),_:1},8,["loading","finished","finished-text"]),!s(h).length&&!s(g)?(l(),_(ie,{key:0})):$("",!0)]),_:1},8,["modelValue"])])}}}),I=ee(Ge,[["__scopeId","data-v-62aa649e"]]),He=x({name:"Search"}),Je=Object.assign(He,{setup(d){const w=u(null);return(m,r)=>(l(),_(I,{ref_key:"listRef",ref:w,type:"Search"},null,512))}}),Qe=x({name:"Filter"}),We=Object.assign(Qe,{setup(d){return(w,m)=>(l(),_(I,{type:"Filter"}))}}),Xe=x({name:"SearchFilter"}),Ze=Object.assign(Xe,{setup(d){return(w,m)=>(l(),_(I,{type:"SearchFilter"}))}}),Ye=x({name:"SortFilter"}),et=Object.assign(Ye,{setup(d){return(w,m)=>(l(),_(I,{type:"SortFilter"}))}});const tt={class:"st-color-blue st-font-14"},ot={class:"content"},nt={class:"add-btn"},st=x({name:"ListDemo"}),at=Object.assign(st,{setup(d){const w={Search:Je,Filter:We,SearchFilter:Ze,SortFilter:et},m=u(null),r=u("Search"),S=u([{title:"只有搜索",id:"Search"},{title:"只有筛选",id:"Filter"},{title:"搜索筛选",id:"SearchFilter"},{title:"排序筛选",id:"SortFilter"}]),U=g=>{var i,b;console.log("name:",g),console.log("compRef:",m.value),(b=(i=m.menuRef)==null?void 0:i.close)==null||b.call(i);const k=document.querySelector(".layout__body");k&&k.classList.remove("van-overflow-hidden")},T=Q(()=>w[r.value]),h=()=>{switch(console.log("onClickRight:",m.value),r.value){case"Filter":W.emit("show-filter");break}};return(g,k)=>{const i=Y,b=Fe,C=Ie,p=Ue,F=Be,R=be("router-link"),M=pe;return l(),_(M,{class:"work-order-list"},{header:a(()=>[n(b,{border:"",title:"工单列表",onClick:h},we({_:2},[["Filter"].includes(s(r))?{name:"right",fn:a(()=>[y("span",tt,[n(i,{name:"filter-o",class:"st-font-16"}),K(" 筛选 ")])]),key:"0"}:void 0]),1024)]),default:a(()=>[n(F,{"offset-top":0,"z-index":999},{default:a(()=>[n(p,{active:s(r),"onUpdate:active":k[0]||(k[0]=f=>j(r)?r.value=f:null),border:"",onChange:U},{default:a(()=>[(l(!0),D(X,null,Z(s(S),f=>(l(),_(C,{key:f.id,title:f.title,name:f.id},null,8,["title","name"]))),128))]),_:1},8,["active"])]),_:1}),y("main",ot,[(l(),_(Ce,{include:[]},[(l(),_(Se(s(T)),{ref_key:"compRef",ref:m},null,512))],1024))]),y("div",nt,[n(R,{to:"/list-create"},{default:a(()=>[n(i,{name:"plus"})]),_:1})])]),_:1})}}}),Mt=ee(at,[["__scopeId","data-v-3b433d7a"]]);export{Mt as default};
