import{_ as W}from"./index-03d2b5ec.js";import{d as X,a,c as Y,o as H,O as K,g as b,q as n,U as Z,f as _,p as s,Y as ee,u as o,J as R,x as p,k as F,G as te,v as oe,y as f,A as ae,F as se,s as ne,Q as le,M as re,X as ie}from"./index-5560da19.js";import{D as ce,a as ue,L as pe,P as me}from"./index-5456a41c.js";import{_ as de}from"./index-c420e702.js";/* empty css              */import"./index-462a24ae.js";import{_ as _e}from"./index-dabc938b.js";import"./index-ef67e059.js";import{S as fe}from"./index-c2f99ee5.js";import{_ as ve}from"./index-fb7ed376.js";import{g as ge}from"./dict-e1f4519f.js";import{_ as he}from"./plugin-vue_export-helper-c27b6911.js";import{S as ye}from"./index-e2b6ecb5.js";import"./index-0e6beb51.js";import"./use-placeholder-87cf9818.js";import"./use-route-23f883a9.js";import"./use-id-e390e938.js";import"./index-b9dd3661.js";import"./use-sync-prop-ref-d69e1c72.js";import"./index-7fe5bd41.js";import"./index-9a989bb3.js";const ke={class:"list-wrapper"},we={class:"item-name"},xe={class:"item-time"},Ce={class:"item-user"},Se=X({name:"work-order"}),Ve=Object.assign(Se,{setup(be){const L=le(),M=()=>{L.push({path:"/search"})};a(null);const d=a(1),N=a(20),y=a(0),l=a([]),i=a(!0),v=a(!1),c=a(!1),B=Y(()=>l.value.length?"没有更多了":""),k=a(null),m=a({order:"asc",prop:"createTime"}),w=(r,t)=>{var u;console.log("query:",r),m.value={...m.value,...r},(u=k.value)==null||u.close(),x()},g=async()=>{try{c.value&&(l.value=[],c.value=!1);const r={pageNo:d.value,pageSize:N.value,...m.value},t=await Z.getWorkOrderList(r);if(t.code===0){d.value+=1;const{rows:u,total:h}=t.data??{};y.value=h,l.value=d.value===1?u:l.value.concat(u),l.value.length>=y.value&&(v.value=!0)}}catch(r){console.error("捕获异常",r)}finally{i.value=!1}},x=()=>{c.value=!0,v.value=!1,i.value=!0,d.value=1,g()},D=()=>{};H(()=>{g()});const C=new Map([["-1","全部"],["0","处理中"],["1","已完结"],["2","被退回"]]),I=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),T=document.querySelector(".todo-list"),U=[{type:"CellField",title:"排序方式",value:"asc",name:"order",attrs:{options:[{label:"升序排序",value:"asc"},{label:"倒序排序",value:"desc"}]}},{type:"CellField",title:"排序字段",value:"createTime",name:"prop",attrs:{options:[{label:"发起时间",value:"createTime"},{label:"工单名称",value:"name"}]}}],z=K("2003-10-08 08:43").isBefore("2003-10-08 08:43","m");console.log("flag:",z);const O=[{type:"InputField",title:"关键词查询",value:"",name:"name",attrs:{placeholder:"输入搜索关键词"}},{type:"RadioField",title:"工单状态",value:"-1",name:"status",attrs:{options:ge(C)}}];return(r,t)=>{const u=ie,h=ve,P=fe,S=_e,V=ce,$=ue,j=ye,q=pe,Q=de,A=me,E=W,G=re("waves");return _(),b(E,{class:"work-order-list",title:"工单管理"},{header:n(()=>[s(h,{border:"",fixed:!1,title:"工单管理"},ee({_:2},[void 0]),1024)]),default:n(()=>[s(P,{modelValue:o(m).name,"onUpdate:modelValue":t[1]||(t[1]=e=>o(m).name=e),shape:"round",readonly:"",placeholder:"请输入搜索关键词",onClick:M},null,8,["modelValue"]),s(j,{"offset-top":0,"z-index":999},{default:n(()=>[s($,{ref_key:"menuRef",ref:k,"close-on-click-outside":!1,"close-on-click-overlay":!1,onClosed:D},{default:n(()=>[s(V,{title:"排序"},{default:n(()=>[s(S,{"form-items":U,onConfirm:t[2]||(t[2]=e=>w(e,"sort"))})]),_:1}),s(V,{ref:"filterRef",title:"筛选",teleport:o(T)},{default:n(()=>[s(S,{"form-items":O,onConfirm:t[3]||(t[3]=e=>w(e,"filter"))})]),_:1},8,["teleport"])]),_:1},512)]),_:1}),s(A,{modelValue:o(c),"onUpdate:modelValue":t[5]||(t[5]=e=>R(c)?c.value=e:null),onRefresh:x},{default:n(()=>[s(q,{loading:o(i),"onUpdate:loading":t[4]||(t[4]=e=>R(i)?i.value=e:null),"immediate-check":!1,finished:o(v),"finished-text":o(B),onLoad:g},{default:n(()=>[p("ul",ke,[(_(!0),F(se,null,te(o(l),(e,J)=>oe((_(),F("li",{key:e.name+J,class:"list-item"},[p("div",null,[p("p",we,f(e.name),1),p("p",xe,"发起时间："+f(e.createTime),1),p("p",Ce,"处理人员："+f(e.handlingUser),1)]),p("div",{class:"item-status",style:ae({color:o(I).get(e.status)})},f(o(C).get(e.status)),5)])),[[G]])),128))])]),_:1},8,["loading","finished","finished-text"]),!o(l).length&&!o(i)?(_(),b(Q,{key:0})):ne("",!0)]),_:1},8,["modelValue"])]),_:1})}}}),We=he(Ve,[["__scopeId","data-v-2291791b"]]);export{We as default};
