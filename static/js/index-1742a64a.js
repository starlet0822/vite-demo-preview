import{_ as pe}from"./index-4f78cf3f.js";import{d as F,U as de,a as c,c as J,o as me,Z as Q,O as fe,M as ve,f as a,k as j,g as u,q as s,x as m,u as n,s as R,p as o,J as D,F as W,G as X,v as he,I as z,y as $,A as ye,_ as ge,X as ke,$ as we,P as Z,a0 as Se,S as be,i as Ce,H as Fe}from"./index-4a1a9842.js";/* empty css              */import{_ as xe}from"./index-75079144.js";import{D as Re,a as $e,L as Me,P as Te}from"./index-aa01dd12.js";import{_ as Ve}from"./index-28dbdae4.js";import{T as Le}from"./index-4b036e25.js";import{C as je,R as De}from"./index-e78962ba.js";import"./index-59b7ecd9.js";import{_ as Oe}from"./index-5c79e02d.js";import"./index-13b99f4f.js";import{S as Ie}from"./index-4f5687f6.js";import{g as H}from"./dict-ce3ac239.js";import{_ as Y}from"./plugin-vue_export-helper-c27b6911.js";import{T as Ue,a as Ne,S as Be}from"./index-cb74dae9.js";import"./index-d9f0e8c9.js";import"./use-placeholder-9d7764e4.js";import"./use-route-4a788c49.js";import"./use-id-c0fc632f.js";import"./index-72d2bc0a.js";import"./use-sync-prop-ref-442228e0.js";import"./index-9f5c4f57.js";import"./utils-65057151.js";import"./index-2264b9e7.js";const ze={class:"mock-list"},Ke={class:"list-wrapper"},Pe=["onClick"],Ae={class:"item-name"},qe={class:"item-time"},Ee={class:"item-user"},Ge=F({name:"MockList"}),He=Object.assign(Ge,{props:{type:{type:String,default:"Search"}},setup(p,{expose:v}){const k=de(),r=c(!1),S=c(1),I=c(20),M=c(0),h=c([]),f=c(!0),b=c(!1),y=c(!1),U=J(()=>h.value.length?"没有更多了":""),w=c(null),_=c({order:"asc",prop:"createTime"}),C=(l,e)=>{var i,d;console.log("query:",l),_.value={..._.value,...l},r.value=!1,(d=(i=w.value)==null?void 0:i.close)==null||d.call(i),T()},x=async()=>{var l,e;try{y.value&&(h.value=[],y.value=!1);const i={pageNo:S.value,pageSize:I.value,..._.value,type:(l=_.value.type)!=null&&l.length?(e=_.value.type)==null?void 0:e.join(","):""},d=await ge.getWorkOrderList(i);if(d.code===0){S.value+=1;const{rows:L,total:N}=d.data??{};M.value=N,h.value=S.value===1?L:h.value.concat(L),h.value.length>=M.value&&(b.value=!0)}}catch(i){console.error("捕获异常",i)}finally{f.value=!1}},g=()=>{var l,e;r.value=!1,(e=(l=w.value)==null?void 0:l.close)==null||e.call(l),T()},T=()=>{y.value=!0,b.value=!1,f.value=!0,S.value=1,x()},K=()=>{},P=l=>{var e,i;console.log("onEnter:",l),l.keyCode===13&&((i=(e=w.value).close)==null||i.call(e),T())},ee=l=>{k.push({path:"/list-detail",query:{...ke(l,["id","name"])}})};me(()=>{x(),Q.on("show-filter",()=>{r.value=!0})});const A=new Map([["-1","全部"],["0","处理中"],["1","已完结"],["2","被退回"]]),te=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),q=new Map([["0","普通"],["1","售后"],["2","维修"]]),oe=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),ne=[{type:"CellField",title:"排序方式",value:"asc",name:"order",attrs:{options:[{label:"升序排序",value:"asc"},{label:"倒序排序",value:"desc"}]}},{type:"CellField",title:"排序字段",value:"createTime",name:"prop",attrs:{options:[{label:"发起时间",value:"createTime"},{label:"工单名称",value:"name"}]}}],se=fe("2003-10-08 08:43").isBefore("2003-10-08 08:43","m");console.log("flag:",se);const V=[{type:"InputField",title:"关键词查询",value:"",name:"name",attrs:{placeholder:"搜索关键词"}},{type:"RadioField",title:"工单状态",value:"-1",name:"status",attrs:{options:H(A)}},{type:"CheckboxField",title:"工单类型（可多选）",value:[],name:"type",attrs:{options:H(q)}}];return v({showFilter:r}),(l,e)=>{const i=Ie,d=Oe,L=we,N=Z,E=je,B=Re,G=$e,ae=De,le=Le,re=Me,ie=Ve,ce=Te,ue=ve("waves");return a(),j("div",ze,[["Search"].includes(p.type)?(a(),u(i,{key:0,modelValue:n(_).name,"onUpdate:modelValue":e[0]||(e[0]=t=>n(_).name=t),shape:"round",placeholder:"搜索关键词","show-action":!0,onKeydown:P},{action:s(()=>[m("div",{class:"st-color-blue",onClick:g},"搜索")]),_:1},8,["modelValue"])):R("",!0),["Filter"].includes(p.type)?(a(),u(L,{key:1,show:n(r),"onUpdate:show":e[1]||(e[1]=t=>D(r)?r.value=t:null),position:"right",closeable:!1,"close-on-popstate":"",style:{width:"85%",height:"100%"}},{default:s(()=>[o(d,{"show-header":"","form-items":V,onConfirm:C})]),_:1},8,["show"])):R("",!0),["SearchFilter"].includes(p.type)?(a(),u(ae,{key:2,class:"filter-wrap",type:"flex",align:"center",justify:"space-bettwen"},{default:s(()=>[o(E,{span:"20"},{default:s(()=>[o(i,{modelValue:n(_).name,"onUpdate:modelValue":e[2]||(e[2]=t=>n(_).name=t),style:{width:"100%"},shape:"round",placeholder:"搜索关键词","show-action":"",onKeydown:P},{action:s(()=>[o(N,{name:"search",class:"search-btn",onClick:g})]),_:1},8,["modelValue"])]),_:1}),o(E,{span:"4"},{default:s(()=>[o(G,{ref_key:"menuRef",ref:w,class:"filter-menu","close-on-click-outside":!1,"close-on-click-overlay":!1,onClosed:K},{default:s(()=>[o(B,{ref:"filterRef",title:"筛选"},{default:s(()=>[o(d,{"form-items":["SearchFilter"].includes(p.type)?V.slice(1):V,onConfirm:e[3]||(e[3]=t=>C(t,"filter"))},null,8,["form-items"])]),_:1},512)]),_:1},512)]),_:1})]),_:1})):R("",!0),["SortFilter"].includes(p.type)?(a(),u(G,{key:3,ref_key:"menuRef",ref:w,"close-on-click-outside":!1,"close-on-click-overlay":!1,onClosed:K},{default:s(()=>[o(B,{title:"排序"},{default:s(()=>[o(d,{"form-items":ne,onConfirm:e[4]||(e[4]=t=>C(t,"sort"))})]),_:1}),o(B,{ref:"filterRef",title:"筛选"},{default:s(()=>[o(d,{"form-items":V,onConfirm:e[5]||(e[5]=t=>C(t,"filter"))})]),_:1},512)]),_:1},512)):R("",!0),o(ce,{modelValue:n(y),"onUpdate:modelValue":e[7]||(e[7]=t=>D(y)?y.value=t:null),onRefresh:T},{default:s(()=>[o(re,{loading:n(f),"onUpdate:loading":e[6]||(e[6]=t=>D(f)?f.value=t:null),"immediate-check":!1,finished:n(b),"finished-text":n(U),onLoad:x},{default:s(()=>[m("ul",Ke,[(a(!0),j(W,null,X(n(h),(t,_e)=>he((a(),j("li",{key:t.name+_e,class:"list-item st-shadow",onClick:rt=>ee(t)},[m("div",null,[m("p",Ae,[z($(t.name)+" ",1),o(le,{plain:"",color:n(oe).get(t.type)},{default:s(()=>[z($(n(q).get(t.type)),1)]),_:2},1032,["color"])]),m("p",qe,"发起时间："+$(t.createTime),1),m("p",Ee,"处理人员："+$(t.handlingUsers),1)]),m("div",{class:"item-status",style:ye({color:n(te).get(t.status)})},$(n(A).get(t.status)),5)],8,Pe)),[[ue]])),128))])]),_:1},8,["loading","finished","finished-text"]),!n(h).length&&!n(f)?(a(),u(ie,{key:0})):R("",!0)]),_:1},8,["modelValue"])])}}}),O=Y(He,[["__scopeId","data-v-d7b6978c"]]),Je=F({name:"Search"}),Qe=Object.assign(Je,{setup(p){const v=c(null);return(k,r)=>(a(),u(O,{ref_key:"listRef",ref:v,type:"Search"},null,512))}}),We=F({name:"Filter"}),Xe=Object.assign(We,{setup(p){return(v,k)=>(a(),u(O,{type:"Filter"}))}}),Ze=F({name:"SearchFilter"}),Ye=Object.assign(Ze,{setup(p){return(v,k)=>(a(),u(O,{type:"SearchFilter"}))}}),et=F({name:"SortFilter"}),tt=Object.assign(et,{setup(p){return(v,k)=>(a(),u(O,{type:"SortFilter"}))}});const ot={class:"st-color-blue st-font-14"},nt={class:"content"},st={class:"add-btn"},at=F({name:"ListDemo"}),lt=Object.assign(at,{setup(p){const v={Search:Qe,Filter:Xe,SearchFilter:Ye,SortFilter:tt},k=c(null),r=c("Search"),S=c([{title:"只有搜索",id:"Search"},{title:"只有筛选",id:"Filter"},{title:"搜索和筛选",id:"SearchFilter"},{title:"排序和筛选",id:"SortFilter"}]),I=J(()=>v[r.value]),M=()=>{switch(r.value){case"Filter":Q.emit("show-filter");break}};return(h,f)=>{const b=Z,y=xe,U=Ue,w=Ne,_=Be,C=Fe("router-link"),x=pe;return a(),u(x,{class:"work-order-list"},{header:s(()=>[o(y,{border:"",title:"工单列表",onClick:M},Se({_:2},[["Filter"].includes(n(r))?{name:"right",fn:s(()=>[m("span",ot,[o(b,{name:"filter-o",class:"st-font-16"}),z(" 筛选 ")])]),key:"0"}:void 0]),1024)]),default:s(()=>[o(_,{"offset-top":0,"z-index":999},{default:s(()=>[o(w,{active:n(r),"onUpdate:active":f[0]||(f[0]=g=>D(r)?r.value=g:null),border:""},{default:s(()=>[(a(!0),j(W,null,X(n(S),g=>(a(),u(U,{key:g.id,title:g.title,name:g.id},null,8,["title","name"]))),128))]),_:1},8,["active"])]),_:1}),m("main",nt,[(a(),u(be,null,[(a(),u(Ce(n(I)),{ref_key:"compRef",ref:k},null,512))],1024))]),m("div",st,[o(C,{to:"/list-create"},{default:s(()=>[o(b,{name:"plus"})]),_:1})])]),_:1})}}}),Lt=Y(lt,[["__scopeId","data-v-0e70318a"]]);export{Lt as default};
