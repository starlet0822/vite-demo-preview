import{a as D,v as Q,e as p,l as B,o as E,I as L,c as u,m as h,r as n,T as M,b0 as U,K as z,U as K,ak as W,h as g,j as _,i as q}from"./index-77d71d8d.js";import{Q as G}from"./question-filled-00b6e9f5.js";import{_ as H}from"./plugin-vueexport-helper-c27b6911.js";function J(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!q(l)}const X={"el-select":"el-option","el-radio-group":"el-radio","el-checkbox-group":"el-checkbox"},Y=["el-checkbox-group"],Z=D({name:"ProForm",inheritAttrs:!1,components:{QuestionFilled:G},emits:["update:modelValue","update:api","change","submit","reset"],props:{api:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})},formOptions:{type:Object,default:()=>({})},rowOptions:{type:Object,default:()=>({})},colCount:{type:[Number,String],default:1,validator:l=>[1,2,3,4,6,8,12,24].includes(+l)},isQuery:{type:Boolean,default:!1},expand:{type:Boolean,default:!1},showActions:Boolean,formItems:{type:Array,default:()=>[]}},setup(l,{emit:c,slots:r}){const x=M(),O=Q(()=>Object.keys(l.formItems).length>0),m=Object.assign({labelPosition:"right",labelWidth:"120px",disabled:!1,size:void 0,"scroll-to-error":!0},l.formOptions),C={gutter:16,type:"flex",align:"middle",...l.rowOptions},b=()=>{const e={},a=o=>{let t="";return U(o.value)?Y.includes(o.type)?t=[]:t="":t=o.value,t};return l.formItems.forEach(o=>{o.prop&&(e[o.prop]=a(o))}),{...e,...l.modelValue}},d=p(),V=p({}),s=p(b()),k=e=>e?X[e]:!1;B(()=>s,e=>{c("update:modelValue",e)},{deep:!0,immediate:!1}),E(()=>{F(),c("update:modelValue",s.value)});const F=async()=>{await L();const e={...d.value,...x,initFormModel:b};c("update:api",e)},j=async()=>{var e;await((e=d.value)==null?void 0:e.validate((a,o)=>{c("submit",{valid:a,fields:o,form:s.value,api:l.api})}))},I=()=>{var e;(e=d.value)==null||e.resetFields(),c("reset")},P=e=>{const a={};return e.labelRender&&(a.label=o=>A(o,e)),a},A=(e,a)=>a.labelRender(e),S=(e,a)=>{s.value[a]=e,c("change",{value:e,props:l}),c("update:modelValue",s.value)},w=e=>{let a;const o=["el-input","el-textarea","el-input-number","el-autocomplete"],t=["el-select","el-select-v2","el-tree-select","el-cascader","el-time-select","el-time-picker","el-date-picker"];return o.includes(e.type)?a="请输入"+e.label:t.includes(e.type)?a="请选择"+e.label:a="请填写"+e.label,a},T=e=>{const a=e.attrs??{};return{placeholder:w(e),...a}},N=()=>{const e=l.formItems.length;return+l.colCount>e?24/(e<4?4:e):24/+l.colCount};return()=>{let e;return O.value&&u(n("el-form"),h({ref:d,class:"proForm",model:s.value,rules:V.value},m),{default:()=>{var a,o;return[m.inline?u(z,null,null):u(n("el-row"),C,J(e=l.formItems.map((t,R)=>{var y;return K(u(n("el-col"),h({key:t.prop},{...t.col,span:((y=t.col)==null?void 0:y.span)??N()}),{default:()=>[u(n("el-form-item"),t,{default:()=>{var v;return[t.type==="el-text"?u(n("el-text"),t.attrs,{default:()=>[t.value]}):t.type==="slot"?(v=r[t.slotName])==null?void 0:v.call(r,t||{}):g(n(t.type),{...T(t),modelValue:s.value[t.prop],"onUpdate:modelValue":i=>S(i,t.prop)},t.options?()=>{var i;return(i=t.options)==null?void 0:i.map(f=>g(n(f.optionsType||k(t.type)),{...f,key:t.label},{default:()=>f.text}))}:null)]},...P(t)})]}),[[W,l.isQuery?l.expand||R<l.colCount:!0]])}))?e:{default:()=>[e]}),(a=r.actions)!=null&&a.call(r)?(o=r.actions)==null?void 0:o.call(r,{form:s.value}):l.showActions?u(n("el-form-item"),null,{default:()=>[u(n("el-button"),{type:"primary",onClick:j},{default:()=>[_("提 交")]}),u(n("el-button"),{onClick:I},{default:()=>[_("重 置")]})]}):null]}})}}});const le=H(Z,[["__scopeId","data-v-e50a68a7"]]);export{le as P};
