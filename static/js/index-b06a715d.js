import{a1 as H,d as _,a as C,c5 as Q,cZ as B,c as M,cv as X,cl as W,ca as q,cf as L,p as i,ax as $,a3 as N,av as D,au as U,cA as A,cE as ee,cF as te,r as Y,a5 as ne,aJ as ae,cb as oe,a4 as F,cQ as se,v as le,bY as ie,$ as re,m as ce,P as ue,a7 as V,w as z,bu as de,o as fe,B as K,c$ as he,ar as Z,cy as ve,cz as ge,cS as me}from"./index-9fff26e3.js";import{C as pe}from"./index-93da6f84.js";import{u as xe}from"./use-id-80a9ab92.js";import{u as Te}from"./index-05c91559.js";const[j,E]=H("dropdown-menu"),we={overlay:$,zIndex:N,duration:D(.2),direction:U("down"),activeColor:String,closeOnClickOutside:$,closeOnClickOverlay:$},G=Symbol(j);var be=_({name:j,props:we,setup(e,{slots:h}){const l=xe(),c=C(),o=C(),d=C(0),{children:g,linkChildren:a}=Q(G),f=B(c),w=M(()=>g.some(n=>n.state.showWrapper)),b=M(()=>{if(w.value&&X(e.zIndex))return{zIndex:+e.zIndex+1}}),P=()=>{g.forEach(n=>{n.toggle(!1)})},m=()=>{e.closeOnClickOutside&&P()},r=()=>{if(o.value){const n=A(o);e.direction==="down"?d.value=n.bottom:d.value=ee.value-n.top}},x=()=>{w.value&&r()},p=n=>{g.forEach((u,v)=>{v===n?u.toggle():u.state.showPopup&&u.toggle(!1,{immediate:!0})})},T=(n,u)=>{const{showPopup:v}=n.state,{disabled:t,titleClass:s}=n;return i("div",{id:`${l}-${u}`,role:"button",tabindex:t?void 0:0,class:[E("item",{disabled:t}),{[te]:!t}],onClick:()=>{t||p(u)}},[i("span",{class:[E("title",{down:v===(e.direction==="down"),active:v}),s],style:{color:v?e.activeColor:""}},[i("div",{class:"van-ellipsis"},[n.renderTitle()])])])};return W({close:P}),a({id:l,props:e,offset:d,updateOffset:r}),q(c,m),L("scroll",x,{target:f,passive:!0}),()=>{var n;return i("div",{ref:c,class:E()},[i("div",{ref:o,style:b.value,class:E("bar",{opened:w.value})},[g.map(T)]),(n=h.default)==null?void 0:n.call(h)])}}});const[Pe,I]=H("dropdown-item"),Ce={title:String,options:oe(),disabled:Boolean,teleport:[String,Object],lazyRender:$,modelValue:F,titleClass:F};var Se=_({name:Pe,inheritAttrs:!1,props:Ce,emits:["open","opened","close","closed","change","update:modelValue"],setup(e,{emit:h,slots:l,attrs:c}){const o=Y({showPopup:!1,transition:!0,showWrapper:!1}),{parent:d,index:g}=ne(G);if(!d)return;const a=n=>()=>h(n),f=a("open"),w=a("close"),b=a("opened"),P=()=>{o.showWrapper=!1,h("closed")},m=n=>{e.teleport&&n.stopPropagation()},r=(n=!o.showPopup,u={})=>{n!==o.showPopup&&(o.showPopup=n,o.transition=!u.immediate,n&&(d.updateOffset(),o.showWrapper=!0))},x=()=>{if(l.title)return l.title();if(e.title)return e.title;const n=e.options.find(u=>u.value===e.modelValue);return n?n.text:""},p=n=>{const{activeColor:u}=d.props,v=n.value===e.modelValue,t=()=>{o.showPopup=!1,n.value!==e.modelValue&&(h("update:modelValue",n.value),h("change",n.value))},s=()=>{if(v)return i(ue,{class:I("icon"),color:u,name:"success"},null)};return i(pe,{role:"menuitem",key:n.value,icon:n.icon,title:n.text,class:I("option",{active:v}),style:{color:v?u:""},tabindex:v?0:-1,clickable:!0,onClick:t},{value:s})},T=()=>{const{offset:n}=d,{zIndex:u,overlay:v,duration:t,direction:s,closeOnClickOverlay:S}=d.props,R=se(u);return s==="down"?R.top=`${n.value}px`:R.bottom=`${n.value}px`,le(i("div",ce({style:R,class:I([s]),onClick:m},c),[i(re,{show:o.showPopup,"onUpdate:show":O=>o.showPopup=O,role:"menu",class:I("content"),overlay:v,position:s==="down"?"top":"bottom",duration:o.transition?t:0,lazyRender:e.lazyRender,overlayStyle:{position:"absolute"},"aria-labelledby":`${d.id}-${g.value}`,closeOnClickOverlay:S,onOpen:f,onClose:w,onOpened:b,onClosed:P},{default:()=>{var O;return[e.options.map(p),(O=l.default)==null?void 0:O.call(l)]}})]),[[ie,o.showWrapper]])};return W({state:o,toggle:r,renderTitle:x}),()=>e.teleport?i(ae,{to:e.teleport},{default:()=>[T()]}):T()}});const Be=V(Se),We=V(be),[ye,y,ke]=H("list"),$e={error:Boolean,offset:D(300),loading:Boolean,disabled:Boolean,finished:Boolean,errorText:String,direction:U("down"),loadingText:String,finishedText:String,immediateCheck:$};var De=_({name:ye,props:$e,emits:["load","update:error","update:loading"],setup(e,{emit:h,slots:l}){const c=C(e.loading),o=C(),d=C(),g=Te(),a=B(o),f=()=>{K(()=>{if(c.value||e.finished||e.disabled||e.error||(g==null?void 0:g.value)===!1)return;const{direction:r}=e,x=+e.offset,p=A(a);if(!p.height||he(o))return;let T=!1;const n=A(d);r==="up"?T=p.top-n.top<=x:T=n.bottom-p.bottom<=x,T&&(c.value=!0,h("update:loading",!0),h("load"))})},w=()=>{if(e.finished){const r=l.finished?l.finished():e.finishedText;if(r)return i("div",{class:y("finished-text")},[r])}},b=()=>{h("update:error",!1),f()},P=()=>{if(e.error){const r=l.error?l.error():e.errorText;if(r)return i("div",{role:"button",class:y("error-text"),tabindex:0,onClick:b},[r])}},m=()=>{if(c.value&&!e.finished&&!e.disabled)return i("div",{class:y("loading")},[l.loading?l.loading():i(Z,{class:y("loading-icon")},{default:()=>[e.loadingText||ke("loading")]})])};return z(()=>[e.loading,e.finished,e.error],f),g&&z(g,r=>{r&&f()}),de(()=>{c.value=e.loading}),fe(()=>{e.immediateCheck&&f()}),W({check:f}),L("scroll",f,{target:a,passive:!0}),()=>{var r;const x=(r=l.default)==null?void 0:r.call(l),p=i("div",{ref:d,class:y("placeholder")},null);return i("div",{ref:o,role:"feed",class:y(),"aria-busy":c.value},[e.direction==="down"?x:p,m(),w(),P(),e.direction==="up"?x:p])}}});const Le=V(De),[Oe,k,Ee]=H("pull-refresh"),J=50,Ie=["pulling","loosing","success"],He={disabled:Boolean,modelValue:Boolean,headHeight:D(J),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:N,successDuration:D(500),animationDuration:D(300)};var _e=_({name:Oe,props:He,emits:["change","refresh","update:modelValue"],setup(e,{emit:h,slots:l}){let c;const o=C(),d=C(),g=B(o),a=Y({status:"normal",distance:0,duration:0}),f=ve(),w=()=>{if(e.headHeight!==J)return{height:`${e.headHeight}px`}},b=()=>a.status!=="loading"&&a.status!=="success"&&!e.disabled,P=t=>{const s=+(e.pullDistance||e.headHeight);return t>s&&(t<s*2?t=s+(t-s)/2:t=s*1.5+(t-s*2)/4),Math.round(t)},m=(t,s)=>{const S=+(e.pullDistance||e.headHeight);a.distance=t,s?a.status="loading":t===0?a.status="normal":t<S?a.status="pulling":a.status="loosing",h("change",{status:a.status,distance:t})},r=()=>{const{status:t}=a;return t==="normal"?"":e[`${t}Text`]||Ee(t)},x=()=>{const{status:t,distance:s}=a;if(l[t])return l[t]({distance:s});const S=[];return Ie.includes(t)&&S.push(i("div",{class:k("text")},[r()])),t==="loading"&&S.push(i(Z,{class:k("loading")},{default:r})),S},p=()=>{a.status="success",setTimeout(()=>{m(0)},+e.successDuration)},T=t=>{c=me(g.value)===0,c&&(a.duration=0,f.start(t))},n=t=>{b()&&T(t)},u=t=>{if(b()){c||T(t);const{deltaY:s}=f;f.move(t),c&&s.value>=0&&f.isVertical()&&(ge(t),m(P(s.value)))}},v=()=>{c&&f.deltaY.value&&b()&&(a.duration=+e.animationDuration,a.status==="loosing"?(m(+e.headHeight,!0),h("update:modelValue",!0),K(()=>h("refresh"))):m(0))};return z(()=>e.modelValue,t=>{a.duration=+e.animationDuration,t?m(+e.headHeight,!0):l.success||e.successText?p():m(0,!1)}),L("touchmove",u,{target:d}),()=>{var t;const s={transitionDuration:`${a.duration}ms`,transform:a.distance?`translate3d(0,${a.distance}px, 0)`:""};return i("div",{ref:o,class:k()},[i("div",{ref:d,class:k("track"),style:s,onTouchstartPassive:n,onTouchend:v,onTouchcancel:v},[i("div",{class:k("head"),style:w()},[x()]),(t=l.default)==null?void 0:t.call(l)])])}}});const Me=V(_e);export{Be as D,Le as L,Me as P,We as a};
