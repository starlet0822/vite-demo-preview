import{E as k}from"./exceljs.min-8e99a1f8.js";import{a as i,r as p,g as m,f as h,w as l,c as r,u as w,br as b,k as d,j as g,n as B}from"./index-77d71d8d.js";const y=d("div",{class:"el-upload__text"},[g("将文件拖到此处，或"),d("em",null,"点击上传")],-1),v=d("div",{class:"el-upload__tip"},"只能上传 .xlsx, .xls 文件，且不超过500kb",-1),E=i({__name:"Import",props:{mode:{type:String,default:"button"},onSuccess:Function},setup(f){const t=({file:e})=>{_(e)},a=e=>new k.Workbook().xlsx.load(e),_=e=>new Promise((s,n)=>{const o=new FileReader;o.onload=async u=>{try{const c=u.target&&u.target.result,x=a(c),F=getExcelData(x);s("")}catch(c){n(c)}finally{}},o.readAsArrayBuffer(e)});return(e,s)=>{const n=p("el-icon"),o=p("el-upload");return m(),h(o,{class:"upload-demo",accept:".xlsx, .xls",drag:"",action:"/",multiple:!1,limit:1,"http-request":t},{tip:l(()=>[v]),default:l(()=>[r(n,{class:"el-icon--upload"},{default:l(()=>[r(w(b))]),_:1}),y]),_:1})}}}),N=i({__name:"Import",setup(f){const t=a=>{};return(a,_)=>(m(),B("div",null,[r(E,{"on-success":t})]))}});export{N as default};
