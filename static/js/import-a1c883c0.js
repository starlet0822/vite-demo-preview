import{E as k}from"./exceljs.min-b2fe2512.js";import{d as i,b as p,e as m,c as h,w as l,f as r,u as b,b7 as w,h as d,g,j as B}from"./index-95d00287.js";const y=d("div",{class:"el-upload__text"},[g("将文件拖到此处，或"),d("em",null,"点击上传")],-1),v=d("div",{class:"el-upload__tip"},"只能上传 .xlsx, .xls 文件，且不超过500kb",-1),E=i({__name:"Import",props:{mode:{type:String,default:"button"},onSuccess:Function},setup(f){const t=({file:e})=>{_(e)},a=e=>new k.Workbook().xlsx.load(e),_=e=>new Promise((s,c)=>{const o=new FileReader;o.onload=async u=>{try{const n=u.target&&u.target.result,x=a(n),F=getExcelData(x);s("")}catch(n){c(n)}finally{}},o.readAsArrayBuffer(e)});return(e,s)=>{const c=p("el-icon"),o=p("el-upload");return m(),h(o,{class:"upload-demo",accept:".xlsx, .xls",drag:"",action:"/",multiple:!1,limit:1,"http-request":t},{tip:l(()=>[v]),default:l(()=>[r(c,{class:"el-icon--upload"},{default:l(()=>[r(b(w))]),_:1}),y]),_:1})}}}),N=i({__name:"import",setup(f){const t=a=>{};return(a,_)=>(m(),B("div",null,[r(E,{"on-success":t})]))}});export{N as default};
