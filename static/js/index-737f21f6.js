import{_ as de}from"./index-61810bea.js";import{d as x,U as fe,a as i,c as W,o as me,Z as X,M as ve,f as l,k as j,g as _,q as a,x as v,u as s,s as L,p as n,J as I,F as Z,G as Y,v as ye,I as P,y as T,A as he,_ as ge,X as ke,$ as we,P as ee,a0 as Se,S as be,i as Ce,H as Fe}from"./index-96f987ab.js";/* empty css              */import{_ as Re}from"./index-3f6d1123.js";import{D as xe,a as $e,L as Le,P as Te}from"./index-2f18a284.js";import{_ as Me}from"./index-fc1fc2c9.js";import{T as Ve}from"./index-03d43e1a.js";import{C as Oe,R as De}from"./index-54356f74.js";import"./index-caaea2a8.js";import{_ as je}from"./index-61c5bf10.js";import"./index-4da2c942.js";import{S as Ie}from"./index-d9279171.js";import{g as Q}from"./dict-ce3ac239.js";import{_ as te}from"./plugin-vue_export-helper-c27b6911.js";import{T as Ue,a as Be,S as Ne}from"./index-5871a115.js";import"./index-67b09d1c.js";import"./use-placeholder-9429c211.js";import"./use-route-a106f139.js";import"./use-id-d2a1ebc6.js";import"./index-1eb925c0.js";import"./use-sync-prop-ref-d7f8ca92.js";import"./index-38e46845.js";import"./utils-ca2bfadd.js";import"./index-934737db.js";const qe={class:"mock-list"},ze={class:"list-wrapper"},Ke=["onClick"],Pe={class:"item-name"},Ae={class:"item-time"},Ee={class:"item-user"},Ge=x({name:"MockList"}),He=Object.assign(Ge,{props:{type:{type:String,default:"Search"}},setup(d,{expose:k}){const f=fe(),r=i(!1),b=i(1),B=i(20),M=i(0),y=i([]),h=i(!0),g=i(!1),c=i(!1),C=W(()=>y.value.length?"没有更多了":""),S=i(null),F=i(null),p=i({order:"asc",prop:"createTime"}),R=(o,e)=>{var u,m;console.log("query:",o),p.value={...p.value,...o},r.value=!1,(m=(u=S.value)==null?void 0:u.close)==null||m.call(u),V()},$=async()=>{var o,e;try{c.value&&(y.value=[],c.value=!1);const u={pageNo:b.value,pageSize:B.value,...p.value,type:(o=p.value.type)!=null&&o.length?(e=p.value.type)==null?void 0:e.join(","):""},m=await ge.getWorkOrderList(u);if(m.code===0){b.value+=1;const{rows:D,total:z}=m.data??{};M.value=z,y.value=b.value===1?D:y.value.concat(D),y.value.length>=M.value&&(g.value=!0)}}catch(u){console.error("捕获异常",u)}finally{h.value=!1}},w=()=>{var o,e;r.value=!1,(e=(o=S.value)==null?void 0:o.close)==null||e.call(o),V()},V=()=>{c.value=!0,g.value=!1,h.value=!0,b.value=1,$()},N=()=>{const o=document.querySelector(".layout__body");o&&o.classList.add("van-overflow-hidden")},q=()=>{const o=document.querySelector(".layout__body");o&&o.classList.remove("van-overflow-hidden")},A=o=>{var e,u;console.log("onEnter:",o),o.keyCode===13&&((u=(e=S.value).close)==null||u.call(e),V())},oe=o=>{f.push({path:"/list-detail",query:{...ke(o,["id","name"])}})};me(()=>{$(),X.on("show-filter",()=>{r.value=!0})});const E=new Map([["-1","全部"],["0","处理中"],["1","已完结"],["2","被退回"]]),ne=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),G=new Map([["0","普通"],["1","售后"],["2","维修"]]),se=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),ae=[{type:"CellField",title:"排序方式",value:"asc",name:"order",attrs:{options:[{label:"升序排序",value:"asc"},{label:"倒序排序",value:"desc"}]}},{type:"CellField",title:"排序字段",value:"createTime",name:"prop",attrs:{options:[{label:"发起时间",value:"createTime"},{label:"工单名称",value:"name"}]}}],O=[{type:"InputField",title:"关键词查询",value:"",name:"name",attrs:{placeholder:"搜索关键词"}},{type:"RadioField",title:"工单状态",value:"-1",name:"status",attrs:{options:Q(E)}},{type:"CheckboxField",title:"工单类型",value:[],name:"type",attrs:{options:Q(G)}}];return k({showFilter:r}),(o,e)=>{const u=Ie,m=je,D=we,z=ee,H=Oe,K=xe,J=$e,le=De,re=Ve,ie=Le,ce=Me,ue=Te,_e=ve("waves");return l(),j("div",qe,[["Search"].includes(d.type)?(l(),_(u,{key:0,modelValue:s(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>s(p).name=t),shape:"round",placeholder:"搜索关键词","show-action":!0,onKeydown:A},{action:a(()=>[v("div",{class:"st-color-blue",onClick:w},"搜索")]),_:1},8,["modelValue"])):L("",!0),["Filter"].includes(d.type)?(l(),_(D,{key:1,show:s(r),"onUpdate:show":e[2]||(e[2]=t=>I(r)?r.value=t:null),position:"right",closeable:!1,"close-on-popstate":"",style:{width:"85%",height:"100%"}},{default:a(()=>[n(m,{ref_key:"filterSearchRef",ref:F,"show-header":"","form-items":O,onConfirm:R,onClose:e[1]||(e[1]=t=>r.value=!1)},null,512)]),_:1},8,["show"])):L("",!0),["SearchFilter"].includes(d.type)?(l(),_(le,{key:2,class:"filter-wrap",type:"flex",align:"center",justify:"space-bettwen"},{default:a(()=>[n(H,{span:"20"},{default:a(()=>[n(u,{modelValue:s(p).name,"onUpdate:modelValue":e[3]||(e[3]=t=>s(p).name=t),style:{width:"100%"},shape:"round",placeholder:"搜索关键词","show-action":"",onKeydown:A},{action:a(()=>[n(z,{name:"search",class:"search-btn",onClick:w})]),_:1},8,["modelValue"])]),_:1}),n(H,{span:"4"},{default:a(()=>[n(J,{ref_key:"menuRef",ref:S,class:"filter-menu","close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(K,{ref:"filterRef",title:"筛选",onClosed:q,onOpened:N},{default:a(()=>[n(m,{ref_key:"filterSearchRef",ref:F,"form-items":["SearchFilter"].includes(d.type)?O.slice(1):O,onConfirm:e[4]||(e[4]=t=>R(t,"filter"))},null,8,["form-items"])]),_:1},512)]),_:1},512)]),_:1})]),_:1})):L("",!0),["SortFilter"].includes(d.type)?(l(),_(J,{key:3,ref_key:"menuRef",ref:S,"close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(K,{title:"排序",onClosed:q,onOpened:N},{default:a(()=>[n(m,{ref_key:"filterSearchRef",ref:F,"form-items":ae,onConfirm:e[5]||(e[5]=t=>R(t,"sort"))},null,512)]),_:1}),n(K,{ref:"filterRef",title:"筛选",onClosed:q,onOpened:N},{default:a(()=>[n(m,{ref_key:"filterSearchRef",ref:F,"form-items":O,onConfirm:e[6]||(e[6]=t=>R(t,"filter"))},null,512)]),_:1},512)]),_:1},512)):L("",!0),n(ue,{modelValue:s(c),"onUpdate:modelValue":e[8]||(e[8]=t=>I(c)?c.value=t:null),onRefresh:V},{default:a(()=>[n(ie,{loading:s(h),"onUpdate:loading":e[7]||(e[7]=t=>I(h)?h.value=t:null),"immediate-check":!1,finished:s(g),"finished-text":s(C),onLoad:$},{default:a(()=>[v("ul",ze,[(l(!0),j(Z,null,Y(s(y),(t,pe)=>ye((l(),j("li",{key:t.name+pe,class:"list-item st-shadow",onClick:rt=>oe(t)},[v("div",null,[v("p",Pe,[P(T(t.name)+" ",1),n(re,{plain:"",color:s(se).get(t.type)},{default:a(()=>[P(T(s(G).get(t.type)),1)]),_:2},1032,["color"])]),v("p",Ae,"发起时间："+T(t.createTime),1),v("p",Ee,"处理人员："+T(t.handlingUsers),1)]),v("div",{class:"item-status",style:he({color:s(ne).get(t.status)})},T(s(E).get(t.status)),5)],8,Ke)),[[_e]])),128))])]),_:1},8,["loading","finished","finished-text"]),!s(y).length&&!s(h)?(l(),_(ce,{key:0})):L("",!0)]),_:1},8,["modelValue"])])}}}),U=te(He,[["__scopeId","data-v-68e7d1b3"]]),Je=x({name:"Search"}),Qe=Object.assign(Je,{setup(d){const k=i(null);return(f,r)=>(l(),_(U,{ref_key:"listRef",ref:k,type:"Search"},null,512))}}),We=x({name:"Filter"}),Xe=Object.assign(We,{setup(d){return(k,f)=>(l(),_(U,{type:"Filter"}))}}),Ze=x({name:"SearchFilter"}),Ye=Object.assign(Ze,{setup(d){return(k,f)=>(l(),_(U,{type:"SearchFilter"}))}}),et=x({name:"SortFilter"}),tt=Object.assign(et,{setup(d){return(k,f)=>(l(),_(U,{type:"SortFilter"}))}});const ot={class:"st-color-blue st-font-14"},nt={class:"content"},st={class:"add-btn"},at=x({name:"ListDemo"}),lt=Object.assign(at,{setup(d){const k={Search:Qe,Filter:Xe,SearchFilter:Ye,SortFilter:tt},f=i(null),r=i("Search"),b=i([{title:"只有搜索",id:"Search"},{title:"只有筛选",id:"Filter"},{title:"搜索筛选",id:"SearchFilter"},{title:"排序筛选",id:"SortFilter"}]),B=h=>{var c,C;console.log("name:",h),console.log("compRef:",f.value),(C=(c=f.menuRef)==null?void 0:c.close)==null||C.call(c);const g=document.querySelector(".layout__body");g&&g.classList.remove("van-overflow-hidden")},M=W(()=>k[r.value]),y=()=>{switch(console.log("onClickRight:",f.value),r.value){case"Filter":X.emit("show-filter");break}};return(h,g)=>{const c=ee,C=Re,S=Ue,F=Be,p=Ne,R=Fe("router-link"),$=de;return l(),_($,{class:"work-order-list"},{header:a(()=>[n(C,{border:"",title:"工单列表",onClick:y},Se({_:2},[["Filter"].includes(s(r))?{name:"right",fn:a(()=>[v("span",ot,[n(c,{name:"filter-o",class:"st-font-16"}),P(" 筛选 ")])]),key:"0"}:void 0]),1024)]),default:a(()=>[n(p,{"offset-top":0,"z-index":999},{default:a(()=>[n(F,{active:s(r),"onUpdate:active":g[0]||(g[0]=w=>I(r)?r.value=w:null),border:"",onChange:B},{default:a(()=>[(l(!0),j(Z,null,Y(s(b),w=>(l(),_(S,{key:w.id,title:w.title,name:w.id},null,8,["title","name"]))),128))]),_:1},8,["active"])]),_:1}),v("main",nt,[(l(),_(be,{include:[]},[(l(),_(Ce(s(M)),{ref_key:"compRef",ref:f},null,512))],1024))]),v("div",st,[n(R,{to:"/list-create"},{default:a(()=>[n(c,{name:"plus"})]),_:1})])]),_:1})}}}),Vt=te(lt,[["__scopeId","data-v-3b433d7a"]]);export{Vt as default};
