import{d as N,n as R,a as m,i as Q,o as B,C as L,f as u,m as h,b as n,D as M,E as U,F as z,G,H,I as _,g as x,J,_ as W}from"./index-16d4a745.js";import{Q as q}from"./question-filled-00b6e9f5.js";function K(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!J(l)}const X={"el-select":"el-option","el-radio-group":"el-radio","el-checkbox-group":"el-checkbox"},Y=["el-checkbox-group"],Z=N({name:"ProForm",inheritAttrs:!1,components:{QuestionFilled:q},emits:["update:modelValue","update:api","change","submit","reset"],props:{api:{type:Object,default:()=>({})},modelValue:{type:Object,default:()=>({})},formOptions:{type:Object,default:()=>({})},rowOptions:{type:Object,default:()=>({})},colCount:{type:[Number,String],default:1,validator:l=>[1,2,3,4,6,8,12,24].includes(+l)},isQuery:{type:Boolean,default:!1},expand:{type:Boolean,default:!1},showActions:Boolean,formItems:{type:Array,default:()=>[]}},setup(l,{emit:c,slots:r}){const C=M(),O=R(()=>Object.keys(l.formItems).length>0),b=Object.assign({labelPosition:"right",labelWidth:"120px",disabled:!1,size:void 0,"scroll-to-error":!0},l.formOptions),V={gutter:16,type:"flex",align:"middle",...l.rowOptions},y=e=>{const a={},o=t=>{let d="";return U(t.value)?Y.includes(t.type)?d=[]:d="":d=t.value,d};return l.formItems.forEach(t=>{t.prop&&(a[t.prop]=o(t))}),{...a,...l.modelValue}},i=m(),F=m({}),s=m(y()),k=e=>e?X[e]:!1;Q(()=>s,e=>{c("update:modelValue",e)},{deep:!0,immediate:!1}),B(()=>{I(),c("update:modelValue",s.value)});const I=async()=>{await L();const e={...i.value,...C,initFormModel:y};c("update:api",e)},P=async()=>{var e;await((e=i.value)==null?void 0:e.validate((a,o)=>{c("submit",{valid:a,fields:o,form:s.value,api:l.api})}))},j=()=>{var e;(e=i.value)==null||e.resetFields(),c("reset")},A=e=>{const a={};return e.labelRender&&(a.label=o=>S(o,e)),a},S=(e,a)=>a.labelRender(e),w=(e,a)=>{s.value[a]=e,c("change",{value:e,props:l}),c("update:modelValue",s.value)},T=e=>{let a;const o=["el-input","el-textarea","el-input-number","el-autocomplete"],t=["el-select","el-select-v2","el-tree-select","el-cascader","el-time-select","el-date-picker"];return o.includes(e.type)?a="请输入"+e.label:t.includes(e.type)?a="请选择"+e.label:a="请填写"+e.label,a},D=e=>{const a=e.attrs??{};return{placeholder:T(e),...a}},E=()=>{const e=l.formItems.length;return+l.colCount>e?24/(e<4?4:e):24/+l.colCount};return()=>{let e;return O.value&&u(n("el-form"),h({ref:i,class:"proForm",model:s.value,rules:F.value},b),{default:()=>{var a,o;return[b.inline?u(z,null,null):u(n("el-row"),V,K(e=l.formItems.map((t,d)=>{var v;return G(u(n("el-col"),h({key:t.prop},{...t.col,span:((v=t.col)==null?void 0:v.span)??E()}),{default:()=>[u(n("el-form-item"),t,{default:()=>{var g;return[t.type==="el-text"?u(n("el-text"),t.attrs,{default:()=>[t.value]}):t.type==="slot"?(g=r[t.slotName])==null?void 0:g.call(r,t||{}):_(n(t.type),{...D(t),modelValue:s.value[t.prop],"onUpdate:modelValue":f=>w(f,t.prop)},t.options?()=>{var f;return(f=t.options)==null?void 0:f.map(p=>_(n(p.optionsType||k(t.type)),{...p,key:t.label},{default:()=>p.text}))}:null)]},...A(t)})]}),[[H,l.isQuery?l.expand||d<l.colCount:!0]])}))?e:{default:()=>[e]}),(a=r.actions)!=null&&a.call(r)?(o=r.actions)==null?void 0:o.call(r,{form:s.value}):l.showActions?u(n("el-form-item"),null,{default:()=>[u(n("el-button"),{type:"primary",onClick:P},{default:()=>[x("提 交")]}),u(n("el-button"),{onClick:j},{default:()=>[x("重 置")]})]}):null]}})}}});const te=W(Z,[["__scopeId","data-v-104284e9"]]);export{te as P};
