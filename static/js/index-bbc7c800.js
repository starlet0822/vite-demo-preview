import{_ as de}from"./index-8e02e1d8.js";import{d as x,U as me,a as u,c as Q,o as fe,Z as W,O as ve,M as ye,f as l,k as j,g as _,q as a,x as y,u as s,s as $,p as n,J as D,F as X,G as Z,v as he,I as K,y as L,A as ge,_ as ke,X as we,$ as be,P as Y,a0 as Se,S as Ce,i as Fe,H as xe}from"./index-997c5456.js";/* empty css              */import{_ as Re}from"./index-5bc8261e.js";import{D as $e,a as Le,L as Te,P as Me}from"./index-51484da6.js";import{_ as Oe}from"./index-0710438f.js";import{T as Ve}from"./index-febcd1c6.js";import{C as je,R as De}from"./index-595af217.js";import"./index-8bdc444d.js";import{_ as Be}from"./index-d72ec0a2.js";import"./index-f81a7d39.js";import{S as Ie}from"./index-393bf929.js";import{g as J}from"./dict-ce3ac239.js";import{_ as ee}from"./plugin-vue_export-helper-c27b6911.js";import{T as Ue,a as Ne,S as qe}from"./index-6c94c835.js";import"./index-9331bd7f.js";import"./use-placeholder-a07c7adc.js";import"./use-route-cd4906df.js";import"./use-id-f342ab22.js";import"./index-2bb34be1.js";import"./use-sync-prop-ref-29014923.js";import"./index-cc455c63.js";import"./utils-ad3469bd.js";import"./index-ddbcc10d.js";const ze={class:"mock-list"},Ke={class:"list-wrapper"},Pe=["onClick"],Ae={class:"item-name"},Ee={class:"item-time"},Ge={class:"item-user"},He=x({name:"MockList"}),Je=Object.assign(He,{props:{type:{type:String,default:"Search"}},setup(d,{expose:w}){const m=me(),r=u(!1),S=u(1),I=u(20),T=u(0),h=u([]),g=u(!0),k=u(!1),i=u(!1),C=Q(()=>h.value.length?"没有更多了":""),b=u(null),p=u({order:"asc",prop:"createTime"}),F=(o,e)=>{var c,v;console.log("query:",o),p.value={...p.value,...o},r.value=!1,(v=(c=b.value)==null?void 0:c.close)==null||v.call(c),f()},R=async()=>{var o,e;try{i.value&&(h.value=[],i.value=!1);const c={pageNo:S.value,pageSize:I.value,...p.value,type:(o=p.value.type)!=null&&o.length?(e=p.value.type)==null?void 0:e.join(","):""},v=await ke.getWorkOrderList(c);if(v.code===0){S.value+=1;const{rows:V,total:q}=v.data??{};T.value=q,h.value=S.value===1?V:h.value.concat(V),h.value.length>=T.value&&(k.value=!0)}}catch(c){console.error("捕获异常",c)}finally{g.value=!1}},M=()=>{var o,e;r.value=!1,(e=(o=b.value)==null?void 0:o.close)==null||e.call(o),f()},f=()=>{i.value=!0,k.value=!1,g.value=!0,S.value=1,R()},U=()=>{const o=document.querySelector(".layout__body");o&&o.classList.add("van-overflow-hidden")},N=()=>{const o=document.querySelector(".layout__body");o&&o.classList.remove("van-overflow-hidden")},P=o=>{var e,c;console.log("onEnter:",o),o.keyCode===13&&((c=(e=b.value).close)==null||c.call(e),f())},te=o=>{m.push({path:"/list-detail",query:{...we(o,["id","name"])}})};fe(()=>{R(),W.on("show-filter",()=>{r.value=!0})});const A=new Map([["-1","全部"],["0","处理中"],["1","已完结"],["2","被退回"]]),oe=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),E=new Map([["0","普通"],["1","售后"],["2","维修"]]),ne=new Map([["0","#2e6cf3"],["1","#ff0000"],["2","#05a081"]]),se=[{type:"CellField",title:"排序方式",value:"asc",name:"order",attrs:{options:[{label:"升序排序",value:"asc"},{label:"倒序排序",value:"desc"}]}},{type:"CellField",title:"排序字段",value:"createTime",name:"prop",attrs:{options:[{label:"发起时间",value:"createTime"},{label:"工单名称",value:"name"}]}}],ae=ve("2003-10-08 08:43").isBefore("2003-10-08 08:43","m");console.log("flag:",ae);const O=[{type:"InputField",title:"关键词查询",value:"",name:"name",attrs:{placeholder:"搜索关键词"}},{type:"RadioField",title:"工单状态",value:"-1",name:"status",attrs:{options:J(A)}},{type:"CheckboxField",title:"工单类型（可多选）",value:[],name:"type",attrs:{options:J(E)}}];return w({showFilter:r}),(o,e)=>{const c=Ie,v=Be,V=be,q=Y,G=je,z=$e,H=Le,le=De,re=Ve,ie=Te,ce=Oe,ue=Me,_e=ye("waves");return l(),j("div",ze,[["Search"].includes(d.type)?(l(),_(c,{key:0,modelValue:s(p).name,"onUpdate:modelValue":e[0]||(e[0]=t=>s(p).name=t),shape:"round",placeholder:"搜索关键词","show-action":!0,onKeydown:P},{action:a(()=>[y("div",{class:"st-color-blue",onClick:M},"搜索")]),_:1},8,["modelValue"])):$("",!0),["Filter"].includes(d.type)?(l(),_(V,{key:1,show:s(r),"onUpdate:show":e[1]||(e[1]=t=>D(r)?r.value=t:null),position:"right",closeable:!1,"close-on-popstate":"",style:{width:"85%",height:"100%"}},{default:a(()=>[n(v,{"show-header":"","form-items":O,onConfirm:F})]),_:1},8,["show"])):$("",!0),["SearchFilter"].includes(d.type)?(l(),_(le,{key:2,class:"filter-wrap",type:"flex",align:"center",justify:"space-bettwen"},{default:a(()=>[n(G,{span:"20"},{default:a(()=>[n(c,{modelValue:s(p).name,"onUpdate:modelValue":e[2]||(e[2]=t=>s(p).name=t),style:{width:"100%"},shape:"round",placeholder:"搜索关键词","show-action":"",onKeydown:P},{action:a(()=>[n(q,{name:"search",class:"search-btn",onClick:M})]),_:1},8,["modelValue"])]),_:1}),n(G,{span:"4"},{default:a(()=>[n(H,{ref_key:"menuRef",ref:b,class:"filter-menu","close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(z,{ref:"filterRef",title:"筛选",onClosed:N,onOpened:U},{default:a(()=>[n(v,{"form-items":["SearchFilter"].includes(d.type)?O.slice(1):O,onConfirm:e[3]||(e[3]=t=>F(t,"filter"))},null,8,["form-items"])]),_:1},512)]),_:1},512)]),_:1})]),_:1})):$("",!0),["SortFilter"].includes(d.type)?(l(),_(H,{key:3,ref_key:"menuRef",ref:b,"close-on-click-outside":!1,"close-on-click-overlay":!1},{default:a(()=>[n(z,{title:"排序",onClosed:N,onOpened:U},{default:a(()=>[n(v,{"form-items":se,onConfirm:e[4]||(e[4]=t=>F(t,"sort"))})]),_:1}),n(z,{ref:"filterRef",title:"筛选",onClosed:N,onOpened:U},{default:a(()=>[n(v,{"form-items":O,onConfirm:e[5]||(e[5]=t=>F(t,"filter"))})]),_:1},512)]),_:1},512)):$("",!0),n(ue,{modelValue:s(i),"onUpdate:modelValue":e[7]||(e[7]=t=>D(i)?i.value=t:null),onRefresh:f},{default:a(()=>[n(ie,{loading:s(g),"onUpdate:loading":e[6]||(e[6]=t=>D(g)?g.value=t:null),"immediate-check":!1,finished:s(k),"finished-text":s(C),onLoad:R},{default:a(()=>[y("ul",Ke,[(l(!0),j(X,null,Z(s(h),(t,pe)=>he((l(),j("li",{key:t.name+pe,class:"list-item st-shadow",onClick:it=>te(t)},[y("div",null,[y("p",Ae,[K(L(t.name)+" ",1),n(re,{plain:"",color:s(ne).get(t.type)},{default:a(()=>[K(L(s(E).get(t.type)),1)]),_:2},1032,["color"])]),y("p",Ee,"发起时间："+L(t.createTime),1),y("p",Ge,"处理人员："+L(t.handlingUsers),1)]),y("div",{class:"item-status",style:ge({color:s(oe).get(t.status)})},L(s(A).get(t.status)),5)],8,Pe)),[[_e]])),128))])]),_:1},8,["loading","finished","finished-text"]),!s(h).length&&!s(g)?(l(),_(ce,{key:0})):$("",!0)]),_:1},8,["modelValue"])])}}}),B=ee(Je,[["__scopeId","data-v-376c6b6b"]]),Qe=x({name:"Search"}),We=Object.assign(Qe,{setup(d){const w=u(null);return(m,r)=>(l(),_(B,{ref_key:"listRef",ref:w,type:"Search"},null,512))}}),Xe=x({name:"Filter"}),Ze=Object.assign(Xe,{setup(d){return(w,m)=>(l(),_(B,{type:"Filter"}))}}),Ye=x({name:"SearchFilter"}),et=Object.assign(Ye,{setup(d){return(w,m)=>(l(),_(B,{type:"SearchFilter"}))}}),tt=x({name:"SortFilter"}),ot=Object.assign(tt,{setup(d){return(w,m)=>(l(),_(B,{type:"SortFilter"}))}});const nt={class:"st-color-blue st-font-14"},st={class:"content"},at={class:"add-btn"},lt=x({name:"ListDemo"}),rt=Object.assign(lt,{setup(d){const w={Search:We,Filter:Ze,SearchFilter:et,SortFilter:ot},m=u(null),r=u("Search"),S=u([{title:"只有搜索",id:"Search"},{title:"只有筛选",id:"Filter"},{title:"搜索筛选",id:"SearchFilter"},{title:"排序筛选",id:"SortFilter"}]),I=g=>{var i,C;console.log("name:",g),console.log("compRef:",m.value),(C=(i=m.menuRef)==null?void 0:i.close)==null||C.call(i);const k=document.querySelector(".layout__body");k&&k.classList.remove("van-overflow-hidden")},T=Q(()=>w[r.value]),h=()=>{switch(console.log("onClickRight:",m.value),r.value){case"Filter":W.emit("show-filter");break}};return(g,k)=>{const i=Y,C=Re,b=Ue,p=Ne,F=qe,R=xe("router-link"),M=de;return l(),_(M,{class:"work-order-list"},{header:a(()=>[n(C,{border:"",title:"工单列表",onClick:h},Se({_:2},[["Filter"].includes(s(r))?{name:"right",fn:a(()=>[y("span",nt,[n(i,{name:"filter-o",class:"st-font-16"}),K(" 筛选 ")])]),key:"0"}:void 0]),1024)]),default:a(()=>[n(F,{"offset-top":0,"z-index":999},{default:a(()=>[n(p,{active:s(r),"onUpdate:active":k[0]||(k[0]=f=>D(r)?r.value=f:null),border:"",onChange:I},{default:a(()=>[(l(!0),j(X,null,Z(s(S),f=>(l(),_(b,{key:f.id,title:f.title,name:f.id},null,8,["title","name"]))),128))]),_:1},8,["active"])]),_:1}),y("main",st,[(l(),_(Ce,{include:[]},[(l(),_(Fe(s(T)),{ref_key:"compRef",ref:m},null,512))],1024))]),y("div",at,[n(R,{to:"/list-create"},{default:a(()=>[n(i,{name:"plus"})]),_:1})])]),_:1})}}}),Vt=ee(rt,[["__scopeId","data-v-3b433d7a"]]);export{Vt as default};
