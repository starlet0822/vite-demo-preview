var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,n=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(o)for(var a of o(t))r.call(t,a)&&l(e,a,t[a]);return e},i=(e,t,a)=>new Promise(((o,s)=>{var r=e=>{try{n(a.next(e))}catch(t){s(t)}},l=e=>{try{n(a.throw(e))}catch(t){s(t)}},n=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,l);n((a=a.apply(e,t)).next())}));import{m as d,R as c,v as u,U as p,w as f,h as m,p as g,c as v,s as y}from"./vant-be38094f.js";import{J as b}from"./jsbarcode-552f7d17.js";import{m as j,r as h,b as w,aI as x,ai as O,aQ as C,c as _,w as S,ak as k,aj as P,a4 as R,u as E,n as L,l as D,b7 as q,f as T,v as U,F as I,aN as V,aK as z,aJ as N,al as Q,C as A}from"./@vue-0da0c2e3.js";import{b as F}from"./qrcode-a2a635fd.js";import{b as H,i as B}from"./lodash-es-0ddda1ab.js";import{_ as J}from"./index-ddfd11f6.js";import"./@zxing-5197659b.js";import{H as M}from"./html5-qrcode-50956d7f.js";import{a as Y}from"./file-d5e0f662.js";import{_ as $}from"./plugin-vue_export-helper-893979e1.js";import"./@vant-b0725c78.js";import"./encode-utf8-5218539d.js";import"./dijkstrajs-6deee4e3.js";import"./vue-router-1cbad9b8.js";import"./ts-custom-error-0a9e0592.js";import"./@antv-74afab59.js";import"./tslib-546db90a.js";import"./fecha-2b185e5a.js";const K=j({name:"BarcodeCreate"}),G=Object.assign(K,{props:{tag:{type:String,default:"canvas"},text:{type:String,default:null},options:{type:Object,default:()=>({})},type:{type:String,default:"CODE128"}},setup(e){const o=e,s=h(null);return w((()=>{const e=(r=n({},o.options),l={format:o.type},t(r,a(l)));var r,l;b(s.value,o.text,e)})),(t,a)=>(x(),O(C(e.tag),{ref_key:"wrapEl",ref:s},null,512))}}),W=j({name:"QRCodeCreate"}),X=Object.assign(W,{props:{tag:{type:String,default:"canvas"},text:{type:[String,Array],default:null},options:{type:Object,default:()=>({})},width:{type:[Number,String],default:100},logo:{type:[String,Object],default:()=>""}},emits:["done","click","disabled-click"],setup(e,{emit:t}){const a=e,{toCanvas:o,toDataURL:s}=F,r=h(!0),l=h(null),d=_((()=>String(a.text))),c=_((()=>({width:a.width+"px",height:a.width+"px"}))),u=()=>i(this,null,(function*(){yield L();const e=H(a.options||{});if("canvas"===a.tag){e.errorCorrectionLevel=e.errorCorrectionLevel||g(E(d));const s=yield m(E(d),e);e.scale=0===a.width?void 0:a.width/s*4;const n=yield o(E(l),E(d),e);if(a.logo){const e=yield p(n);t("done",e),r.value=!1}else t("done",n.toDataURL()),r.value=!1}else{const o=yield s(d.value,n({errorCorrectionLevel:"H",width:a.width},e));E(l).src=o,t("done",o),r.value=!1}}));S((()=>d.value),(e=>{e&&u()}),{deep:!0,immediate:!0});const p=e=>{const t=e.width,o=Object.assign({logoSize:.15,bgColor:"#ffffff",borderSize:.05,crossOrigin:"anonymous",borderRadius:8,logoRadius:0},B(a.logo)?{}:a.logo),{logoSize:s=.15,bgColor:r="#ffffff",borderSize:l=.05,crossOrigin:n="anonymous",borderRadius:i=8,logoRadius:d=0}=o,c=B(a.logo)?a.logo:a.logo.src,u=t*s,p=t*(1-s)/2,m=t*(s+l),g=t*(1-s-l)/2,v=e.getContext("2d");if(!v)return;f(v)(g,g,m,m,i),v.fillStyle=r,v.fill();const y=new Image;(n||d)&&y.setAttribute("crossOrigin",n),y.src=c;return new Promise((t=>{y.onload=()=>{var a;d?(e=>{const t=document.createElement("canvas");t.width=p+u,t.height=p+u;const a=t.getContext("2d");if(!a||!v)return;if(a.drawImage(e,p,p,u,u),f(v)(p,p,u,u,d),!v)return;const o=v.createPattern(t,"no-repeat");o&&(v.fillStyle=o,v.fill())})(y):(a=y,v.drawImage(a,p,p,u,u)),t(e.toDataURL())}}))},f=e=>(t,a,o,s,r)=>{const l=Math.min(o,s);return r>l/2&&(r=l/2),e.beginPath(),e.moveTo(t+r,a),e.arcTo(t+o,a,t+o,a+s,r),e.arcTo(t+o,a+s,t,a+s,r),e.arcTo(t,a+s,t,a,r),e.arcTo(t,a,t+o,a,r),e.closePath(),e},m=(e,t)=>i(this,null,(function*(){const a=document.createElement("canvas");return yield o(a,e,t),a.width})),g=e=>e.length>36?"M":e.length>16?"Q":"H";return(t,a)=>(x(),k("div",{class:"qrcode",style:R(E(c))},["canvas"===e.tag?(x(),k("canvas",{key:0,ref_key:"wrapRef",ref:l},null,512)):P("",!0),"img"===e.tag?(x(),k("img",{key:1,ref_key:"wrapRef",ref:l},null,512)):P("",!0)],4))}});const Z=e=>(z("data-v-37308eed"),e=e(),N(),e),ee={class:"qrcode-and-barcode-demo"},te=Z((()=>Q("div",{class:"desc"},"canvas生成",-1))),ae=Z((()=>Q("div",{class:"desc"},"自定义样式生成",-1))),oe=Z((()=>Q("div",{class:"desc"},"img生成",-1))),se=Z((()=>Q("div",{id:"reader"},null,-1))),re=j({name:"QrcodeAndBarcode"});var le=$(Object.assign(re,{setup(e){const t=h(["1","2","3"]),a=h([]),o=".png,.jpg,.jpeg",s=e=>!!/image\/(png|jpg|jpeg)$/.test(e.type)||(m(`请上传 ${o} 格式图片`),!1),r=e=>{i(e.file)},l=[{tag:"canvas",text:"CODE128 TYPE",type:"CODE128",options:{}},{tag:"img",text:"CODE39 TYPE",type:"CODE39",options:{lineColor:"#2e6cf3"}}],n=e=>{const t=e.target;i(t)},i=e=>{g({message:"识别中..."});const t=new M("reader");let a=null,o=null;e instanceof File?o=e:("canvas"===e.tagName.toLocaleLowerCase()&&(a=e.toDataURL(),o=Y(a)),"img"===e.tagName.toLocaleLowerCase()&&(a=e.src,o=Y(a))),t.scanFile(o,!1).then((e=>{v(),y({type:"success",message:"识别结果为："+e,position:"bottom"})})).catch((e=>{v(),y({type:"danger",message:"识别失败",position:"bottom"})}))};return(e,i)=>{const m=J,g=X,v=d,y=c,b=u,j=G,h=p,w=f,C=A("press");return x(),k("div",ee,[D(m),D(w,{modelValue:E(t),"onUpdate:modelValue":i[1]||(i[1]=e=>T(t)?t.value=e:null)},{default:q((()=>[D(b,{title:"二维码（长按可以识别哦~）",name:"1"},{default:q((()=>[D(y,{type:"flex",gutter:10,class:"qrcode-box"},{default:q((()=>[D(v,{class:"qrcode-item"},{default:q((()=>[U(D(g,{text:"我是canvas生成的二维码"},null,512),[[C,n]]),te])),_:1}),(x(),O(v,{key:0,class:"qrcode-item"},{default:q((()=>[U(D(g,{id:"img-qrcode",text:"我是有样式的二维码",tag:"img",options:{color:{dark:"#2e6cf3"}}},null,512),[[C,n]]),ae])),_:1})),D(v,{class:"qrcode-item"},{default:q((()=>[U(D(g,{tag:"img",text:"我是img生成的二维码"},null,512),[[C,n]]),oe])),_:1})])),_:1})])),_:1}),D(b,{title:"条形码（长按可以识别哦~）",name:"2"},{default:q((()=>[D(y,{type:"flex",gutter:10},{default:q((()=>[(x(),k(I,null,V(l,((e,t)=>D(v,{key:t,span:24},{default:q((()=>[U(D(j,{tag:e.tag,text:e.text,type:e.type,options:e.options},null,8,["tag","text","type","options"]),[[C,n]])])),_:2},1024))),64))])),_:1})])),_:1}),(x(),O(b,{key:0,title:"上传(二维码/条形码)图片识别",name:"3"},{default:q((()=>[D(h,{modelValue:E(a),"onUpdate:modelValue":i[0]||(i[0]=e=>T(a)?a.value=e:null),"max-count":"1",accept:o,"before-read":s,"after-read":r},null,8,["modelValue"])])),_:1}))])),_:1},8,["modelValue"]),se])}}}),[["__scopeId","data-v-37308eed"]]);export{le as default};
