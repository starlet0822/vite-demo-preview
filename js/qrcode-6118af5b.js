var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,i=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&n(e,a,t[a]);if(o)for(var a of o(t))r.call(t,a)&&n(e,a,t[a]);return e},l=(e,t,a)=>new Promise(((o,s)=>{var r=e=>{try{i(a.next(e))}catch(t){s(t)}},n=e=>{try{i(a.throw(e))}catch(t){s(t)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,n);i((a=a.apply(e,t)).next())}));import{f as c,R as d,u as p,U as m,v as u,s as f,o as g,c as b,b as j}from"./vant-7136ba84.js";import{J as v}from"./jsbarcode-552f7d17.js";import{l as y,r as h,b as w,s as x,v as O,z as C,c as _,w as S,B as P,F as R,K as k,u as D,n as E,D as L,E as q,f as U,G as z,M as T,N as I,aR as V,aQ as A,H as F,S as H}from"./@vue-52de1c01.js";import{b as N}from"./qrcode-a2a635fd.js";import{_ as Q,t as $}from"./index-3157abda.js";import{d as B,i as M}from"./lodash-es-c547d601.js";import"./@zxing-356c997e.js";import{H as Y}from"./html5-qrcode-b080f6dc.js";import"./js-cookie-aaf6027b.js";import"./@vant-0004063d.js";import"./encode-utf8-5218539d.js";import"./dijkstrajs-6deee4e3.js";/* empty css                      */import"./amfe-flexible-385c80ea.js";import"./vue-router-a4543dac.js";import"./vuex-c830e64e.js";import"./@vueuse-feee2333.js";import"./axios-0cd4f164.js";import"./qs-6446231f.js";import"./side-channel-b2edb420.js";import"./get-intrinsic-8aab7bd3.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-b7e23f7e.js";import"./object-inspect-8ed24658.js";import"./@antv-8a75d63c.js";import"./tslib-546db90a.js";import"./fecha-2b185e5a.js";import"./nprogress-319be66c.js";import"./vue3-hash-calendar-68956731.js";import"./hammerjs-ed6f6a9e.js";import"./ts-custom-error-0a9e0592.js";function G(e,t=Date.now()){const a=e.split(","),o=a[0].match(/:(.*?);/)[1],s=o.split("/")[1],r=window.atob(a[1]);let n=r.length;const i=new Uint8Array(n);for(;n--;)i[n]=r.charCodeAt(n);return new File([i],`${t}.${s}`,{type:o})}const J=y({name:"BarcodeCreate"}),K=Object.assign(J,{props:{tag:{type:String,default:"canvas"},text:{type:String,default:null},options:{type:Object,default:()=>({})},type:{type:String,default:"CODE128"}},setup(e){const o=e,s=h(null);return w((()=>{const e=(r=i({},o.options),n={format:o.type},t(r,a(n)));var r,n;v(s.value,o.text,e)})),(t,a)=>(x(),O(C(e.tag),{ref_key:"wrapEl",ref:s},null,512))}});const W=y({name:"QRCodeCreate"});var X=Q(Object.assign(W,{props:{tag:{type:String,default:"canvas"},text:{type:[String,Array],default:null},options:{type:Object,default:()=>({})},width:{type:[Number,String],default:100},logo:{type:[String,Object],default:()=>""}},emits:["done","click","disabled-click"],setup(e,{emit:t}){const a=e,{toCanvas:o,toDataURL:s}=N,r=h(!0),n=h(null),c=_((()=>String(a.text))),d=_((()=>({width:a.width+"px",height:a.width+"px"}))),p=()=>l(this,null,(function*(){yield E();const e=B(a.options||{});if("canvas"===a.tag){e.errorCorrectionLevel=e.errorCorrectionLevel||g(D(c));const s=yield f(D(c),e);e.scale=0===a.width?void 0:a.width/s*4;const i=yield o(D(n),D(c),e);if(a.logo){const e=yield m(i);t("done",e),r.value=!1}else t("done",i.toDataURL()),r.value=!1}else{const o=yield s(c.value,i({errorCorrectionLevel:"H",width:a.width},e));D(n).src=o,t("done",o),r.value=!1}}));S((()=>c.value),(e=>{e&&p()}),{deep:!0,immediate:!0});const m=e=>{const t=e.width,o=Object.assign({logoSize:.15,bgColor:"#ffffff",borderSize:.05,crossOrigin:"anonymous",borderRadius:8,logoRadius:0},M(a.logo)?{}:a.logo),{logoSize:s=.15,bgColor:r="#ffffff",borderSize:n=.05,crossOrigin:i="anonymous",borderRadius:l=8,logoRadius:c=0}=o,d=M(a.logo)?a.logo:a.logo.src,p=t*s,m=t*(1-s)/2,f=t*(s+n),g=t*(1-s-n)/2,b=e.getContext("2d");if(!b)return;u(b)(g,g,f,f,l),b.fillStyle=r,b.fill();const j=new Image;(i||c)&&j.setAttribute("crossOrigin",i),j.src=d;return new Promise((t=>{j.onload=()=>{var a;c?(e=>{const t=document.createElement("canvas");t.width=m+p,t.height=m+p;const a=t.getContext("2d");if(!a||!b)return;if(a.drawImage(e,m,m,p,p),u(b)(m,m,p,p,c),!b)return;const o=b.createPattern(t,"no-repeat");o&&(b.fillStyle=o,b.fill())})(j):(a=j,b.drawImage(a,m,m,p,p)),t(e.toDataURL())}}))},u=e=>(t,a,o,s,r)=>{const n=Math.min(o,s);return r>n/2&&(r=n/2),e.beginPath(),e.moveTo(t+r,a),e.arcTo(t+o,a,t+o,a+s,r),e.arcTo(t+o,a+s,t,a+s,r),e.arcTo(t,a+s,t,a,r),e.arcTo(t,a,t+o,a,r),e.closePath(),e},f=(e,t)=>l(this,null,(function*(){const a=document.createElement("canvas");return yield o(a,e,t),a.width})),g=e=>e.length>36?"M":e.length>16?"Q":"H";return(t,a)=>(x(),P("div",{class:"qrcode",style:k(D(d))},["canvas"===e.tag?(x(),P("canvas",{key:0,ref_key:"wrapRef",ref:n},null,512)):R("",!0),"img"===e.tag?(x(),P("img",{key:1,ref_key:"wrapRef",ref:n},null,512)):R("",!0)],4))}}),[["__scopeId","data-v-386832c4"]]);const Z=e=>(V("data-v-648bc4e7"),e=e(),A(),e),ee={class:"page-wrapper"},te=Z((()=>F("div",{class:"desc"},"canvas生成",-1))),ae=Z((()=>F("div",{class:"desc"},"自定义样式生成",-1))),oe=Z((()=>F("div",{class:"desc"},"img生成",-1))),se=Z((()=>F("div",{id:"reader"},null,-1))),re=y({name:"QrcodeAndBarcode"});var ne=Q(Object.assign(re,{setup(e){const t=h(["1","2","3"]),a=h([]),o=".png,.jpg,.jpeg",s=e=>!!/image\/(png|jpg|jpeg)$/.test(e.type)||(f(`请上传 ${o} 格式图片`),!1),r=$,n=e=>{v(e.file)},i=[{tag:"canvas",text:"CODE128 TYPE",type:"CODE128",options:{}},{tag:"img",text:"CODE39 TYPE",type:"CODE39",options:{lineColor:r}}],l=e=>{const t=e.target;v(t)},v=e=>{g({message:"识别中..."});const t=new Y("reader");let a=null,o=null;e instanceof File?o=e:("canvas"===e.tagName.toLocaleLowerCase()&&(a=e.toDataURL(),o=G(a)),"img"===e.tagName.toLocaleLowerCase()&&(a=e.src,o=G(a))),t.scanFile(o,!1).then((e=>{b(),j({type:"success",message:"识别结果为："+e,position:"bottom"})})).catch((e=>{b(),j({type:"danger",message:"识别失败",position:"bottom"})}))};return(e,f)=>{const g=X,b=c,j=d,v=p,y=K,h=m,w=u,C=H("press");return x(),P("div",ee,[L(w,{modelValue:D(t),"onUpdate:modelValue":f[1]||(f[1]=e=>U(t)?t.value=e:null)},{default:q((()=>[L(v,{title:"二维码（长按可以识别哦~）",name:"1"},{default:q((()=>[L(j,{type:"flex",gutter:10,class:"qrcode-box"},{default:q((()=>[L(b,{class:"qrcode-item"},{default:q((()=>[z(L(g,{text:"我是canvas生成的二维码"},null,512),[[C,l]]),te])),_:1}),(x(),O(b,{key:0,class:"qrcode-item"},{default:q((()=>[z(L(g,{id:"img-qrcode",text:"我是有样式的二维码",tag:"img",options:{color:{dark:D(r)}}},null,8,["options"]),[[C,l]]),ae])),_:1})),L(b,{class:"qrcode-item"},{default:q((()=>[z(L(g,{tag:"img",text:"我是img生成的二维码"},null,512),[[C,l]]),oe])),_:1})])),_:1})])),_:1}),L(v,{title:"条形码（长按可以识别哦~）",name:"2"},{default:q((()=>[L(j,{type:"flex",gutter:10},{default:q((()=>[(x(),P(T,null,I(i,((e,t)=>L(b,{key:t,span:24},{default:q((()=>[z(L(y,{tag:e.tag,text:e.text,type:e.type,options:e.options},null,8,["tag","text","type","options"]),[[C,l]])])),_:2},1024))),64))])),_:1})])),_:1}),L(v,{title:"上传(二维码/条形码)图片识别",name:"3"},{default:q((()=>[L(h,{modelValue:D(a),"onUpdate:modelValue":f[0]||(f[0]=e=>U(a)?a.value=e:null),"max-count":"1",accept:o,"before-read":s,"after-read":n},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),se])}}}),[["__scopeId","data-v-648bc4e7"]]);export{ne as default};
