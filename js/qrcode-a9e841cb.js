var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,i=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&n(e,a,t[a]);if(o)for(var a of o(t))r.call(t,a)&&n(e,a,t[a]);return e},l=(e,t,a)=>new Promise(((o,s)=>{var r=e=>{try{i(a.next(e))}catch(t){s(t)}},n=e=>{try{i(a.throw(e))}catch(t){s(t)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,n);i((a=a.apply(e,t)).next())}));import{n as c,R as d,x as p,U as m,y as u,B as f,h as g,r as j,c as b,s as y}from"./vant-f142fa12.js";import{J as v}from"./jsbarcode-552f7d17.js";import{D as h,j as w,l as x,o as O,ao as _,aR as C,h as S,x as P,c as R,ap as k,n as D,u as E,m as L,e as q,a as U,b8 as T,s as z,w as I,F as V,b as A,aN as N,aM as F,N as $}from"./@vue-563ebafd.js";import{b as B}from"./qrcode-a2a635fd.js";import{_ as H}from"./plugin-vue_export-helper-893979e1.js";import{d as M,i as Q}from"./lodash-es-12d03b41.js";import{_ as Y}from"./index-7153c68f.js";import"./@zxing-5197659b.js";import{H as J}from"./html5-qrcode-50956d7f.js";import{t as G}from"./index-ac9d2ddd.js";import"./js-cookie-aaf6027b.js";import"./@vant-3579f7e1.js";import"./encode-utf8-5218539d.js";import"./dijkstrajs-6deee4e3.js";import"./vue-router-2cd4af54.js";import"./ts-custom-error-0a9e0592.js";import"./@antv-74afab59.js";import"./tslib-546db90a.js";import"./fecha-2b185e5a.js";/* empty css                      */import"./amfe-flexible-385c80ea.js";import"./vuex-423acd4f.js";import"./@vueuse-3d373d70.js";import"./axios-0cd4f164.js";import"./qs-efaa5365.js";import"./side-channel-ebdfdc6e.js";import"./get-intrinsic-8aab7bd3.js";import"./has-symbols-1f359e75.js";import"./function-bind-c930bb92.js";import"./has-03e8e28c.js";import"./call-bind-b7e23f7e.js";import"./object-inspect-af06f273.js";import"./nprogress-4e4fc296.js";import"./vue3-hash-calendar-edea4f58.js";import"./hammerjs-ed6f6a9e.js";function K(e,t=Date.now()){const a=e.split(","),o=a[0].match(/:(.*?);/)[1],s=o.split("/")[1],r=window.atob(a[1]);let n=r.length;const i=new Uint8Array(n);for(;n--;)i[n]=r.charCodeAt(n);return new File([i],`${t}.${s}`,{type:o})}const W=h({name:"BarcodeCreate"}),X=Object.assign(W,{props:{tag:{type:String,default:"canvas"},text:{type:String,default:null},options:{type:Object,default:()=>({})},type:{type:String,default:"CODE128"}},setup(e){const o=e,s=w(null);return x((()=>{const e=(r=i({},o.options),n={format:o.type},t(r,a(n)));var r,n;v(s.value,o.text,e)})),(t,a)=>(O(),_(C(e.tag),{ref_key:"wrapEl",ref:s},null,512))}});const Z=h({name:"QRCodeCreate"});var ee=H(Object.assign(Z,{props:{tag:{type:String,default:"canvas"},text:{type:[String,Array],default:null},options:{type:Object,default:()=>({})},width:{type:[Number,String],default:100},logo:{type:[String,Object],default:()=>""}},emits:["done","click","disabled-click"],setup(e,{emit:t}){const a=e,{toCanvas:o,toDataURL:s}=B,r=w(!0),n=w(null),c=S((()=>String(a.text))),d=S((()=>({width:a.width+"px",height:a.width+"px"}))),p=()=>l(this,null,(function*(){yield L();const e=M(a.options||{});if("canvas"===a.tag){e.errorCorrectionLevel=e.errorCorrectionLevel||g(E(c));const s=yield f(E(c),e);e.scale=0===a.width?void 0:a.width/s*4;const i=yield o(E(n),E(c),e);if(a.logo){const e=yield m(i);t("done",e),r.value=!1}else t("done",i.toDataURL()),r.value=!1}else{const o=yield s(c.value,i({errorCorrectionLevel:"H",width:a.width},e));E(n).src=o,t("done",o),r.value=!1}}));P((()=>c.value),(e=>{e&&p()}),{deep:!0,immediate:!0});const m=e=>{const t=e.width,o=Object.assign({logoSize:.15,bgColor:"#ffffff",borderSize:.05,crossOrigin:"anonymous",borderRadius:8,logoRadius:0},Q(a.logo)?{}:a.logo),{logoSize:s=.15,bgColor:r="#ffffff",borderSize:n=.05,crossOrigin:i="anonymous",borderRadius:l=8,logoRadius:c=0}=o,d=Q(a.logo)?a.logo:a.logo.src,p=t*s,m=t*(1-s)/2,f=t*(s+n),g=t*(1-s-n)/2,j=e.getContext("2d");if(!j)return;u(j)(g,g,f,f,l),j.fillStyle=r,j.fill();const b=new Image;(i||c)&&b.setAttribute("crossOrigin",i),b.src=d;return new Promise((t=>{b.onload=()=>{var a;c?(e=>{const t=document.createElement("canvas");t.width=m+p,t.height=m+p;const a=t.getContext("2d");if(!a||!j)return;if(a.drawImage(e,m,m,p,p),u(j)(m,m,p,p,c),!j)return;const o=j.createPattern(t,"no-repeat");o&&(j.fillStyle=o,j.fill())})(b):(a=b,j.drawImage(a,m,m,p,p)),t(e.toDataURL())}}))},u=e=>(t,a,o,s,r)=>{const n=Math.min(o,s);return r>n/2&&(r=n/2),e.beginPath(),e.moveTo(t+r,a),e.arcTo(t+o,a,t+o,a+s,r),e.arcTo(t+o,a+s,t,a+s,r),e.arcTo(t,a+s,t,a,r),e.arcTo(t,a,t+o,a,r),e.closePath(),e},f=(e,t)=>l(this,null,(function*(){const a=document.createElement("canvas");return yield o(a,e,t),a.width})),g=e=>e.length>36?"M":e.length>16?"Q":"H";return(t,a)=>(O(),R("div",{class:"qrcode",style:D(E(d))},["canvas"===e.tag?(O(),R("canvas",{key:0,ref_key:"wrapRef",ref:n},null,512)):k("",!0),"img"===e.tag?(O(),R("img",{key:1,ref_key:"wrapRef",ref:n},null,512)):k("",!0)],4))}}),[["__scopeId","data-v-386832c4"]]);const te=e=>(N("data-v-0ac05cf7"),e=e(),F(),e),ae={class:"layout__page"},oe={class:"layout__body"},se=te((()=>U("div",{class:"desc"},"canvas生成",-1))),re=te((()=>U("div",{class:"desc"},"自定义样式生成",-1))),ne=te((()=>U("div",{class:"desc"},"img生成",-1))),ie=te((()=>U("div",{id:"reader"},null,-1))),le=h({name:"QrcodeAndBarcode"});var ce=H(Object.assign(le,{setup(e){const t=w(["1","2","3"]),a=w([]),o=".png,.jpg,.jpeg",s=e=>!!/image\/(png|jpg|jpeg)$/.test(e.type)||(g(`请上传 ${o} 格式图片`),!1),r=G,n=e=>{v(e.file)},i=[{tag:"canvas",text:"CODE128 TYPE",type:"CODE128",options:{}},{tag:"img",text:"CODE39 TYPE",type:"CODE39",options:{lineColor:r}}],l=e=>{const t=e.target;v(t)},v=e=>{j({message:"识别中..."});const t=new J("reader");let a=null,o=null;e instanceof File?o=e:("canvas"===e.tagName.toLocaleLowerCase()&&(a=e.toDataURL(),o=K(a)),"img"===e.tagName.toLocaleLowerCase()&&(a=e.src,o=K(a))),t.scanFile(o,!1).then((e=>{b(),y({type:"success",message:"识别结果为："+e,position:"bottom"})})).catch((e=>{b(),y({type:"danger",message:"识别失败",position:"bottom"})}))};return(e,g)=>{const j=Y,b=ee,y=c,v=d,h=p,w=X,x=m,C=u,S=f,P=$("press");return O(),R("div",ae,[q(j),U("div",oe,[q(C,{modelValue:E(t),"onUpdate:modelValue":g[1]||(g[1]=e=>z(t)?t.value=e:null)},{default:T((()=>[q(h,{title:"二维码（长按可以识别哦~）",name:"1"},{default:T((()=>[q(v,{type:"flex",gutter:10,class:"qrcode-box"},{default:T((()=>[q(y,{class:"qrcode-item"},{default:T((()=>[I(q(b,{text:"我是canvas生成的二维码"},null,512),[[P,l]]),se])),_:1}),(O(),_(y,{key:0,class:"qrcode-item"},{default:T((()=>[I(q(b,{id:"img-qrcode",text:"我是有样式的二维码",tag:"img",options:{color:{dark:E(r)}}},null,8,["options"]),[[P,l]]),re])),_:1})),q(y,{class:"qrcode-item"},{default:T((()=>[I(q(b,{tag:"img",text:"我是img生成的二维码"},null,512),[[P,l]]),ne])),_:1})])),_:1})])),_:1}),q(h,{title:"条形码（长按可以识别哦~）",name:"2"},{default:T((()=>[q(v,{type:"flex",gutter:10},{default:T((()=>[(O(),R(V,null,A(i,((e,t)=>q(y,{key:t,span:24},{default:T((()=>[I(q(w,{tag:e.tag,text:e.text,type:e.type,options:e.options},null,8,["tag","text","type","options"]),[[P,l]])])),_:2},1024))),64))])),_:1})])),_:1}),q(h,{title:"上传(二维码/条形码)图片识别",name:"3"},{default:T((()=>[q(x,{modelValue:E(a),"onUpdate:modelValue":g[0]||(g[0]=e=>z(a)?a.value=e:null),"max-count":"1",accept:o,"before-read":s,"after-read":n},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),ie]),q(S)])}}}),[["__scopeId","data-v-0ac05cf7"]]);export{ce as default};
