var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,c=(e,l)=>{for(var a in l||(l={}))o.call(l,a)&&s(e,a,l[a]);if(t)for(var a of t(l))r.call(l,a)&&s(e,a,l[a]);return e},i=(e,t)=>l(e,a(t));import{y as n,w as d,x as u,z as f,A as h,E as p}from"./vant-56d7d53c.js";import{t as v}from"./index-d70cecb9.js";import{_ as m}from"./plugin-vue_export-helper-893979e1.js";import{d as b}from"./lodash-es-0ddda1ab.js";import{m as w,r as k,a as y,w as g,_ as x,C,aI as j,ak as F,al as _,F as O,aN as S,l as A,b7 as V,a2 as E,a5 as I,ai as P,v as R,A as L,aK as B,aJ as K,aj as M}from"./@vue-0da0c2e3.js";const U=w({name:"FilterMenus",components:{},props:{activeColor:{type:String,default:v},filterMenu:{type:Array,default:()=>[{field:"status",label:"状态",value:"",multiple:!1,data:[{label:"不限",value:"-1"},{label:"上架",value:"0"},{label:"下架",value:"1"}]}],validator:e=>b(e)}},emits:["close","confirm"],setup(e,{emit:l}){const a=k(null),t=k([0,1]),o=y({list:[]});g((()=>e.filterMenu),((e,l)=>{e!==l&&(o.list=e,o.list.forEach((e=>{if(e.data&&e.data.length){e.data.forEach((e=>{e.checked=!1}));if(e.hasOwnProperty("canAll")&&e.canAll){const l={label:"全选",value:"all",checked:!1};e.data.unshift(l)}}})))}),{deep:!0,immediate:!0});return i(c({},x(o)),{container:a,activeArr:t,onFinish:({value:e,selectedOptions:l,tabIndex:a},t)=>{console.log(e,a,l,l.map((e=>e.value))),console.log("pItem:",t);const o=t.showAllLevels;t.value=o?l.map((e=>e.value)).join("/"):e},handleClickBtn:()=>{},filterLabelSelect:(e,l,a,t)=>{if(console.log(" 点击选择项",e,l,a,t),console.log(e.value),"all"===e.value&&(e.checked=!e.checked,e.label=e.checked?"反选":"全选",a.data.forEach((l=>l.checked=e.checked))),"all"!==e.value){e.checked=!e.checked;const l=a.data.filter((e=>"all"!==e.value&&e.checked)).length;console.log("非全部按钮已选中的个数",l),a.hasOwnProperty("canAll")&&!0===a.canAll&&(a.data[0].checked=l===a.data.length-1,a.data[0].label=l===a.data.length-1?"反选":"全选")}a.hasOwnProperty("multiple")&&!a.multiple&&("all"!==e.value&&o.list[t].data.forEach((e=>e.checked=!1)),e.checked=!e.checked)},filterReset:()=>{o.list.forEach((e=>{e.type&&"tree"===e.type&&(e.valueShow="",e.value=""),e.data&&e.data.length&&e.data.forEach((e=>{e.checked=!1,"all"===e.value&&(e.label="全选")}))}))},filterConfirm:()=>{const e={};o.list.forEach((l=>{if(l.data&&l.data.length){const a=l.data.reduce(((e,l)=>("all"!==l.value&&l.checked&&e.push(l.value),e)),[]);"tree"===l.type&&""!==l.value&&(e[l.field]=l.value),""!==a.join(",")&&(e[l.field]=a.join(","))}})),console.log("result",e);const a=0!==Object.keys(e).length;l("confirm",e,a)}})}}),q={ref:"container",class:"filter-menus-wrapper st-bg-white"},z={class:"filter-list"},D={key:0,class:"st-flex-wrap st-padding-box"},J=["onClick"],N=(e=>(B("data-v-10473434"),e=e(),K(),e))((()=>_("div",null,null,-1))),G={class:"filter-button-box st-flex-ai"};var H=m(U,[["render",function(e,l,a,t,o,r){const s=n,c=d,i=u,f=C("waves");return j(),F("div",q,[_("div",z,[(j(!0),F(O,null,S(e.list,((a,t)=>(j(),F("div",{key:t,class:"filter-item"},[A(i,{modelValue:e.activeArr,"onUpdate:modelValue":l[1]||(l[1]=l=>e.activeArr=l),border:!1},{default:V((()=>[A(c,{name:t,title:a.label,value:""+(e.activeArr.includes(t)?"收起":"展开")},{default:V((()=>["tree"!==a.type?(j(),F("div",D,[(j(!0),F(O,null,S(a.data,((l,o)=>(j(),F("div",{key:o,class:E([{checked:l.checked},"filter-item-label st-line-16 van-ellipsis"]),onClick:r=>e.filterLabelSelect(l,o,a,t)},I(l.label),11,J)))),128))])):(j(),P(s,{key:t,ref_for:!0,ref:"cascaderRef",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,"field-names":{text:"label",value:"value",children:"children"},options:a.data,"active-color":e.activeColor,class:"cascader-tree",placeholder:"请选择",onClose:l[0]||(l[0]=l=>e.show=!1),onFinish:l=>e.onFinish(l,a,t)},{title:V((()=>[N])),_:2},1032,["modelValue","onUpdate:modelValue","options","active-color","onFinish"]))])),_:2},1032,["name","title","value"])])),_:2},1032,["modelValue"])])))),128))]),_("div",G,[R((j(),F("div",{class:"filter-button-reset st-flex-center st-flex-1",onClick:l[2]||(l[2]=(...l)=>e.filterReset&&e.filterReset(...l))},[L(" 清空 ")])),[[f]]),R((j(),F("div",{class:"filter-button-confirm st-flex-center st-flex-1 st-color-white",onClick:l[3]||(l[3]=(...l)=>e.filterConfirm&&e.filterConfirm(...l))},[L(" 确定 ")])),[[f]])])],512)}],["__scopeId","data-v-10473434"]]);const Q=w({name:"SearchFilter",props:{placeholder:{type:String,default:"搜索关键词"},filter:{type:Boolean,default:!1},shape:{type:String,default:"square",validator:e=>["square","round"].includes(e)}},emits:["search","confirm"],setup(e,{emit:l}){const a=y({keyword:"",showFilter:!0,isChecked:!1,dropdownItemRef:null,keywordListRef:null,showKeywordList:!1});g((()=>a.keyword),((e,l)=>{}));return i(c({},x(a)),{onFocus:()=>{a.showKeywordList=!0,a.showFilter=!1},onBlur:()=>{a.showKeywordList=!1,a.showFilter=!0},onSearch:()=>{l("search",a.keyword)},searchConfirm:()=>{},handleFilterConfirm:(e,t)=>{a.dropdownItemRef.toggle(),console.log("筛选结果：",e,t),a.isChecked=t,l("confirm",e)},handleKeywordSearch:e=>{a.keyword=e}})}}),T={class:"search-filter-wrapper st-flex-ai st-bg-white van-hairline--bottom"},W=(e=>(B("data-v-7f600c48"),e=e(),K(),e))((()=>_("div",{class:E("")},"筛选",-1)));var X=m(Q,[["render",function(e,l,a,t,o,r){const s=H,c=f,i=h,n=p;return j(),F("div",T,[A(n,{modelValue:e.keyword,"onUpdate:modelValue":l[0]||(l[0]=l=>e.keyword=l),modelModifiers:{trim:!0},shape:e.shape,"show-action":!0,class:"search-box st-flex-1",autocomplete:"off",placeholder:e.placeholder,"action-text":"",onBlur:e.onBlur,onFocus:e.onFocus,onSearch:e.onSearch},{action:V((()=>[(j(),P(i,{key:0,"active-color":"#333333","z-index":"999"},{default:V((()=>[A(c,{ref:"dropdownItemRef"},{title:V((()=>[W])),default:V((()=>[A(s,{onConfirm:e.handleFilterConfirm},null,8,["onConfirm"])])),_:1},512)])),_:1}))])),_:1},8,["modelValue","shape","placeholder","onBlur","onFocus","onSearch"])])}],["__scopeId","data-v-7f600c48"]]);export{X as _};
